(herald
  "Cookie Authentication with TLS 1.2 Signed Ephemeral Diffie-Hellman"
  (bound 16))

(comment "CPSA 4.4.2")
(comment "All input read from tls12edh_ca.scm")
(comment "Strand count bounded at 16")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 0)
  (unrealized (0 1) (0 3))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 1)
  (parent 0)
  (unrealized (0 1) (0 3))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 2)
  (parent 1)
  (unrealized (0 1) (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 3)
  (parent 2)
  (unrealized (0 3) (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 4)
  (parent 2)
  (unrealized (0 3) (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 5)
  (parent 3)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (2 0)) ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 6)
  (parent 3)
  (unrealized (0 3) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 7)
  (parent 4)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 8)
  (parent 4)
  (unrealized (0 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 servera 6)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 9)
  (parent 5)
  (unrealized (0 9) (1 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 10)
  (parent 5)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 11)
  (parent 6)
  (unrealized (0 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 servera 6)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-1)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 12)
  (parent 7)
  (unrealized (0 9) (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 13)
  (parent 7)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 14)
  (parent 8)
  (unrealized (0 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 0 clienta 5)
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x)) cr sr) "client_write")) (1 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))))
  (label 15)
  (parent 9)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")) (1 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 16)
  (parent 9)
  (unrealized (0 9) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 17)
  (parent 10)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 18)
  (parent 11)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clienta 5)
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))))
  (label 19)
  (parent 12)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")) (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 20)
  (parent 12)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 21)
  (parent 13)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 22)
  (parent 14)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 2 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 23)
  (parent 15)
  (unrealized (1 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 24)
  (parent 15)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "client_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 25)
  (parent 16)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 26)
  (parent 17)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 27)
  (parent 18)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 28)
  (parent 18)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 3 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-1 y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 29)
  (parent 19)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 30)
  (parent 19)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 31)
  (parent 20)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 32)
  (parent 21)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 33)
  (parent 22)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 34)
  (parent 22)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((0 8) (1 8))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 0 clienta 9)
    (enc cookie request-0
      (hash (hash (exp (gen) (mul y-0 x)) cr sr) "client_write")) (1 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))))
  (label 35)
  (parent 23)
  (realized)
  (shape)
  (maps
    ((0)
      ((u u) (s s) (ca ca) (p p) (cr cr) (sr sr) (spk spk) (y y) (x x)
        (cookie cookie) (any any) (cookiestor cookiestor)
        (request request) (response response))))
  (origs (pt-0 (0 7)) (cookie (1 5)) (pt-2 (1 7)) (cr (0 0))
    (sr (1 1))))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (enc cookie request-0
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")) (1 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 36)
  (parent 23)
  (unrealized (1 8) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x y)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 37)
  (parent 24)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 38)
  (parent 25)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 39)
  (parent 26)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 40)
  (parent 26)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (2 8))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 0 clienta 9)
    (enc cookie request-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (2 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))))
  (label 41)
  (parent 29)
  (seen 35)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (enc cookie request-0
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")) (2 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 42)
  (parent 29)
  (unrealized (2 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 43)
  (parent 30)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 44)
  (parent 31)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 45)
  (parent 32)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 46)
  (parent 32)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "client_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 47)
  (parent 36)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 48)
  (parent 37)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 49)
  (parent 38)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 50)
  (parent 38)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 51)
  (parent 42)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 52)
  (parent 43)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 53)
  (parent 44)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 54)
  (parent 44)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 55)
  (parent 47)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 56)
  (parent 48)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 57)
  (parent 48)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 58)
  (parent 51)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 59)
  (parent 52)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 60)
  (parent 52)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 61)
  (parent 55)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 62)
  (parent 55)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 63)
  (parent 58)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 64)
  (parent 58)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie)))
  (label 65)
  (unrealized (0 1) (0 3))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie)))
  (label 66)
  (parent 65)
  (unrealized (0 1) (0 3))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 67)
  (parent 66)
  (unrealized (0 1) (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((0 0) (2 0)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 2 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 68)
  (parent 67)
  (unrealized (0 3) (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((0 0) (3 0)) ((2 1) (0 1)) ((3 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 69)
  (parent 67)
  (unrealized (0 3) (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((2 1) (0 1)) ((2 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 70)
  (parent 68)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (3 0)) ((2 1) (0 1)) ((3 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 71)
  (parent 68)
  (unrealized (0 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 4 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 72)
  (parent 69)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (4 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((4 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 73)
  (parent 69)
  (unrealized (0 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((2 5) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 servera 6)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 74)
  (parent 70)
  (unrealized (0 9) (1 0) (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 75)
  (parent 70)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (4 0)) ((2 1) (0 1)) ((3 1) (0 3))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 76)
  (parent 71)
  (unrealized (0 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 5) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 4 servera 6)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-1)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 77)
  (parent 72)
  (unrealized (0 9) (1 0) (3 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 78)
  (parent 72)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (5 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((4 1) (0 3)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 79)
  (parent 73)
  (unrealized (0 3) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clienta 5)
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x)) cr sr) "client_write")) (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))))
  (label 80)
  (parent 74)
  (unrealized (0 9) (1 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0)) ((3 1) (2 4)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")) (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 81)
  (parent 74)
  (unrealized (0 9) (1 0) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 82)
  (parent 75)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (5 0)) ((2 1) (0 1)) ((3 1) (0 3))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 83)
  (parent 76)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)) ((3 5) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 4 0 clienta 5)
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))))
  (label 84)
  (parent 77)
  (unrealized (0 9) (1 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)) ((3 5) (1 0))
    ((4 1) (3 4)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")) (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 85)
  (parent 77)
  (unrealized (0 9) (1 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 86)
  (parent 78)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (6 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((4 1) (0 3)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 87)
  (parent 79)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (displaced 3 0 clienta 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y-0)) cr sr) "server_write")))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))))
  (label 88)
  (parent 80)
  (unrealized (0 9) (1 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 2 3 servera 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))))
  (label 89)
  (parent 80)
  (seen 104)
  (unrealized (0 9) (1 0))
  (comment "2 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0))
    ((3 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 90)
  (parent 80)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 91)
  (parent 81)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 92)
  (parent 82)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((2 1) (0 1)) ((3 1) (0 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 93)
  (parent 83)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((2 1) (0 1)) ((3 1) (0 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 94)
  (parent 83)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (displaced 4 0 clienta 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))))
  (label 95)
  (parent 84)
  (unrealized (0 9) (1 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 4 servera 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-1 y)) cr sr) "server_write")))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))))
  (label 96)
  (parent 84)
  (seen 113)
  (unrealized (0 9) (1 0))
  (comment "2 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((0 4) (3 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 5) (1 0)) ((4 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 97)
  (parent 84)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)) ((3 5) (1 0))
    ((4 1) (3 4)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 98)
  (parent 85)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 99)
  (parent 86)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (7 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((4 1) (0 3)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 100)
  (parent 87)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (7 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((4 1) (0 3)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 101)
  (parent 87)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 5) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))))
  (label 102)
  (parent 88)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (displaced 3 0 clienta 9) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y-0)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))))
  (label 103)
  (parent 88)
  (unrealized (0 9) (1 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 2 3 servera 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u-0 s-0 cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))))
  (label 104)
  (parent 88)
  (seen 122)
  (unrealized (0 9) (1 0))
  (comment "3 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 105)
  (parent 88)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 106)
  (parent 89)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0))
    ((3 1) (1 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x y)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 107)
  (parent 90)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 108)
  (parent 91)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 109)
  (parent 92)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 110)
  (parent 92)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x x-0 y y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((4 5) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))))
  (label 111)
  (parent 95)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (displaced 4 0 clienta 9) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))))
  (label 112)
  (parent 95)
  (unrealized (0 9) (1 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 4 servera 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-1 y)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u-0 s-0 cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))))
  (label 113)
  (parent 95)
  (seen 135)
  (unrealized (0 9) (1 0))
  (comment "3 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((0 4) (3 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 114)
  (parent 95)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((0 4) (3 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 115)
  (parent 96)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 5) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 116)
  (parent 97)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)) ((3 5) (1 0))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 117)
  (parent 98)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 118)
  (parent 99)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 119)
  (parent 99)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 4 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write"))
    (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))))
  (label 120)
  (parent 102)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 5) (1 0)) ((4 1) (0 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 121)
  (parent 102)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 2 3 servera 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u-0 s-0 cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))))
  (label 122)
  (parent 103)
  (unrealized (0 9) (1 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 5) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))))
  (label 123)
  (parent 103)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
  (label 124)
  (parent 103)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 125)
  (parent 103)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 5) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))))
  (label 126)
  (parent 104)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 127)
  (parent 104)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x y)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 128)
  (parent 105)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 1) (1 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 129)
  (parent 106)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 130)
  (parent 107)
  (unrealized (0 9) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 131)
  (parent 108)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 132)
  (parent 108)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1)) ((4 3) (0 3))
    ((4 5) (0 5)) ((4 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 5 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-2 y-0)) cr sr) "server_write"))
    (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))))
  (label 133)
  (parent 111)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x x-0 y y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 5) (1 0)) ((5 1) (0 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 134)
  (parent 111)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 8) (1 0))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 4 servera 8) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-1 y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x-1 y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u-0 s-0 cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))))
  (label 135)
  (parent 112)
  (unrealized (0 9) (1 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x x-0 y y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 5) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))))
  (label 136)
  (parent 112)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))))
  (label 137)
  (parent 112)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 138)
  (parent 112)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 5) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))))
  (label 139)
  (parent 113)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((0 4) (3 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 140)
  (parent 113)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 141)
  (parent 114)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 142)
  (parent 115)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 5) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 143)
  (parent 116)
  (unrealized (0 9) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)) ((3 5) (1 0))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 144)
  (parent 117)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5)) ((3 5) (1 0))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 145)
  (parent 117)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (3 8)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 4 0 clienta 9)
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-1 x-0)) cr sr) "client_write"))
    (3 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write")))))
  (label 146)
  (parent 120)
  (realized)
  (shape)
  (maps
    ((0 1)
      ((u u) (s s) (ca ca-0) (p p) (cr cr) (sr sr) (cookie cookie)
        (spk spk-0) (y y-0) (x x-0) (any any) (cookiestor cookiestor)
        (request request) (response response))))
  (origs (pt-0 (0 7)) (cookie (3 5)) (pt-2 (3 7)) (cr (0 0))
    (sr (3 1))))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 9) (0 9)) ((4 1) (3 8)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (3 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 147)
  (parent 120)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x y)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 148)
  (parent 121)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 5) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))))
  (label 149)
  (parent 122)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 150)
  (parent 122)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 151)
  (parent 122)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 4 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write"))
    (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))))
  (label 152)
  (parent 123)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((3 5) (1 0)) ((4 1) (0 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 153)
  (parent 123)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul x y)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
  (label 154)
  (parent 124)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x y)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 155)
  (parent 125)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((3 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 4 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write"))
    (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))))
  (label 156)
  (parent 126)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 5) (1 0)) ((4 1) (0 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 157)
  (parent 126)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 158)
  (parent 127)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 159)
  (parent 128)
  (unrealized (0 9) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 160)
  (parent 129)
  (unrealized (0 9) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 161)
  (parent 130)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 5) (1 0))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 162)
  (parent 130)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (x-1 y-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (4 8)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-1 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 5 0 clienta 9)
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-1 x-1)) cr sr) "client_write"))
    (4 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write")))))
  (label 163)
  (parent 133)
  (seen 146)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (5 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9)) ((5 1) (4 8)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (4 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 164)
  (parent 133)
  (unrealized (4 8) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x x-0 y y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 5) (1 0)) ((5 1) (0 9)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write") (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 165)
  (parent 134)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (4 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))))
  (label 166)
  (parent 135)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 167)
  (parent 135)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) cookie
    (1 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 168)
  (parent 135)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 5 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-2 y-0)) cr sr) "server_write"))
    (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))))
  (label 169)
  (parent 136)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x x-0 y y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((4 5) (1 0)) ((5 1) (0 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 170)
  (parent 136)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))))
  (label 171)
  (parent 137)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 172)
  (parent 138)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1)) ((4 3) (0 3))
    ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 5 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-2)) cr sr) "server_write"))
    (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))))
  (label 173)
  (parent 139)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0)) ((5 1) (0 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 174)
  (parent 139)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 175)
  (parent 140)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 176)
  (parent 141)
  (unrealized (0 9) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 177)
  (parent 142)
  (unrealized (0 9) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 5) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 178)
  (parent 143)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 5) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 179)
  (parent 143)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 9) (0 9)) ((4 1) (3 8)) ((5 1) (4 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 180)
  (parent 147)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 181)
  (parent 148)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 4 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write"))
    (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))))
  (label 182)
  (parent 149)
  (unrealized (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((2 7) (1 0)) ((3 5) (1 0)) ((4 1) (0 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 183)
  (parent 149)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 184)
  (parent 150)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 185)
  (parent 151)
  (unrealized (0 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (1 0)) ((0 8) (3 8)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 4 0 clienta 9)
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-1 x-0)) cr sr) "client_write"))
    (3 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write")))))
  (label 186)
  (parent 152)
  (seen 146)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 9) (0 9)) ((4 1) (3 8)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (3 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 187)
  (parent 152)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x y)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 188)
  (parent 153)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 189)
  (parent 154)
  (unrealized (0 9) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 190)
  (parent 155)
  (unrealized (0 9) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (3 8)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 4 0 clienta 9)
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-1 x-0)) cr sr) "client_write"))
    (3 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write")))))
  (label 191)
  (parent 156)
  (seen 146)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9)) ((4 1) (3 8)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (3 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 192)
  (parent 156)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 193)
  (parent 157)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 194)
  (parent 158)
  (unrealized (0 9) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 195)
  (parent 159)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 196)
  (parent 159)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 197)
  (parent 160)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 7) (1 0))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 198)
  (parent 160)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (6 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9)) ((5 1) (4 8))
    ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write") (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 199)
  (parent 164)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x x-0 y y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 5) (1 0)) ((5 1) (0 9)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 200)
  (parent 165)
  (unrealized (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 5 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-2)) cr sr) "server_write"))
    (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))))
  (label 201)
  (parent 166)
  (unrealized (4 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0))
    ((5 1) (0 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 202)
  (parent 166)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 203)
  (parent 167)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 204)
  (parent 168)
  (unrealized (0 9) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (x-1 y-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((0 8) (4 8)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-1 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 5 0 clienta 9)
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-1 x-1)) cr sr) "client_write"))
    (4 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write")))))
  (label 205)
  (parent 169)
  (seen 186)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (5 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9))
    ((5 1) (4 8)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (4 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 206)
  (parent 169)
  (unrealized (4 8) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x x-0 y y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((4 5) (1 0)) ((5 1) (0 9))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write") (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 207)
  (parent 170)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 208)
  (parent 171)
  (unrealized (0 9) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 209)
  (parent 172)
  (unrealized (0 9) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (x-1 y-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (4 8)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-1 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 5 0 clienta 9)
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-1 x-1)) cr sr) "client_write"))
    (4 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write")))))
  (label 210)
  (parent 173)
  (seen 191)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (5 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9))
    ((5 1) (4 8)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (4 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 211)
  (parent 173)
  (unrealized (4 8) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0)) ((5 1) (0 9))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 212)
  (parent 174)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 213)
  (parent 175)
  (unrealized (0 9) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 214)
  (parent 176)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 215)
  (parent 176)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 216)
  (parent 177)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (0 5))
    ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 217)
  (parent 177)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 9) (0 9)) ((4 1) (3 8)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) cr sr))
    (hash (exp (gen) (mul y-0 x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr))))
  (label 218)
  (parent 180)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 219)
  (parent 181)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 220)
  (parent 181)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 4)) ((0 7) (2 4))
    ((0 8) (1 0)) ((0 8) (3 8)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 4 0 clienta 9)
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-1 x-0)) cr sr) "client_write"))
    (3 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write")))))
  (label 221)
  (parent 182)
  (seen 191)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9))
    ((4 1) (3 8)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (3 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 222)
  (parent 182)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((2 7) (1 0)) ((3 5) (1 0)) ((4 1) (0 9))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 223)
  (parent 183)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 224)
  (parent 184)
  (unrealized (0 9) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 225)
  (parent 185)
  (unrealized (0 9) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 9) (0 9)) ((4 1) (3 8))
    ((5 1) (4 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 226)
  (parent 187)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 227)
  (parent 188)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 228)
  (parent 189)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 229)
  (parent 189)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 230)
  (parent 190)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 231)
  (parent 190)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9)) ((4 1) (3 8))
    ((5 1) (4 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 232)
  (parent 192)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 233)
  (parent 193)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 234)
  (parent 194)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 235)
  (parent 194)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (7 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9)) ((5 1) (4 8))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-1)) cr sr))
    (hash (exp (gen) (mul y-0 x-1)) cr sr) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr))))
  (label 236)
  (parent 199)
  (unrealized (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x x-0 y y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (8 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 5) (1 0)) ((5 1) (0 9)) ((6 1) (5 0))
    ((7 1) (6 0)) ((8 1) (7 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 237)
  (parent 200)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x x-0 y y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (8 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 5) (1 0)) ((5 1) (0 9)) ((6 1) (5 0))
    ((7 1) (6 0)) ((8 1) (7 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 238)
  (parent 200)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (x-1 y-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 4) (4 4)) ((0 7) (3 4))
    ((0 8) (1 0)) ((0 8) (4 8)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0))
    ((4 9) (0 9)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-1 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 5 0 clienta 9)
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-1 x-1)) cr sr) "client_write"))
    (4 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write")))))
  (label 239)
  (parent 201)
  (seen 221)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (5 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0))
    ((4 9) (0 9)) ((5 1) (4 8)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (enc cookie request-1
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (4 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 240)
  (parent 201)
  (unrealized (4 8) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0))
    ((5 1) (0 9)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 241)
  (parent 202)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 242)
  (parent 203)
  (unrealized (0 9) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 243)
  (parent 204)
  (unrealized (0 9) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (6 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9))
    ((5 1) (4 8)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write") (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 244)
  (parent 206)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x x-0 y y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((4 5) (1 0)) ((5 1) (0 9))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 245)
  (parent 207)
  (unrealized (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 246)
  (parent 208)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 247)
  (parent 208)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 248)
  (parent 209)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((4 1) (1 0)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 249)
  (parent 209)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (6 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9))
    ((5 1) (4 8)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write") (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 250)
  (parent 211)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0)) ((5 1) (0 9))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 251)
  (parent 212)
  (unrealized (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 252)
  (parent 213)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 253)
  (parent 213)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 9) (0 9)) ((4 1) (3 8)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 254)
  (parent 218)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 9) (0 9)) ((4 1) (3 8)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 255)
  (parent 218)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9))
    ((4 1) (3 8)) ((5 1) (4 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 256)
  (parent 222)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((2 7) (1 0)) ((3 5) (1 0)) ((4 1) (0 9))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 257)
  (parent 223)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 258)
  (parent 224)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 259)
  (parent 224)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 260)
  (parent 225)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 1) (1 0)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 261)
  (parent 225)
  (unrealized (0 9) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 9) (0 9)) ((4 1) (3 8))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) cr sr))
    (hash (exp (gen) (mul y-0 x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr))))
  (label 262)
  (parent 226)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 263)
  (parent 227)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 264)
  (parent 227)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9)) ((4 1) (3 8))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) cr sr))
    (hash (exp (gen) (mul y-0 x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr))))
  (label 265)
  (parent 232)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 266)
  (parent 233)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 7) (1 0)) ((3 5) (1 0)) ((4 1) (0 9)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 267)
  (parent 233)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-1))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (8 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9)) ((5 1) (4 8))
    ((6 1) (5 0)) ((7 1) (6 0)) ((8 1) (7 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-1))
    (exp (gen) (mul y-0 x-1)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-1)) (send (cat (exp (gen) y-0) x-1))))
  (label 268)
  (parent 236)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) x-1) y-0))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (8 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9)) ((5 1) (4 8))
    ((6 1) (5 0)) ((7 1) (6 0)) ((8 1) (7 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-0))
    (exp (gen) (mul y-0 x-1)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) x-1) y-0)) (send (cat (exp (gen) x-1) y-0))))
  (label 269)
  (parent 236)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (6 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0))
    ((4 9) (0 9)) ((5 1) (4 8)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write") (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 270)
  (parent 240)
  (unrealized (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0))
    ((5 1) (0 9)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 271)
  (parent 241)
  (unrealized (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 272)
  (parent 242)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 273)
  (parent 242)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 274)
  (parent 243)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 1) (1 0)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 275)
  (parent 243)
  (unrealized (0 9) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (7 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9))
    ((5 1) (4 8)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-1)) cr sr))
    (hash (exp (gen) (mul y-0 x-1)) cr sr) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr))))
  (label 276)
  (parent 244)
  (unrealized (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x x-0 y y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (8 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((4 5) (1 0)) ((5 1) (0 9))
    ((6 1) (5 0)) ((7 1) (6 0)) ((8 1) (7 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 277)
  (parent 245)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x x-0 y y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (8 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((4 5) (1 0)) ((5 1) (0 9))
    ((6 1) (5 0)) ((7 1) (6 0)) ((8 1) (7 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 278)
  (parent 245)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (7 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9))
    ((5 1) (4 8)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-1)) cr sr))
    (hash (exp (gen) (mul y-0 x-1)) cr sr) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr))))
  (label 279)
  (parent 250)
  (unrealized (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (8 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0)) ((5 1) (0 9))
    ((6 1) (5 0)) ((7 1) (6 0)) ((8 1) (7 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 280)
  (parent 251)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (8 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0)) ((5 1) (0 9))
    ((6 1) (5 0)) ((7 1) (6 0)) ((8 1) (7 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 281)
  (parent 251)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9))
    ((4 1) (3 8)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) cr sr))
    (hash (exp (gen) (mul y-0 x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr))))
  (label 282)
  (parent 256)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((2 7) (1 0)) ((3 5) (1 0)) ((4 1) (0 9))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 283)
  (parent 257)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x y-0 rndx) (x-0 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((0 4) (2 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((2 3) (0 3))
    ((2 5) (0 5)) ((2 7) (1 0)) ((3 5) (1 0)) ((4 1) (0 9))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 284)
  (parent 257)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 9) (0 9)) ((4 1) (3 8))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 285)
  (parent 262)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 9) (0 9)) ((4 1) (3 8))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 286)
  (parent 262)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9)) ((4 1) (3 8))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 287)
  (parent 265)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((2 5) (1 0)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9)) ((4 1) (3 8))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 288)
  (parent 265)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (7 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0))
    ((4 9) (0 9)) ((5 1) (4 8)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-1)) cr sr))
    (hash (exp (gen) (mul y-0 x-1)) cr sr) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr))))
  (label 289)
  (parent 270)
  (unrealized (7 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (8 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0))
    ((5 1) (0 9)) ((6 1) (5 0)) ((7 1) (6 0)) ((8 1) (7 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 290)
  (parent 271)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (8 0)) ((0 4) (3 4))
    ((0 7) (4 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)) ((4 5) (1 0))
    ((5 1) (0 9)) ((6 1) (5 0)) ((7 1) (6 0)) ((8 1) (7 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (4 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie)))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 291)
  (parent 271)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-1))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (8 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9))
    ((5 1) (4 8)) ((6 1) (5 0)) ((7 1) (6 0)) ((8 1) (7 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-1))
    (exp (gen) (mul y-0 x-1)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-1)) (send (cat (exp (gen) y-0) x-1))))
  (label 292)
  (parent 276)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) x-1) y-0))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (8 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 9) (0 9))
    ((5 1) (4 8)) ((6 1) (5 0)) ((7 1) (6 0)) ((8 1) (7 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-0))
    (exp (gen) (mul y-0 x-1)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) x-1) y-0)) (send (cat (exp (gen) x-1) y-0))))
  (label 293)
  (parent 276)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-1))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (8 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9))
    ((5 1) (4 8)) ((6 1) (5 0)) ((7 1) (6 0)) ((8 1) (7 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-1))
    (exp (gen) (mul y-0 x-1)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-1)) (send (cat (exp (gen) y-0) x-1))))
  (label 294)
  (parent 279)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) x-1) y-0))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (8 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((2 1) (0 1)) ((3 5) (1 0)) ((4 1) (0 1))
    ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0)) ((4 9) (0 9))
    ((5 1) (4 8)) ((6 1) (5 0)) ((7 1) (6 0)) ((8 1) (7 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-0))
    (exp (gen) (mul y-0 x-1)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) x-1) y-0)) (send (cat (exp (gen) x-1) y-0))))
  (label 295)
  (parent 279)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9))
    ((4 1) (3 8)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 296)
  (parent 282)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (ca u s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener cookie)
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((0 4) (3 4))
    ((0 7) (2 4)) ((0 8) (1 0)) ((2 5) (1 0)) ((3 1) (0 1))
    ((3 3) (0 3)) ((3 5) (0 5)) ((3 7) (1 0)) ((3 9) (0 9))
    ((4 1) (3 8)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (2 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 297)
  (parent 282)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-1))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (8 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0))
    ((4 9) (0 9)) ((5 1) (4 8)) ((6 1) (5 0)) ((7 1) (6 0))
    ((8 1) (7 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-1))
    (exp (gen) (mul y-0 x-1)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-1)) (send (cat (exp (gen) y-0) x-1))))
  (label 298)
  (parent 289)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 request-1 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (ca u s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-1) (p p) (cr cr) (sr sr) (spk spk-0) (u u) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) x-1) y-0))
  (precedes ((0 0) (4 0)) ((0 2) (4 2)) ((0 2) (8 0)) ((0 4) (4 4))
    ((0 7) (3 4)) ((0 8) (1 0)) ((2 1) (0 1)) ((3 5) (1 0))
    ((4 1) (0 1)) ((4 3) (0 3)) ((4 5) (0 5)) ((4 7) (1 0))
    ((4 9) (0 9)) ((5 1) (4 8)) ((6 1) (5 0)) ((7 1) (6 0))
    ((8 1) (7 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((0 7) (3 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-0))
    (exp (gen) (mul y-0 x-1)) (7 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))) ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-1
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) x-1) y-0)) (send (cat (exp (gen) x-1) y-0))))
  (label 299)
  (parent 289)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 300)
  (unrealized (0 1) (0 3))
  (origs (cr (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (rule gen-st-clientr-0)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 301)
  (parent 300)
  (unrealized (0 1) (0 3) (0 4))
  (origs (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 302)
  (parent 301)
  (unrealized (0 1) (0 3) (0 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 303)
  (parent 302)
  (unrealized (0 3) (0 4) (0 6))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 304)
  (parent 302)
  (unrealized (0 3) (0 4) (0 6))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 305)
  (parent 303)
  (unrealized (0 4) (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (2 0)) ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 306)
  (parent 303)
  (unrealized (0 3) (0 4) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (x y x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 307)
  (parent 304)
  (unrealized (0 4) (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 308)
  (parent 304)
  (unrealized (0 3) (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 7) (0 4)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor (cat pt "client store" u s cookie)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie))))
  (label 309)
  (parent 305)
  (unrealized (0 6))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 310)
  (parent 306)
  (unrealized (0 3) (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 7) (0 4)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor (cat pt "client store" u s cookie)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie))))
  (label 311)
  (parent 307)
  (unrealized (0 6))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 312)
  (parent 308)
  (unrealized (0 3) (0 4) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0)
    (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 9) (0 6)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 3 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write"))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))))
  (label 313)
  (parent 309)
  (unrealized (2 4) (2 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 6) (0 6)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation encryption-test (displaced 1 3 serverr 7)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write"))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))))
  (label 314)
  (parent 309)
  (unrealized (2 4) (2 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 315)
  (parent 309)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 316)
  (parent 310)
  (unrealized (0 4) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1)
    (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 4 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-2)) cr sr) "server_write"))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))))
  (label 317)
  (parent 311)
  (unrealized (3 4) (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation encryption-test (displaced 2 4 serverr 7)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-2)) cr sr) "server_write"))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))))
  (label 318)
  (parent 311)
  (unrealized (3 4) (3 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 319)
  (parent 311)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 320)
  (parent 312)
  (unrealized (0 4) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 321)
  (parent 313)
  (unrealized (2 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clientr 6)
    (enc cookie-0 request-0
      (hash (hash (exp (gen) (mul y-1 x-0)) cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write")))))
  (label 322)
  (parent 314)
  (unrealized (2 5))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (enc cookie-0 request-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 323)
  (parent 314)
  (unrealized (2 5) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 324)
  (parent 315)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 325)
  (parent 316)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 326)
  (parent 316)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 327)
  (parent 317)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (x-1 y-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 5) (3 4)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y x-1 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 4 0 clientr 6)
    (enc cookie-0 request-0
      (hash (hash (exp (gen) (mul y-1 x-1)) cr sr) "client_write"))
    (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write")))))
  (label 328)
  (parent 318)
  (unrealized (3 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (enc cookie-0 request-0
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 329)
  (parent 318)
  (unrealized (3 5) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 330)
  (parent 319)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 331)
  (parent 320)
  (unrealized (0 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 332)
  (parent 320)
  (unrealized (0 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 333)
  (parent 321)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 spk-1 akey)
    (u ca u-0 s ca-0 ca-1 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 x-1 rndx)
    (y-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-1) (u u-0) (s s) (ca ca-1) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (2 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul x-1 y-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul x-1 y-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 334)
  (parent 322)
  (realized)
  (shape)
  (maps
    ((0)
      ((s s) (ca ca-0) (cr cr) (sr sr) (spk spk-0) (u u) (y y-0) (x x-0)
        (cookie cookie) (cookiestor cookiestor) (request request)
        (response response))))
  (origs (cookie (3 5)) (pt-1 (3 7)) (pt (1 7)) (cr (0 0)) (sr (2 1))))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 335)
  (parent 323)
  (unrealized (2 5) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 336)
  (parent 324)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 337)
  (parent 327)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (0 1))
    ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (displaced 1 4 servera 8)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (3 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 338)
  (parent 328)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 cr-2 sr-2 random32)
    (spk spk-0 spk-1 akey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (x y rndx)
    (x-0 expt) (x-1 y-0 x-2 rndx) (y-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-2)
    (sr sr-2) (spk spk-1) (u u-0) (s s) (ca ca-1) (authstor authstor)
    (x x-2) (y y-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 5) (3 4)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 5) (2 5)) ((4 7) (3 5)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-1 y-0 x-2)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)) ((4 7) (3 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (3 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write"))))
    ((recv cr-2)
      (send
        (cat sr-2 (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
          (exp (gen) x-2)
          (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul x-2 y-1)) "client finished"
              (hash cr-2 sr-2
                (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                (cat (exp (gen) x-2)
                  (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-2 y-1)) "server finished"
            (hash cr-2 sr-2
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (cat (exp (gen) x-2)
                (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul x-2 y-1)) "client finished"
                  (hash cr-2 sr-2
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                    (cat (exp (gen) x-2)
                      (enc (hash cr-2 sr-2 (exp (gen) x-2))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 339)
  (parent 328)
  (seen 334)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 340)
  (parent 329)
  (unrealized (3 5) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 341)
  (parent 330)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) cr sr))
    (hash (exp (gen) (mul y-0 x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr))))
  (label 342)
  (parent 333)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) cr sr))
    (hash (exp (gen) (mul y-0 x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr))))
  (label 343)
  (parent 335)
  (unrealized (2 5) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 344)
  (parent 336)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 345)
  (parent 336)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-1)) cr sr))
    (hash (exp (gen) (mul y-0 x-1)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr))))
  (label 346)
  (parent 337)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 2))
    ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization weakened ((3 1) (0 1)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 347)
  (parent 338)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-1)) cr sr))
    (hash (exp (gen) (mul y-0 x-1)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr))))
  (label 348)
  (parent 340)
  (unrealized (3 5) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 349)
  (parent 341)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 350)
  (parent 341)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 351)
  (parent 342)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 352)
  (parent 342)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 353)
  (parent 343)
  (unrealized (2 5) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 354)
  (parent 343)
  (unrealized (2 5) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-1))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-1)) (send (cat (exp (gen) y-0) x-1))))
  (label 355)
  (parent 346)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) x-1) y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-0))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) x-1) y-0)) (send (cat (exp (gen) x-1) y-0))))
  (label 356)
  (parent 346)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (0 3))
    ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization weakened ((3 1) (2 2)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 357)
  (parent 347)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-1))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-1)) (send (cat (exp (gen) y-0) x-1))))
  (label 358)
  (parent 348)
  (unrealized (3 5) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) x-1) y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-0))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) x-1) y-0)) (send (cat (exp (gen) x-1) y-0))))
  (label 359)
  (parent 348)
  (unrealized (3 5) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization weakened ((3 1) (0 3)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 360)
  (parent 357)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 spk-1 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-1) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (invk spk-0) (invk spk-1) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization separated spk-1)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 361)
  (parent 360)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 spk-1 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-1) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization forgot (invk spk-1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 362)
  (parent 361)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 spk-1 akey)
    (u ca u-0 s ca-0 ca-1 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-1) (u u-0) (s s) (ca ca-1) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (invk spk-0) (privk ca-0) (privk ca-1))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization separated ca-1)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 363)
  (parent 362)
  (seen 334)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (spk akey) (s ca u name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (authstor authstor)
    (x x) (y y))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))))
  (label 364)
  (realized)
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (spk akey) (s ca u name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (authstor authstor)
    (x x) (y y))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-6 trRl_servera-at-7)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))))
  (label 365)
  (parent 364)
  (realized)
  (shape)
  (maps
    ((0)
      ((s s) (ca ca) (cr cr) (sr sr) (cookie cookie) (spk spk) (u u)
        (x x) (y y) (p p) (any any) (authstor authstor)
        (request request))))
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5))))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (spk akey) (s ca u name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (authstor authstor)
    (x x) (y y))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))))
  (label 366)
  (realized)
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (spk akey) (s ca u name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca) (authstor authstor)
    (x x) (y y))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-6 trRl_servera-at-7)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))))
  (label 367)
  (parent 366)
  (realized)
  (shape)
  (maps
    ((0)
      ((s s) (ca ca) (cr cr) (sr sr) (cookie cookie) (spk spk) (u u)
        (x x) (y y) (p p) (any any) (authstor authstor)
        (request request))))
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5))))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (spk akey)
    (s ca u name) (pt pval) (authstor locn) (x rndx) (y expt))
  (defstrand serverr 6 (cookie cookie) (request request) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (non-orig (invk spk) (privk ca))
  (uniq-orig sr)
  (uniq-gen x)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat pt "server store" s u cookie))))
  (label 368)
  (realized)
  (origs (sr (0 1)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (spk akey)
    (s ca u name) (pt pval) (authstor locn) (x rndx) (y expt))
  (defstrand serverr 6 (cookie cookie) (request request) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (non-orig (invk spk) (privk ca))
  (uniq-orig sr)
  (uniq-gen x)
  (gen-st (cat "server store" s u cookie))
  (facts (neq u s))
  (rule fact-serverr-neq0 gen-st-serverr-0)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat pt "server store" s u cookie))))
  (label 369)
  (parent 368)
  (unrealized (0 5))
  (origs (sr (0 1)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (s ca u ca-0 name)
    (pt pt-0 pval) (authstor locn) (x rndx) (y expt) (x-0 rndx)
    (y-0 expt))
  (defstrand serverr 6 (cookie cookie) (request request) (cr cr) (sr sr)
    (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x) (y y))
  (defstrand servera 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (authstor authstor)
    (x x-0) (y y-0))
  (precedes ((1 5) (0 4)) ((1 7) (0 5)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x x-0)
  (gen-st (cat "server store" s u cookie))
  (facts (neq u s))
  (leads-to ((1 7) (0 5)))
  (rule fact-serverr-neq0 trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt "server store" s u cookie)) (0 5))
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat pt "server store" s u cookie)))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr-0 sr-0)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr-0 sr-0)
            "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y-0)) cr-0 sr-0)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y-0)) cr-0 sr-0)
            "server_write"))) (load authstor (cat pt-0 any))
      (stor authstor (cat pt "server store" s u cookie))))
  (label 370)
  (parent 369)
  (realized)
  (shape)
  (maps
    ((0)
      ((s s) (ca ca) (cr cr) (sr sr) (spk spk) (u u) (x x) (y y)
        (cookie cookie) (authstor authstor) (request request))))
  (origs (cookie (1 5)) (pt (1 7)) (sr (0 1))))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (goals
    (forall
      ((cookie data) (p password) (cr sr random32) (spk akey)
        (u s ca name) (y rndx) (x expt) (z z-0 strd))
      (implies
        (and (p "clienta" z 10) (p "" z-0 2)
          (p "clienta" "cookie" z cookie) (p "clienta" "p" z p)
          (p "clienta" "cr" z cr) (p "clienta" "sr" z sr)
          (p "clienta" "spk" z spk) (p "clienta" "u" z u)
          (p "clienta" "s" z s) (p "clienta" "ca" z ca)
          (p "clienta" "y" z y) (p "clienta" "x" z x)
          (p "" "x" z-0 cookie) (non (invk spk)) (non (privk ca))
          (pnon p) (uniq sr) (ugen y) (uniq-at cr z 0)) (false))))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 371)
  (unrealized (1 1) (1 3))
  (origs (pt-0 (1 7)) (cr (1 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 372)
  (parent 371)
  (unrealized (1 1) (1 3))
  (origs (pt-0 (1 7)) (cr (1 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((2 1) (1 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 373)
  (parent 372)
  (unrealized (1 1) (1 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 2 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 374)
  (parent 373)
  (unrealized (1 3) (1 5) (1 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((1 0) (3 0)) ((2 1) (1 1)) ((3 1) (1 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 375)
  (parent 373)
  (unrealized (1 3) (1 5) (1 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((2 1) (1 1)) ((2 3) (1 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 376)
  (parent 374)
  (unrealized (1 5) (1 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (3 0)) ((2 1) (1 1)) ((3 1) (1 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 377)
  (parent 374)
  (unrealized (1 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 4 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 378)
  (parent 375)
  (unrealized (1 5) (1 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (4 0)) ((2 1) (1 1)) ((3 1) (1 1))
    ((4 1) (1 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 379)
  (parent 375)
  (unrealized (1 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (0 0)) ((2 5) (1 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 servera 6)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (1 5))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 380)
  (parent 376)
  (unrealized (0 0) (1 9) (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (3 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (1 5))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 381)
  (parent 376)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (4 0)) ((2 1) (1 1)) ((3 1) (1 3))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 382)
  (parent 377)
  (unrealized (1 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 4 servera 6)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-1)) cr sr) "server_write")) (1 5))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 383)
  (parent 378)
  (unrealized (0 0) (1 9) (3 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (4 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (1 5))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 384)
  (parent 378)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (5 0)) ((2 1) (1 1)) ((3 1) (1 1))
    ((4 1) (1 3)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 385)
  (parent 379)
  (unrealized (1 3) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((2 1) (1 1))
    ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 1 clienta 5)
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x)) cr sr) "client_write")) (2 4))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))))
  (label 386)
  (parent 380)
  (unrealized (0 0) (1 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (3 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5)) ((3 1) (2 4)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")) (2 4))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 387)
  (parent 380)
  (unrealized (0 0) (1 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (4 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 388)
  (parent 381)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (5 0)) ((2 1) (1 1)) ((3 1) (1 3))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 389)
  (parent 382)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 4 1 clienta 5)
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (3 4))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))))
  (label 390)
  (parent 383)
  (unrealized (0 0) (1 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (4 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5))
    ((4 1) (3 4)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")) (3 4))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 391)
  (parent 383)
  (unrealized (0 0) (1 9) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (5 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 392)
  (parent 384)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (6 0)) ((2 1) (1 1)) ((3 1) (1 1))
    ((4 1) (1 3)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 393)
  (parent 385)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((2 1) (1 1))
    ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5)) ((2 9) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 3 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) (1 9))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 394)
  (parent 386)
  (unrealized (0 0) (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (3 0)) ((1 4) (2 4))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((3 1) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")) (1 9))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 395)
  (parent 386)
  (unrealized (0 0) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (4 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "client_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 396)
  (parent 387)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 397)
  (parent 388)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (6 0)) ((2 1) (1 1)) ((3 1) (1 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 398)
  (parent 389)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (6 0)) ((2 1) (1 1)) ((3 1) (1 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 399)
  (parent 389)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5))
    ((3 9) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 4 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-1 y)) cr sr) "server_write")) (1 9))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 400)
  (parent 390)
  (unrealized (0 0) (3 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (4 0)) ((1 4) (3 4))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((4 1) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) (1 9))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 401)
  (parent 390)
  (unrealized (0 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (5 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5))
    ((4 1) (3 4)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 402)
  (parent 391)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 403)
  (parent 392)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (7 0)) ((2 1) (1 1)) ((3 1) (1 1))
    ((4 1) (1 3)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 404)
  (parent 393)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (7 0)) ((2 1) (1 1)) ((3 1) (1 1))
    ((4 1) (1 3)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 405)
  (parent 393)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (2 8))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((2 9) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 1 clienta 9)
    (enc cookie request-0
      (hash (hash (exp (gen) (mul y-0 x)) cr sr) "client_write")) (2 8))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))))
  (label 406)
  (parent 394)
  (unrealized (0 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (3 0)) ((1 4) (2 4))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 1) (2 8)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (enc cookie request-0
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")) (2 8))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 407)
  (parent 394)
  (unrealized (0 0) (2 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (4 0)) ((1 4) (2 4))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((3 1) (1 9)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x y)) cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 408)
  (parent 395)
  (unrealized (0 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 409)
  (parent 396)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 410)
  (parent 397)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 411)
  (parent 397)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (3 8))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((3 9) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 4 1 clienta 9)
    (enc cookie request-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (3 8))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))))
  (label 412)
  (parent 400)
  (unrealized (0 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (4 0)) ((1 4) (3 4))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (3 8)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (enc cookie request-0
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")) (3 8))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 413)
  (parent 400)
  (unrealized (0 0) (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (5 0)) ((1 4) (3 4))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((4 1) (1 9)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 414)
  (parent 401)
  (unrealized (0 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 415)
  (parent 402)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 416)
  (parent 403)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 417)
  (parent 403)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 9) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 1 clienta 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y-0)) cr sr) "server_write")))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))))
  (label 418)
  (parent 406)
  (unrealized (0 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (2 8))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5)) ((2 7) (0 0))
    ((2 9) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 2 servera 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 419)
  (parent 406)
  (seen 434)
  (unrealized (0 0))
  (comment "2 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (3 0)) ((1 4) (2 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 420)
  (parent 406)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (4 0)) ((1 4) (2 4))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 1) (2 8)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "client_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 421)
  (parent 407)
  (unrealized (0 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((3 1) (1 9)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 422)
  (parent 408)
  (unrealized (0 0) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 423)
  (parent 409)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 424)
  (parent 409)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 9) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 4 1 clienta 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))))
  (label 425)
  (parent 412)
  (unrealized (0 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (3 8))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (1 5))
    ((3 7) (0 0)) ((3 9) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 4 3 servera 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-1 y)) cr sr) "server_write")))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 426)
  (parent 412)
  (seen 443)
  (unrealized (0 0))
  (comment "2 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (4 0)) ((1 4) (3 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (0 0)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 427)
  (parent 412)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (5 0)) ((1 4) (3 4))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (3 8)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 428)
  (parent 413)
  (unrealized (0 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((4 1) (1 9)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 429)
  (parent 414)
  (unrealized (0 0) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 430)
  (parent 415)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0)) ((3 5) (1 5))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 431)
  (parent 415)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y y-0 rndx) (x-0 expt))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (3 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 5) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))))
  (label 432)
  (parent 418)
  (realized)
  (shape)
  (satisfies
    (no (fact false) (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
      (u u) (s s) (ca ca) (y y) (x x) (z 1) (z-0 0)))
  (maps
    ((0 1)
      ((cookie cookie) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
        (ca ca) (y y) (x x) (any any) (cookiestor cookiestor)
        (request request) (response response))))
  (origs (pt-0 (1 7)) (cookie (2 5)) (pt-2 (2 7)) (sr (2 1))
    (cr (1 0))))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 9) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 1 clienta 9) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y-0)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))))
  (label 433)
  (parent 418)
  (unrealized (0 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 2 servera 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 434)
  (parent 418)
  (seen 450)
  (unrealized (0 0))
  (comment "3 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (3 0)) ((1 4) (2 4))
    ((1 7) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 435)
  (parent 418)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (3 0)) ((1 4) (2 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 436)
  (parent 419)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (4 0)) ((1 4) (2 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x y)) cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 437)
  (parent 420)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 438)
  (parent 421)
  (unrealized (0 0) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((3 1) (1 9)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 439)
  (parent 422)
  (unrealized (0 0) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((3 1) (1 9)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 440)
  (parent 422)
  (unrealized (0 0) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x x-0 y y-0 rndx) (x-1 expt))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (4 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 5) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))))
  (label 441)
  (parent 425)
  (seen 432)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 9) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 4 1 clienta 9) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))))
  (label 442)
  (parent 425)
  (unrealized (0 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 4 3 servera 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-1 y)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 443)
  (parent 425)
  (seen 461)
  (unrealized (0 0))
  (comment "3 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (4 0)) ((1 4) (3 4))
    ((1 7) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 444)
  (parent 425)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (4 0)) ((1 4) (3 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)) ((4 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 445)
  (parent 426)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (5 0)) ((1 4) (3 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (0 0)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 446)
  (parent 427)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (3 8)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 447)
  (parent 428)
  (unrealized (0 0) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((4 1) (1 9)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 448)
  (parent 429)
  (unrealized (0 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((4 1) (1 9)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 449)
  (parent 429)
  (unrealized (0 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 8) (0 0))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 3 2 servera 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 450)
  (parent 433)
  (unrealized (0 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y y-0 rndx) (x-0 expt))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (3 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 5) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))))
  (label 451)
  (parent 433)
  (seen 432)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (3 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
  (label 452)
  (parent 433)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (3 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 453)
  (parent 433)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x y-0 rndx) (x-0 expt))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (3 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)) ((3 5) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))))
  (label 454)
  (parent 434)
  (seen 432)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (3 0)) ((1 4) (2 4))
    ((1 7) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 455)
  (parent 434)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (4 0)) ((1 4) (2 4))
    ((1 7) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x y)) cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 456)
  (parent 435)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (4 0)) ((1 4) (2 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 457)
  (parent 436)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 458)
  (parent 437)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 459)
  (parent 438)
  (unrealized (0 0) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0)) ((2 5) (1 5))
    ((2 9) (1 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 460)
  (parent 438)
  (unrealized (0 0) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 8) (0 0))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (displaced 4 3 servera 8) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-1 y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x-1 y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 461)
  (parent 442)
  (unrealized (0 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x x-0 y y-0 rndx) (x-1 expt))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (4 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 5) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))))
  (label 462)
  (parent 442)
  (seen 451)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (4 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))))
  (label 463)
  (parent 442)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (4 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 464)
  (parent 442)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 y-0 rndx) (x-1 expt))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (4 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)) ((4 5) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))))
  (label 465)
  (parent 443)
  (seen 454)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (4 0)) ((1 4) (3 4))
    ((1 7) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 466)
  (parent 443)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (5 0)) ((1 4) (3 4))
    ((1 7) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 467)
  (parent 444)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (5 0)) ((1 4) (3 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 468)
  (parent 445)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (0 0)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 469)
  (parent 446)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (3 8)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 470)
  (parent 447)
  (unrealized (0 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3)) ((3 5) (0 0))
    ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (3 8)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 471)
  (parent 447)
  (unrealized (0 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x y-0 rndx) (x-0 expt))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 4) (2 4)) ((1 7) (3 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 5) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (3 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))))
  (label 472)
  (parent 450)
  (seen 454)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (3 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 473)
  (parent 450)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (3 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 474)
  (parent 450)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (4 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul x y)) cr sr) "client_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
  (label 475)
  (parent 452)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (4 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x y)) cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 476)
  (parent 453)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (4 0)) ((1 4) (2 4))
    ((1 7) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 477)
  (parent 455)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 7) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 478)
  (parent 456)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 479)
  (parent 457)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 480)
  (parent 458)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (0 0))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 481)
  (parent 458)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 y-0 rndx) (x-1 expt))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (defstrand clientr 6 (cookie cookie) (request request-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 4) (3 4)) ((1 7) (4 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 5) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u s))
  (leads-to ((1 7) (4 4)))
  (rule fact-servera-neq0 gen-st-clientr-0 trRl_clienta-at-6
    trRl_clienta-at-7 trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-strand clientr 6) cookie (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (load cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))))
  (label 482)
  (parent 461)
  (seen 472)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (4 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 483)
  (parent 461)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (4 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) cookie
    (0 0)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc cookie request
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (ch-msg cookiestor (cat pt-0 "client store" u s cookie))
    (ch-msg authstor (cat pt-2 "server store" s u cookie)))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 484)
  (parent 461)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (5 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))))
  (label 485)
  (parent 463)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (5 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 486)
  (parent 464)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (5 0)) ((1 4) (3 4))
    ((1 7) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 487)
  (parent 466)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 7) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 488)
  (parent 467)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 489)
  (parent 468)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (0 0)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 490)
  (parent 469)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (0 0)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 491)
  (parent 469)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (4 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "client_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 492)
  (parent 473)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (4 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 493)
  (parent 474)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 494)
  (parent 475)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 495)
  (parent 476)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 7) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 496)
  (parent 477)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 7) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 497)
  (parent 478)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 7) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 498)
  (parent 478)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 499)
  (parent 479)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3)) ((2 5) (1 5))
    ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 500)
  (parent 479)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (5 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 501)
  (parent 483)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (5 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 502)
  (parent 484)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 503)
  (parent 485)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 504)
  (parent 486)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 7) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 505)
  (parent 487)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 7) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 506)
  (parent 488)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 7) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 507)
  (parent 488)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 508)
  (parent 489)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 3) (1 3))
    ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 509)
  (parent 489)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 510)
  (parent 492)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 511)
  (parent 493)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 512)
  (parent 494)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 513)
  (parent 494)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 514)
  (parent 495)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 9) (1 9)) ((3 1) (0 0)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 515)
  (parent 495)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 7) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 516)
  (parent 496)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 7) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 517)
  (parent 496)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 518)
  (parent 501)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 519)
  (parent 502)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 520)
  (parent 503)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 521)
  (parent 503)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 522)
  (parent 504)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 9) (1 9)) ((4 1) (0 0))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 523)
  (parent 504)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 7) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 524)
  (parent 505)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 7) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 525)
  (parent 505)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 526)
  (parent 510)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 527)
  (parent 510)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 528)
  (parent 511)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((1 4) (2 4))
    ((1 8) (0 0)) ((1 8) (2 8)) ((2 1) (1 1)) ((2 3) (1 3))
    ((2 5) (1 5)) ((2 7) (0 0)) ((2 9) (1 9)) ((3 1) (0 0))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 529)
  (parent 511)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 530)
  (parent 518)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 531)
  (parent 518)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 532)
  (parent 519)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((1 4) (3 4))
    ((1 8) (0 0)) ((1 8) (3 8)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((3 5) (1 5)) ((3 7) (0 0)) ((3 9) (1 9))
    ((4 1) (0 0)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 533)
  (parent 519)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (goals
    (forall
      ((cookie data) (cr sr random32) (spk akey) (u s ca name) (y rndx)
        (x expt) (z strd))
      (implies
        (and (p "clienta" z 10) (p "clienta" "cookie" z cookie)
          (p "clienta" "cr" z cr) (p "clienta" "sr" z sr)
          (p "clienta" "spk" z spk) (p "clienta" "u" z u)
          (p "clienta" "s" z s) (p "clienta" "ca" z ca)
          (p "clienta" "y" z y) (p "clienta" "x" z x) (non (invk spk))
          (non (privk ca)) (uniq sr) (ugen y) (uniq-at cr z 0))
        (exists ((z-0 strd))
          (and (p "servera" "cookie" z-0 cookie)
            (p "servera" "spk" z-0 spk) (p "servera" "u" z-0 u)
            (p "servera" "s" z-0 s) (p "servera" "ca" z-0 ca)
            (uniq-at cookie z-0 5) (fact neq u s))))))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 534)
  (unrealized (0 1) (0 3))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 535)
  (parent 534)
  (unrealized (0 1) (0 3))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 536)
  (parent 535)
  (unrealized (0 1) (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 537)
  (parent 536)
  (unrealized (0 3) (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 538)
  (parent 536)
  (unrealized (0 3) (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 539)
  (parent 537)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (2 0)) ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 540)
  (parent 537)
  (unrealized (0 3) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 541)
  (parent 538)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 542)
  (parent 538)
  (unrealized (0 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 servera 6)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 543)
  (parent 539)
  (unrealized (0 9) (1 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 544)
  (parent 539)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 545)
  (parent 540)
  (unrealized (0 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 servera 6)
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-1)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 546)
  (parent 541)
  (unrealized (0 9) (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 547)
  (parent 541)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 548)
  (parent 542)
  (unrealized (0 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 0 clienta 5)
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x)) cr sr) "client_write")) (1 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))))
  (label 549)
  (parent 543)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")) (1 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 550)
  (parent 543)
  (unrealized (0 9) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 551)
  (parent 544)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 552)
  (parent 545)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clienta 5)
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))))
  (label 553)
  (parent 546)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")) (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 554)
  (parent 546)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 555)
  (parent 547)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 556)
  (parent 548)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 2 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 557)
  (parent 549)
  (unrealized (1 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 558)
  (parent 549)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "client_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 559)
  (parent 550)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 560)
  (parent 551)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 561)
  (parent 552)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 562)
  (parent 552)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 3 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-1 y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 563)
  (parent 553)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 564)
  (parent 553)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 565)
  (parent 554)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 566)
  (parent 555)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 567)
  (parent 556)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 568)
  (parent 556)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((0 8) (1 8))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 0 clienta 9)
    (enc cookie request-0
      (hash (hash (exp (gen) (mul y-0 x)) cr sr) "client_write")) (1 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))))
  (label 569)
  (parent 557)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cookie cookie) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
        (y y) (x x) (p p) (any any) (cookiestor cookiestor)
        (request request) (response response))))
  (origs (pt-0 (0 7)) (cookie (1 5)) (pt-2 (1 7)) (sr (1 1))
    (cr (0 0))))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (enc cookie request-0
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")) (1 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 570)
  (parent 557)
  (unrealized (1 8) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x y)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 571)
  (parent 558)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 572)
  (parent 559)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 573)
  (parent 560)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 574)
  (parent 560)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (2 8))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 0 clienta 9)
    (enc cookie request-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (2 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))))
  (label 575)
  (parent 563)
  (seen 569)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (enc cookie request-0
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")) (2 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 576)
  (parent 563)
  (unrealized (2 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 577)
  (parent 564)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 578)
  (parent 565)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 579)
  (parent 566)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 580)
  (parent 566)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "client_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 581)
  (parent 570)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 582)
  (parent 571)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 583)
  (parent 572)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (spk akey) (u u-0 s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 584)
  (parent 572)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 585)
  (parent 576)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 586)
  (parent 577)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 587)
  (parent 578)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (spk spk)
    (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 588)
  (parent 578)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 589)
  (parent 581)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 590)
  (parent 582)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 591)
  (parent 582)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 592)
  (parent 585)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 593)
  (parent 586)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 594)
  (parent 586)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 595)
  (parent 589)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (spk akey)
    (u s ca name) (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn)
    (y x rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 596)
  (parent 589)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 597)
  (parent 592)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10 (any any) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc cookie request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 598)
  (parent 592)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie data) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (goals
    (forall
      ((cookie data) (cr sr random32) (spk akey) (s ca u name) (y rndx)
        (x expt) (z strd))
      (implies
        (and (p "clientr" z 7) (p "clientr" "cookie" z cookie)
          (p "clientr" "cr" z cr) (p "clientr" "sr" z sr)
          (p "clientr" "spk" z spk) (p "clientr" "u" z u)
          (p "clientr" "s" z s) (p "clientr" "ca" z ca)
          (p "clientr" "y" z y) (p "clientr" "x" z x) (non (invk spk))
          (non (privk ca)) (uniq sr) (ugen y) (uniq-at cr z 0))
        (exists ((z-0 strd))
          (and (p "servera" "cookie" z-0 cookie)
            (p "servera" "spk" z-0 spk) (p "servera" "u" z-0 u)
            (p "servera" "s" z-0 s) (p "servera" "ca" z-0 ca)
            (uniq-at cookie z-0 5) (fact neq u s))))))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 599)
  (unrealized (0 1) (0 3))
  (origs (cr (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (gen-st (cat "client store" u s cookie))
  (rule gen-st-clientr-0)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 600)
  (parent 599)
  (unrealized (0 1) (0 3) (0 4))
  (origs (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 601)
  (parent 600)
  (unrealized (0 1) (0 3) (0 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 602)
  (parent 601)
  (unrealized (0 3) (0 4) (0 6))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 603)
  (parent 601)
  (unrealized (0 3) (0 4) (0 6))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 604)
  (parent 602)
  (unrealized (0 4) (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (2 0)) ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 605)
  (parent 602)
  (unrealized (0 3) (0 4) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (x y x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 606)
  (parent 603)
  (unrealized (0 4) (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 607)
  (parent 603)
  (unrealized (0 3) (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 7) (0 4)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor (cat pt "client store" u s cookie)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie))))
  (label 608)
  (parent 604)
  (unrealized (0 6))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 609)
  (parent 605)
  (unrealized (0 3) (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 7) (0 4)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor (cat pt "client store" u s cookie)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie))))
  (label 610)
  (parent 606)
  (unrealized (0 6))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 611)
  (parent 607)
  (unrealized (0 3) (0 4) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0)
    (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 9) (0 6)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 3 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write"))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))))
  (label 612)
  (parent 608)
  (unrealized (2 4) (2 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 6) (0 6)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation encryption-test (displaced 1 3 serverr 7)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write"))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))))
  (label 613)
  (parent 608)
  (unrealized (2 4) (2 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 614)
  (parent 608)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 615)
  (parent 609)
  (unrealized (0 4) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1)
    (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 4 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-2)) cr sr) "server_write"))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))))
  (label 616)
  (parent 610)
  (unrealized (3 4) (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation encryption-test (displaced 2 4 serverr 7)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-2)) cr sr) "server_write"))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))))
  (label 617)
  (parent 610)
  (unrealized (3 4) (3 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 618)
  (parent 610)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 619)
  (parent 611)
  (unrealized (0 4) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 620)
  (parent 612)
  (unrealized (2 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clientr 6)
    (enc cookie-0 request-0
      (hash (hash (exp (gen) (mul y-1 x-0)) cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write")))))
  (label 621)
  (parent 613)
  (unrealized (2 5))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (enc cookie-0 request-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 622)
  (parent 613)
  (unrealized (2 5) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 623)
  (parent 614)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st (cat "client store" u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 624)
  (parent 615)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st (cat "client store" u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 625)
  (parent 615)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 626)
  (parent 616)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (x-1 y-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 5) (3 4)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y x-1 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 4 0 clientr 6)
    (enc cookie-0 request-0
      (hash (hash (exp (gen) (mul y-1 x-1)) cr sr) "client_write"))
    (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write")))))
  (label 627)
  (parent 617)
  (unrealized (3 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (enc cookie-0 request-0
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 628)
  (parent 617)
  (unrealized (3 5) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 629)
  (parent 618)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st (cat "client store" u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 630)
  (parent 619)
  (unrealized (0 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st (cat "client store" u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 631)
  (parent 619)
  (unrealized (0 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 632)
  (parent 620)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 spk-1 akey)
    (u ca u-0 s ca-0 ca-1 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 x-1 rndx)
    (y-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-1) (u u-0) (s s) (ca ca-1) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (2 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul x-1 y-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul x-1 y-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 633)
  (parent 621)
  (realized)
  (shape)
  (satisfies
    (no (p "servera" "spk" z-0 spk) (cookie cookie) (cr cr) (sr sr)
      (spk spk-0) (s s) (ca ca-0) (u u) (y y-0) (x x-0) (z 0)))
  (maps
    ((0)
      ((cookie cookie) (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (u u)
        (y y-0) (x x-0) (cookiestor cookiestor) (request request)
        (response response))))
  (origs (cookie (3 5)) (pt-1 (3 7)) (pt (1 7)) (sr (2 1)) (cr (0 0))))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 634)
  (parent 622)
  (unrealized (2 5) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 635)
  (parent 623)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 636)
  (parent 626)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (0 1))
    ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (displaced 1 4 servera 8)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (3 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 637)
  (parent 627)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 cr-2 sr-2 random32)
    (spk spk-0 spk-1 akey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (x y rndx)
    (x-0 expt) (x-1 y-0 x-2 rndx) (y-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-2)
    (sr sr-2) (spk spk-1) (u u-0) (s s) (ca ca-1) (authstor authstor)
    (x x-2) (y y-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 5) (3 4)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 5) (2 5)) ((4 7) (3 5)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-1 y-0 x-2)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)) ((4 7) (3 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (3 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write"))))
    ((recv cr-2)
      (send
        (cat sr-2 (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
          (exp (gen) x-2)
          (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul x-2 y-1)) "client finished"
              (hash cr-2 sr-2
                (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                (cat (exp (gen) x-2)
                  (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-2 y-1)) "server finished"
            (hash cr-2 sr-2
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (cat (exp (gen) x-2)
                (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul x-2 y-1)) "client finished"
                  (hash cr-2 sr-2
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                    (cat (exp (gen) x-2)
                      (enc (hash cr-2 sr-2 (exp (gen) x-2))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 638)
  (parent 627)
  (seen 633)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 639)
  (parent 628)
  (unrealized (3 5) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 640)
  (parent 629)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) cr sr))
    (hash (exp (gen) (mul y-0 x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr))))
  (label 641)
  (parent 632)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) cr sr))
    (hash (exp (gen) (mul y-0 x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr))))
  (label 642)
  (parent 634)
  (unrealized (2 5) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 643)
  (parent 635)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 644)
  (parent 635)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-1)) cr sr))
    (hash (exp (gen) (mul y-0 x-1)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr))))
  (label 645)
  (parent 636)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 2))
    ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization weakened ((3 1) (0 1)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 646)
  (parent 637)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-1)) cr sr))
    (hash (exp (gen) (mul y-0 x-1)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr))))
  (label 647)
  (parent 639)
  (unrealized (3 5) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 648)
  (parent 640)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 649)
  (parent 640)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 650)
  (parent 641)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-0)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 651)
  (parent 641)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 652)
  (parent 642)
  (unrealized (2 5) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 653)
  (parent 642)
  (unrealized (2 5) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-1))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-1)) (send (cat (exp (gen) y-0) x-1))))
  (label 654)
  (parent 645)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor) (x x-1)
    (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) x-1) y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-0))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful" cookie-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) x-1) y-0)) (send (cat (exp (gen) x-1) y-0))))
  (label 655)
  (parent 645)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (0 3))
    ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization weakened ((3 1) (2 2)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 656)
  (parent 646)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-1))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-1)) (send (cat (exp (gen) y-0) x-1))))
  (label 657)
  (parent 647)
  (unrealized (3 5) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) x-1) y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-0))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc cookie-0 request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) x-1) y-0)) (send (cat (exp (gen) x-1) y-0))))
  (label 658)
  (parent 647)
  (unrealized (3 5) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization weakened ((3 1) (0 3)))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 659)
  (parent 656)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 spk-1 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-1) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (invk spk-0) (invk spk-1) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization separated spk-1)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 660)
  (parent 659)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 spk-1 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-1) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization forgot (invk spk-1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 661)
  (parent 660)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 spk-1 akey)
    (u ca u-0 s ca-0 ca-1 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (any any) (cookie cookie) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u-0) (s s)
    (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (spk spk-1) (u u-0) (s s) (ca ca-1) (authstor authstor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig (invk spk-0) (privk ca-0) (privk ca-1))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation generalization separated ca-1)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc cookie request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 662)
  (parent 661)
  (seen 633)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(comment "Nothing left to do")
