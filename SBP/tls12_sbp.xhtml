<?xml version="1.0"?>
<!-- CPSA 4.4.2 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Session Binding Protocol with TLS 1.2 (uses the modified server as implemented and tested in the paper and the cookie authentication model (ca.scm) which showed the cookie stealing attack).</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(herald
  &quot;Session Binding Protocol with TLS 1.2 (uses the modified server as implemented and tested in the paper and the cookie authentication model (ca.scm) which showed the cookie stealing attack).&quot;
  (bound 12))
(comment &quot;CPSA 4.4.2&quot;)
(comment &quot;All input read from tls12_sbp.scm&quot;)
(comment &quot;Strand count bounded at 12&quot;)</pre>

<p id="top">Trees: <a href="#t0">0</a> <a href="#t40">40</a> <a href="#t54">54</a> <a href="#t94">94</a> <a href="#t96">96</a> <a href="#t98">98</a> <a href="#t101">101</a> <a href="#t115">115</a> <a href="#t155">155</a>.</p>

<p id="t0">Tree <a href="#top">0</a>, POV <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='529.200pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 529.200 829.920' font-size='12.000'>
  <text
   x='289.560' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k17&quot;, &quot;_self&quot;)'>17</text>
  <line
   x1='239.640' y1='789.960' x2='289.560' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k10&quot;, &quot;_self&quot;)'>10</text>
  <line
   x1='189.720' y1='789.960' x2='239.640' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k5&quot;, &quot;_self&quot;)'>5</text>
  <line
   x1='139.800' y1='414.960' x2='189.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k25&quot;, &quot;_self&quot;)'>25</text>
  <line
   x1='289.560' y1='714.960' x2='339.480' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k16&quot;, &quot;_self&quot;)'>16</text>
  <line
   x1='239.640' y1='714.960' x2='289.560' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k9&quot;, &quot;_self&quot;)'>9</text>
  <line
   x1='189.720' y1='564.960' x2='239.640' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k33&quot;, &quot;_self&quot;)'>33</text>
  <line
   x1='339.480' y1='639.960' x2='389.400' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k24&quot;, &quot;_self&quot;)'>24</text>
  <line
   x1='289.560' y1='639.960' x2='339.480' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k15&quot;, &quot;_self&quot;)'>15</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k37&quot;, &quot;_self&quot;)'>37</text>
  <line
   x1='389.400' y1='564.960' x2='439.320' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k32&quot;, &quot;_self&quot;)'>32</text>
  <line
   x1='339.480' y1='564.960' x2='389.400' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k23&quot;, &quot;_self&quot;)'>23</text>
  <line
   x1='289.560' y1='489.960' x2='339.480' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k39&quot;, &quot;_self&quot;)'>39</text>
  <line
   x1='439.320' y1='489.960' x2='489.240' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k36&quot;, &quot;_self&quot;)'>36</text>
  <line
   x1='389.400' y1='489.960' x2='439.320' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k31&quot;, &quot;_self&quot;)'>31</text>
  <line
   x1='339.480' y1='452.460' x2='389.400' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='401.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k26&quot;, &quot;_self&quot;)'>26</text>
  <line
   x1='389.400' y1='414.960' x2='439.320' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k30&quot;, &quot;_self&quot;)'>30</text>
  <line
   x1='339.480' y1='452.460' x2='389.400' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='438.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k22&quot;, &quot;_self&quot;)'>22</text>
  <line
   x1='289.560' y1='489.960' x2='339.480' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='476.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k14&quot;, &quot;_self&quot;)'>14</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='513.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k8&quot;, &quot;_self&quot;)'>8</text>
  <line
   x1='189.720' y1='564.960' x2='239.640' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='551.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  <line
   x1='139.800' y1='414.960' x2='189.720' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k21&quot;, &quot;_self&quot;)'>21</text>
  <line
   x1='289.560' y1='339.960' x2='339.480' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k13&quot;, &quot;_self&quot;)'>13</text>
  <line
   x1='239.640' y1='339.960' x2='289.560' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k7&quot;, &quot;_self&quot;)'>7</text>
  <line
   x1='189.720' y1='189.960' x2='239.640' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k29&quot;, &quot;_self&quot;)'>29</text>
  <line
   x1='339.480' y1='264.960' x2='389.400' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k20&quot;, &quot;_self&quot;)'>20</text>
  <line
   x1='289.560' y1='264.960' x2='339.480' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k12&quot;, &quot;_self&quot;)'>12</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k35&quot;, &quot;_self&quot;)'>35</text>
  <line
   x1='389.400' y1='189.960' x2='439.320' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k28&quot;, &quot;_self&quot;)'>28</text>
  <line
   x1='339.480' y1='189.960' x2='389.400' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k19&quot;, &quot;_self&quot;)'>19</text>
  <line
   x1='289.560' y1='114.960' x2='339.480' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k38&quot;, &quot;_self&quot;)'>38</text>
  <line
   x1='439.320' y1='114.960' x2='489.240' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k34&quot;, &quot;_self&quot;)'>34</text>
  <line
   x1='389.400' y1='114.960' x2='439.320' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k27&quot;, &quot;_self&quot;)'>27</text>
  <line
   x1='339.480' y1='77.460' x2='389.400' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k26&quot;, &quot;_self&quot;)'>26</text>
  <line
   x1='339.480' y1='77.460' x2='389.400' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k18&quot;, &quot;_self&quot;)'>18</text>
  <line
   x1='289.560' y1='114.960' x2='339.480' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k11&quot;, &quot;_self&quot;)'>11</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='138.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='189.720' y1='189.960' x2='239.640' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  <line
   x1='139.800' y1='414.960' x2='189.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k2&quot;, &quot;_self&quot;)'>2</text>
  <line
   x1='89.880' y1='414.960' x2='139.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k1&quot;, &quot;_self&quot;)'>1</text>
  <line
   x1='39.960' y1='414.960' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie mesg)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (ppk skey) (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))</pre>

<p id="k0">Item <a href="#t0">0</a>, Child: <a href="#k1">1</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 0</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 0)
  (unrealized (0 1) (0 3) (0 5) (0 9))
  (origs (pt-0 (0 7)) (cr (0 0)) (pms (0 2)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k1">Item <a href="#t0">1</a>, Parent: <a href="#k0">0</a>, Child: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 1</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 1)
  (parent 0)
  (unrealized (0 1) (0 3) (0 5) (0 9))
  (origs (pt-0 (0 7)) (cr (0 0)) (pms (0 2)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k2">Item <a href="#t0">2</a>, Parent: <a href="#k1">1</a>, Children: <a href="#k3">3</a> <a href="#k4">4</a> <a href="#k5">5</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 2</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (precedes ((1 1) (0 1)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s (pubk s)) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))))
  (label 2)
  (parent 1)
  (unrealized (0 3) (0 5) (0 9))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k3">Item <a href="#t0">3</a>, Parent: <a href="#k2">2</a>, Children: <a href="#k6">6</a> <a href="#k7">7</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 3</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 3)
  (parent 2)
  (unrealized (0 5) (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k4">Item <a href="#t0">4</a>, Parent: <a href="#k2">2</a>, Children: <a href="#k8">8</a> <a href="#k9">9</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 4</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 4)
  (parent 2)
  (unrealized (0 5) (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k5">Item <a href="#t0">5</a>, Parent: <a href="#k2">2</a>, Child: <a href="#k10">10</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 5</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 5)
  (parent 2)
  (unrealized (0 3) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k6">Item <a href="#t0">6</a>, Parent: <a href="#k3">3</a>, Children: <a href="#k11">11</a> <a href="#k12">12</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 6</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (ppk skey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 servera 6)
    (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 6)
  (parent 3)
  (unrealized (0 9) (1 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k7">Item <a href="#t0">7</a>, Parent: <a href="#k3">3</a>, Child: <a href="#k13">13</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 141.584 299.964 43.287 484.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 7</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot; cookie
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 7)
  (parent 3)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k8">Item <a href="#t0">8</a>, Parent: <a href="#k4">4</a>, Children: <a href="#k14">14</a> <a href="#k15">15</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 8</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (ppk skey) (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 servera 6)
    (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 8)
  (parent 4)
  (unrealized (0 9) (2 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k9">Item <a href="#t0">9</a>, Parent: <a href="#k4">4</a>, Child: <a href="#k16">16</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 192.021 300.338 44.202 485.716'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 9</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot; cookie
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 9)
  (parent 4)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k10">Item <a href="#t0">10</a>, Parent: <a href="#k5">5</a>, Child: <a href="#k17">17</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 10</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 10)
  (parent 5)
  (unrealized (0 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k11">Item <a href="#t0">11</a>, Parent: <a href="#k6">6</a>, Children: <a href="#k18">18</a> <a href="#k19">19</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 11</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 0 clienta 5)
    (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (1 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 11)
  (parent 6)
  (unrealized (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k12">Item <a href="#t0">12</a>, Parent: <a href="#k6">6</a>, Child: <a href="#k20">20</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 191.118 299.718 142.356 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 12</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (ppk skey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)) ((2 1) (1 4)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (1 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 12)
  (parent 6)
  (unrealized (0 9) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k13">Item <a href="#t0">13</a>, Parent: <a href="#k7">7</a>, Child: <a href="#k21">21</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 141.913 337.717 43.945 485.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 13</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 5)) ((3 1) (2 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 13)
  (parent 7)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k14">Item <a href="#t0">14</a>, Parent: <a href="#k8">8</a>, Children: <a href="#k22">22</a> <a href="#k23">23</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 14</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clienta 5)
    (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 14)
  (parent 8)
  (unrealized (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k15">Item <a href="#t0">15</a>, Parent: <a href="#k8">8</a>, Child: <a href="#k24">24</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 291.078 299.718 242.316 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 15</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (ppk skey) (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 15)
  (parent 8)
  (unrealized (0 9) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k16">Item <a href="#t0">16</a>, Parent: <a href="#k9">9</a>, Child: <a href="#k25">25</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.300 338.160 44.759 486.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 16</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 16)
  (parent 9)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k17">Item <a href="#t0">17</a>, Parent: <a href="#k10">10</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 17</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 17)
  (parent 10)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k18">Item <a href="#t0">18</a>, Parent: <a href="#k11">11</a>, Children: <a href="#k26">26</a> <a href="#k27">27</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 18</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 2 servera 10)
    (enc response (hash (hash pms cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 18)
  (parent 11)
  (unrealized (1 8))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k19">Item <a href="#t0">19</a>, Parent: <a href="#k11">11</a>, Child: <a href="#k28">28</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 140.868 449.614 41.857 784.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 19</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc response (hash (hash pms cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 19)
  (parent 11)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k20">Item <a href="#t0">20</a>, Parent: <a href="#k12">12</a>, Child: <a href="#k29">29</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 191.564 337.464 143.247 409.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 20</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (ppk skey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 20)
  (parent 12)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k21">Item <a href="#t0">21</a>, Parent: <a href="#k13">13</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 21</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 21)
  (parent 13)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k22">Item <a href="#t0">22</a>, Parent: <a href="#k14">14</a>, Children: <a href="#k30">30</a> <a href="#k31">31</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 22</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 3 servera 10)
    (enc response (hash (hash pms cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 22)
  (parent 14)
  (unrealized (2 8))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k23">Item <a href="#t0">23</a>, Parent: <a href="#k14">14</a>, Child: <a href="#k32">32</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 191.241 449.776 42.642 784.593'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 23</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (0 9)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc response (hash (hash pms cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 23)
  (parent 14)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k24">Item <a href="#t0">24</a>, Parent: <a href="#k15">15</a>, Child: <a href="#k33">33</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 291.524 337.464 243.207 409.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 24</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (ppk skey) (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)) ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 24)
  (parent 15)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k25">Item <a href="#t0">25</a>, Parent: <a href="#k16">16</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 25</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 25)
  (parent 16)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k26">Item <a href="#t0">26</a>, Parent: <a href="#k18">18</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 26</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((0 8) (1 8))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 0 clienta 9)
    (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
      (hash (hash pms cr sr) &quot;client_write&quot;)) (1 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 26)
  (parent 18)
  (realized)
  (shape)
  (maps
    ((0)
      ((u u) (s s) (ca ca) (p p) (cr cr) (sr sr) (pms pms)
        (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
        (cookiestor cookiestor) (request request) (response response))))
  (origs (pt-0 (0 7)) (cookie (1 5)) (pt-2 (1 7)) (cr (0 0)) (pms (0 2))
    (sr (1 1))))</pre>

<p id="k27">Item <a href="#t0">27</a>, Parent: <a href="#k18">18</a>, Child: <a href="#k34">34</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 190.461 449.513 141.042 709.066'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 27</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)) ((2 1) (1 8)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
      (hash (hash pms cr sr) &quot;client_write&quot;)) (1 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 27)
  (parent 18)
  (unrealized (1 8) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k28">Item <a href="#t0">28</a>, Parent: <a href="#k19">19</a>, Child: <a href="#k35">35</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 140.988 487.156 42.095 784.353'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 28</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9)) ((3 1) (2 0)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 28)
  (parent 19)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k29">Item <a href="#t0">29</a>, Parent: <a href="#k20">20</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 87.540 300.660 135.121 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 29</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (ppk skey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 29)
  (parent 20)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k30">Item <a href="#t0">30</a>, Parent: <a href="#k22">22</a>, Seen Child: <a href="#k26">26</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 30</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (2 8))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 0 clienta 9)
    (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
      (hash (hash pms cr sr) &quot;client_write&quot;)) (2 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 30)
  (parent 22)
  (seen 26)
  (realized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k31">Item <a href="#t0">31</a>, Parent: <a href="#k22">22</a>, Child: <a href="#k36">36</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 290.421 449.513 241.002 709.066'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 31</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9))
    ((3 1) (2 8)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
      (hash (hash pms cr sr) &quot;client_write&quot;)) (2 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 31)
  (parent 22)
  (unrealized (2 8) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k32">Item <a href="#t0">32</a>, Parent: <a href="#k23">23</a>, Child: <a href="#k37">37</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 191.388 487.355 42.936 784.750'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 32</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (0 9))
    ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 32)
  (parent 23)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k33">Item <a href="#t0">33</a>, Parent: <a href="#k24">24</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.111 263.906 234.262 337.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 33</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (ppk skey) (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 33)
  (parent 24)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k34">Item <a href="#t0">34</a>, Parent: <a href="#k27">27</a>, Child: <a href="#k38">38</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 190.551 487.031 141.221 709.103'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 34</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)) ((2 1) (1 8))
    ((3 1) (2 0)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 34)
  (parent 27)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k35">Item <a href="#t0">35</a>, Parent: <a href="#k28">28</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 141.584 599.964 43.287 784.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 35</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 35)
  (parent 28)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k36">Item <a href="#t0">36</a>, Parent: <a href="#k31">31</a>, Child: <a href="#k39">39</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 290.511 487.031 241.181 709.103'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 36</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9))
    ((3 1) (2 8)) ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 36)
  (parent 31)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k37">Item <a href="#t0">37</a>, Parent: <a href="#k32">32</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.021 600.338 44.202 785.717'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 37</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 37)
  (parent 32)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k38">Item <a href="#t0">38</a>, Parent: <a href="#k34">34</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 191.118 599.718 142.356 709.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 38</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 38)
  (parent 34)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k39">Item <a href="#t0">39</a>, Parent: <a href="#k36">36</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 291.078 599.718 242.316 709.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 39</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 39)
  (parent 36)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t40">Tree <a href="#top">40</a>, POV <a href="#k40">40</a>.</p>

<div>
 <svg
  class='diagram' width='379.440pt' height='229.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.440 229.920' font-size='12.000'>
  <text
   x='289.560' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k51&quot;, &quot;_self&quot;)'>51</text>
  <line
   x1='239.640' y1='189.960' x2='289.560' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k48&quot;, &quot;_self&quot;)'>48</text>
  <line
   x1='189.720' y1='189.960' x2='239.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k45&quot;, &quot;_self&quot;)'>45</text>
  <line
   x1='139.800' y1='114.960' x2='189.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k53&quot;, &quot;_self&quot;)'>53</text>
  <line
   x1='289.560' y1='114.960' x2='339.480' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k50&quot;, &quot;_self&quot;)'>50</text>
  <line
   x1='239.640' y1='114.960' x2='289.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k47&quot;, &quot;_self&quot;)'>47</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k44&quot;, &quot;_self&quot;)'>44</text>
  <line
   x1='139.800' y1='114.960' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k52&quot;, &quot;_self&quot;)'>52</text>
  <line
   x1='289.560' y1='39.960' x2='339.480' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k49&quot;, &quot;_self&quot;)'>49</text>
  <line
   x1='239.640' y1='39.960' x2='289.560' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k46&quot;, &quot;_self&quot;)'>46</text>
  <line
   x1='189.720' y1='39.960' x2='239.640' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k43&quot;, &quot;_self&quot;)'>43</text>
  <line
   x1='139.800' y1='114.960' x2='189.720' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k42&quot;, &quot;_self&quot;)'>42</text>
  <line
   x1='89.880' y1='114.960' x2='139.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k41&quot;, &quot;_self&quot;)'>41</text>
  <line
   x1='39.960' y1='114.960' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k40&quot;, &quot;_self&quot;)'>40</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie mesg)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (ppk skey) (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))</pre>

<p id="k40">Item <a href="#t40">40</a>, Child: <a href="#k41">41</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 40</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie)))
  (label 40)
  (unrealized (0 1) (0 3) (0 5) (0 9))
  (origs (pt-0 (0 7)) (cr (0 0)) (pms (0 2)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k41">Item <a href="#t40">41</a>, Parent: <a href="#k40">40</a>, Child: <a href="#k42">42</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 41</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie)))
  (label 41)
  (parent 40)
  (unrealized (0 1) (0 3) (0 5) (0 9))
  (origs (pt-0 (0 7)) (cr (0 0)) (pms (0 2)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k42">Item <a href="#t40">42</a>, Parent: <a href="#k41">41</a>, Children: <a href="#k43">43</a> <a href="#k44">44</a> <a href="#k45">45</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 42</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (precedes ((2 1) (0 1)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s (pubk s)) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))))
  (label 42)
  (parent 41)
  (unrealized (0 3) (0 5) (0 9))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k43">Item <a href="#t40">43</a>, Parent: <a href="#k42">42</a>, Child: <a href="#k46">46</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 43</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((2 1) (0 1)) ((2 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 43)
  (parent 42)
  (unrealized (0 5) (0 9))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k44">Item <a href="#t40">44</a>, Parent: <a href="#k42">42</a>, Child: <a href="#k47">47</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 44</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 44)
  (parent 42)
  (unrealized (0 5) (0 9))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k45">Item <a href="#t40">45</a>, Parent: <a href="#k42">42</a>, Child: <a href="#k48">48</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 192.583 226.118 45.326 337.276'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 45</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((2 1) (0 1)) ((3 1) (0 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 45)
  (parent 42)
  (unrealized (0 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k46">Item <a href="#t40">46</a>, Parent: <a href="#k43">43</a>, Child: <a href="#k49">49</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 192.021 300.338 44.202 485.716'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 46</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((2 1) (0 1)) ((2 3) (0 3))
    ((3 1) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot; cookie
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 46)
  (parent 43)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k47">Item <a href="#t40">47</a>, Parent: <a href="#k44">44</a>, Child: <a href="#k50">50</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 242.280 300.660 44.759 486.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 47</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((4 1) (0 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot; cookie
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 47)
  (parent 44)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k48">Item <a href="#t40">48</a>, Parent: <a href="#k45">45</a>, Child: <a href="#k51">51</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.810 264.232 45.781 338.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 48</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((2 1) (0 1)) ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 48)
  (parent 45)
  (unrealized (0 3) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k49">Item <a href="#t40">49</a>, Parent: <a href="#k46">46</a>, Child: <a href="#k52">52</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.300 338.160 44.759 486.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 49</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((2 1) (0 1)) ((2 3) (0 3))
    ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 49)
  (parent 46)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k50">Item <a href="#t40">50</a>, Parent: <a href="#k47">47</a>, Child: <a href="#k53">53</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.494 338.489 45.189 487.018'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 50</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 50)
  (parent 47)
  (unrealized (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k51">Item <a href="#t40">51</a>, Parent: <a href="#k48">48</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 51</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 2) (5 0)) ((2 1) (0 1)) ((3 1) (0 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 51)
  (parent 48)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k52">Item <a href="#t40">52</a>, Parent: <a href="#k49">49</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 52</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 52)
  (parent 49)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k53">Item <a href="#t40">53</a>, Parent: <a href="#k50">50</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 242.880 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 53</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 53)
  (parent 50)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t54">Tree <a href="#top">54</a>, POV <a href="#k54">54</a>.</p>

<div>
 <svg
  class='diagram' width='479.280pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.280 754.920' font-size='12.000'>
  <text
   x='289.560' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k69&quot;, &quot;_self&quot;)'>69</text>
  <line
   x1='239.640' y1='714.960' x2='289.560' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k62&quot;, &quot;_self&quot;)'>62</text>
  <line
   x1='189.720' y1='714.960' x2='239.640' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k59&quot;, &quot;_self&quot;)'>59</text>
  <line
   x1='139.800' y1='377.460' x2='189.720' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k86&quot;, &quot;_self&quot;)'>86</text>
  <line
   x1='339.480' y1='639.960' x2='389.400' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k77&quot;, &quot;_self&quot;)'>77</text>
  <line
   x1='289.560' y1='639.960' x2='339.480' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k68&quot;, &quot;_self&quot;)'>68</text>
  <line
   x1='239.640' y1='489.960' x2='289.560' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k93&quot;, &quot;_self&quot;)'>93</text>
  <line
   x1='389.400' y1='564.960' x2='439.320' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k85&quot;, &quot;_self&quot;)'>85</text>
  <line
   x1='339.480' y1='564.960' x2='389.400' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k76&quot;, &quot;_self&quot;)'>76</text>
  <line
   x1='289.560' y1='489.960' x2='339.480' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k92&quot;, &quot;_self&quot;)'>92</text>
  <line
   x1='389.400' y1='489.960' x2='439.320' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k84&quot;, &quot;_self&quot;)'>84</text>
  <line
   x1='339.480' y1='452.460' x2='389.400' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k91&quot;, &quot;_self&quot;)'>91</text>
  <line
   x1='389.400' y1='414.960' x2='439.320' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k83&quot;, &quot;_self&quot;)'>83</text>
  <line
   x1='339.480' y1='452.460' x2='389.400' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k75&quot;, &quot;_self&quot;)'>75</text>
  <line
   x1='289.560' y1='489.960' x2='339.480' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k67&quot;, &quot;_self&quot;)'>67</text>
  <line
   x1='239.640' y1='489.960' x2='289.560' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k90&quot;, &quot;_self&quot;)'>90</text>
  <line
   x1='389.400' y1='339.960' x2='439.320' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k82&quot;, &quot;_self&quot;)'>82</text>
  <line
   x1='339.480' y1='339.960' x2='389.400' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k74&quot;, &quot;_self&quot;)'>74</text>
  <line
   x1='289.560' y1='339.960' x2='339.480' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k66&quot;, &quot;_self&quot;)'>66</text>
  <line
   x1='239.640' y1='489.960' x2='289.560' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k61&quot;, &quot;_self&quot;)'>61</text>
  <line
   x1='189.720' y1='489.960' x2='239.640' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k58&quot;, &quot;_self&quot;)'>58</text>
  <line
   x1='139.800' y1='377.460' x2='189.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k81&quot;, &quot;_self&quot;)'>81</text>
  <line
   x1='339.480' y1='264.960' x2='389.400' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k73&quot;, &quot;_self&quot;)'>73</text>
  <line
   x1='289.560' y1='264.960' x2='339.480' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k65&quot;, &quot;_self&quot;)'>65</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k89&quot;, &quot;_self&quot;)'>89</text>
  <line
   x1='389.400' y1='189.960' x2='439.320' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k80&quot;, &quot;_self&quot;)'>80</text>
  <line
   x1='339.480' y1='189.960' x2='389.400' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k72&quot;, &quot;_self&quot;)'>72</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k88&quot;, &quot;_self&quot;)'>88</text>
  <line
   x1='389.400' y1='114.960' x2='439.320' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k79&quot;, &quot;_self&quot;)'>79</text>
  <line
   x1='339.480' y1='114.960' x2='389.400' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k71&quot;, &quot;_self&quot;)'>71</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k64&quot;, &quot;_self&quot;)'>64</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k87&quot;, &quot;_self&quot;)'>87</text>
  <line
   x1='389.400' y1='39.960' x2='439.320' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k78&quot;, &quot;_self&quot;)'>78</text>
  <line
   x1='339.480' y1='39.960' x2='389.400' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k70&quot;, &quot;_self&quot;)'>70</text>
  <line
   x1='289.560' y1='39.960' x2='339.480' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k63&quot;, &quot;_self&quot;)'>63</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k60&quot;, &quot;_self&quot;)'>60</text>
  <line
   x1='189.720' y1='152.460' x2='239.640' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k57&quot;, &quot;_self&quot;)'>57</text>
  <line
   x1='139.800' y1='377.460' x2='189.720' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k56&quot;, &quot;_self&quot;)'>56</text>
  <line
   x1='89.880' y1='377.460' x2='139.800' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k55&quot;, &quot;_self&quot;)'>55</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k54&quot;, &quot;_self&quot;)'>54</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie mesg)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (ppk skey) (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))</pre>

<p id="k54">Item <a href="#t54">54</a>, Child: <a href="#k55">55</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 54</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 54)
  (unrealized (0 1) (0 3) (0 6))
  (origs (cr (0 0)) (pms (0 2)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k55">Item <a href="#t54">55</a>, Parent: <a href="#k54">54</a>, Child: <a href="#k56">56</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 55</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (rule gen-st-clientr-0)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 55)
  (parent 54)
  (unrealized (0 1) (0 3) (0 4) (0 6))
  (origs (cr (0 0)) (pms (0 2)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k56">Item <a href="#t54">56</a>, Parent: <a href="#k55">55</a>, Children: <a href="#k57">57</a> <a href="#k58">58</a> <a href="#k59">59</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 56</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (precedes ((1 1) (0 1)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s (pubk s)) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))))
  (label 56)
  (parent 55)
  (unrealized (0 3) (0 4) (0 6))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k57">Item <a href="#t54">57</a>, Parent: <a href="#k56">56</a>, Child: <a href="#k60">60</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 57</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 57)
  (parent 56)
  (unrealized (0 4) (0 6))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k58">Item <a href="#t54">58</a>, Parent: <a href="#k56">56</a>, Child: <a href="#k61">61</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 58</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test (added-strand serverr 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 58)
  (parent 56)
  (unrealized (0 4) (0 6))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k59">Item <a href="#t54">59</a>, Parent: <a href="#k56">56</a>, Child: <a href="#k62">62</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 59</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 59)
  (parent 56)
  (unrealized (0 3) (0 4) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k60">Item <a href="#t54">60</a>, Parent: <a href="#k57">57</a>, Children: <a href="#k63">63</a> <a href="#k64">64</a> <a href="#k65">65</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 60</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 7) (0 4)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie)) (0 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie))))
  (label 60)
  (parent 57)
  (unrealized (0 6))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k61">Item <a href="#t54">61</a>, Parent: <a href="#k58">58</a>, Children: <a href="#k66">66</a> <a href="#k67">67</a> <a href="#k68">68</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 61</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (s ca u ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 7) (0 4)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie)) (0 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie))))
  (label 61)
  (parent 58)
  (unrealized (0 6))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k62">Item <a href="#t54">62</a>, Parent: <a href="#k59">59</a>, Child: <a href="#k69">69</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 62</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 62)
  (parent 59)
  (unrealized (0 3) (0 4) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k63">Item <a href="#t54">63</a>, Parent: <a href="#k60">60</a>, Child: <a href="#k70">70</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 63</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ppk skey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 9) (0 6)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 3 servera 10)
    (enc response (hash (hash pms cr sr) &quot;server_write&quot;)) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0 (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 63)
  (parent 60)
  (unrealized (2 4) (2 8))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k64">Item <a href="#t54">64</a>, Parent: <a href="#k60">60</a>, Children: <a href="#k71">71</a> <a href="#k72">72</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 564.960 Q 141.913 637.717 43.945 785.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='239.880' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 64</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (ppk skey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0)
    (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 6) (0 6)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation encryption-test (displaced 1 3 serverr 7)
    (enc response (hash (hash pms cr sr) &quot;server_write&quot;)) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 64)
  (parent 60)
  (unrealized (2 4) (2 5))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k65">Item <a href="#t54">65</a>, Parent: <a href="#k60">60</a>, Child: <a href="#k73">73</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 191.241 449.776 42.642 784.593'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 65</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 7) (0 4)) ((3 1) (0 6)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc response (hash (hash pms cr sr) &quot;server_write&quot;)) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 65)
  (parent 60)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k66">Item <a href="#t54">66</a>, Parent: <a href="#k61">61</a>, Child: <a href="#k74">74</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 66</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48) (ppk skey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 4 servera 10)
    (enc response (hash (hash pms cr sr) &quot;server_write&quot;)) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0 (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 66)
  (parent 61)
  (unrealized (3 4) (3 8))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k67">Item <a href="#t54">67</a>, Parent: <a href="#k61">61</a>, Children: <a href="#k75">75</a> <a href="#k76">76</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 192.300 638.160 44.759 786.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='339.840' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 67</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48) (ppk skey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0)
    (s s) (ca ca-0) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation encryption-test (displaced 2 4 serverr 7)
    (enc response (hash (hash pms cr sr) &quot;server_write&quot;)) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 67)
  (parent 61)
  (unrealized (3 4) (3 5))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k68">Item <a href="#t54">68</a>, Parent: <a href="#k61">61</a>, Child: <a href="#k77">77</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 241.544 449.964 43.287 784.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 68</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (s ca u ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc response (hash (hash pms cr sr) &quot;server_write&quot;)) (0 6))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 68)
  (parent 61)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k69">Item <a href="#t54">69</a>, Parent: <a href="#k62">62</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 69</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (s ca u name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 69)
  (parent 62)
  (unrealized (0 4) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k70">Item <a href="#t54">70</a>, Parent: <a href="#k63">63</a>, Child: <a href="#k78">78</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 291.078 299.718 242.316 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 70</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ppk skey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0 (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 70)
  (parent 63)
  (unrealized (2 8) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k71">Item <a href="#t54">71</a>, Parent: <a href="#k64">64</a>, Child: <a href="#k79">79</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: orange;' cx='239.880' cy='789.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 71</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (ppk skey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clientr 6)
    (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
      (hash (hash pms cr sr) &quot;client_write&quot;)) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 71)
  (parent 64)
  (unrealized (1 5) (2 5))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k72">Item <a href="#t54">72</a>, Parent: <a href="#k64">64</a>, Child: <a href="#k80">80</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 291.078 299.718 242.316 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 141.913 637.717 43.945 785.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='239.880' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 72</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (ppk skey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0)
    (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
      (hash (hash pms cr sr) &quot;client_write&quot;)) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 72)
  (parent 64)
  (unrealized (2 4) (2 5) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k73">Item <a href="#t54">73</a>, Parent: <a href="#k65">65</a>, Child: <a href="#k81">81</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 191.388 487.355 42.936 784.750'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 73</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 73)
  (parent 65)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k74">Item <a href="#t54">74</a>, Parent: <a href="#k66">66</a>, Child: <a href="#k82">82</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 391.038 299.718 342.276 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 74</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48) (ppk skey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6)) ((4 1) (3 4)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (3 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0 (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 74)
  (parent 66)
  (unrealized (3 8) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k75">Item <a href="#t54">75</a>, Parent: <a href="#k67">67</a>, Children: <a href="#k83">83</a> <a href="#k84">84</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 864.960 Q 192.900 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: orange;' cx='339.840' cy='789.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 91.158 299.718 42.396 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 75</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (ppk skey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 5) (3 4)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 4 0 clientr 6)
    (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
      (hash (hash pms cr sr) &quot;client_write&quot;)) (3 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 75)
  (parent 67)
  (unrealized (2 5) (3 5))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k76">Item <a href="#t54">76</a>, Parent: <a href="#k67">67</a>, Child: <a href="#k85">85</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 391.038 299.718 342.276 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.300 638.160 44.759 786.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='339.840' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 76</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48) (ppk skey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0)
    (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)) ((4 1) (3 4)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
      (hash (hash pms cr sr) &quot;client_write&quot;)) (3 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 76)
  (parent 67)
  (unrealized (3 4) (3 5) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k77">Item <a href="#t54">77</a>, Parent: <a href="#k68">68</a>, Child: <a href="#k86">86</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 241.698 487.573 43.595 785.187'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 77</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (s ca u ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 77)
  (parent 68)
  (unrealized (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k78">Item <a href="#t54">78</a>, Parent: <a href="#k70">70</a>, Child: <a href="#k87">87</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 291.524 337.464 243.207 409.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 78</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ppk skey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0 (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 78)
  (parent 70)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k79">Item <a href="#t54">79</a>, Parent: <a href="#k71">71</a>, Child: <a href="#k88">88</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 639.960 Q 291.524 712.464 243.207 784.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-2 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 242.880 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk-0 (hash pms-1 cr-1 sr-1))) (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-1 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1))) (enc pms-1 (pubk s)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1))) (enc pms-1 (pubk s)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-1 (pubk s)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1))) (enc pms-1 (pubk s)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (pms pms-1) (ppk ppk-0) (u u-0) (s s) (ca ca-1) (authstor authstor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 79</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (ppk ppk-0 skey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (ppk ppk-0) (u u-0) (s s) (ca ca-1)
    (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)))
  (non-orig ppk ppk-0 (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie)) (2 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-1))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms-1 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-1)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk-0 (hash pms-1 cr-1 sr-1)))
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))))
  (label 79)
  (parent 71)
  (unrealized (1 5))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k80">Item <a href="#t54">80</a>, Parent: <a href="#k72">72</a>, Child: <a href="#k89">89</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 291.524 337.464 243.207 409.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 141.913 637.717 43.945 785.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='239.880' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 80</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (ppk skey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0)
    (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4)) ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 80)
  (parent 72)
  (unrealized (2 4) (2 5) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k81">Item <a href="#t54">81</a>, Parent: <a href="#k73">73</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.021 600.338 44.202 785.717'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 81</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 81)
  (parent 73)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k82">Item <a href="#t54">82</a>, Parent: <a href="#k74">74</a>, Child: <a href="#k90">90</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 391.484 337.464 343.167 409.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 789.960 Q 192.900 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 82</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48) (ppk skey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0 (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 82)
  (parent 74)
  (unrealized (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k83">Item <a href="#t54">83</a>, Parent: <a href="#k75">75</a>, Child: <a href="#k91">91</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 639.960 Q 291.524 712.464 243.207 784.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-2 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 242.880 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk-0 (hash pms-1 cr-1 sr-1))) (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-1 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-1 (pubk s)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-1 (pubk s)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-1 (pubk s)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-1 (pubk s)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.300 263.160 44.759 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (pms pms-1) (ppk ppk-0) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 83</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (ppk ppk-0 skey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (ppk ppk-0) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (0 1))
    ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig ppk ppk-0 (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (displaced 1 4 servera 8)
    (ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie)) (3 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms-1 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk-0 (hash pms-1 cr-1 sr-1)))
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))))
  (label 83)
  (parent 75)
  (unrealized (1 5))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k84">Item <a href="#t54">84</a>, Parent: <a href="#k75">75</a>, Child: <a href="#k92">92</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 639.960 Q 391.484 712.464 343.167 784.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-2 any-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 342.840 452.460 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk-0 (hash pms-1 cr-2 sr-2))) (hash (hash pms-1 cr-2 sr-2) &quot;server_write&quot;))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms-1 cr-2 sr-2) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-1 &quot;server finished&quot; (hash cr-2 sr-2 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1))) (enc pms-1 (pubk s)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-2 sr-2 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1))) (enc pms-1 (pubk s)))) (hash (hash pms-1 cr-2 sr-2) &quot;client_write&quot;)))) (hash (hash pms-1 cr-2 sr-2) &quot;server_write&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-1 (pubk s)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-2 sr-2 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1))) (enc pms-1 (pubk s)))) (hash (hash pms-1 cr-2 sr-2) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-2 s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>cr-2</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 864.960 Q 192.900 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 91.158 299.718 42.396 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (p p-0) (cr cr-2) (sr sr-2) (pms pms-1) (ppk ppk-0) (u u-0) (s s) (ca ca-1) (authstor authstor))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 84</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 cr-2 sr-2 random32)
    (pms pms-0 pms-1 random48) (ppk ppk-0 skey)
    (u ca u-0 s ca-0 ca-1 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-2)
    (sr sr-2) (pms pms-1) (ppk ppk-0) (u u-0) (s s) (ca ca-1)
    (authstor authstor))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 5) (3 4)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 5) (2 5)) ((4 7) (3 5)))
  (non-orig ppk ppk-0 (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)) ((4 7) (3 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie)) (3 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-2)
      (send (cat sr-2 s (pubk s) (enc (hash s (pubk s)) (privk ca-1))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 &quot;client finished&quot;
              (hash cr-2 sr-2
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-2 sr-2) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms-1 &quot;server finished&quot;
            (hash cr-2 sr-2
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 &quot;client finished&quot;
                  (hash cr-2 sr-2
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-1)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-2 sr-2) &quot;client_write&quot;))))
          (hash (hash pms-1 cr-2 sr-2) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash pms-1 cr-2 sr-2) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk-0 (hash pms-1 cr-2 sr-2)))
          (hash (hash pms-1 cr-2 sr-2) &quot;server_write&quot;)))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))))
  (label 84)
  (parent 75)
  (unrealized (2 5))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k85">Item <a href="#t54">85</a>, Parent: <a href="#k76">76</a>, Child: <a href="#k93">93</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 391.484 337.464 343.167 409.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.300 638.160 44.759 786.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='339.840' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 85</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48) (ppk skey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0)
    (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 85)
  (parent 76)
  (unrealized (3 4) (3 5) (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k86">Item <a href="#t54">86</a>, Parent: <a href="#k77">77</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 242.280 600.660 44.759 786.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 86</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (s ca u ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 86)
  (parent 77)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k87">Item <a href="#t54">87</a>, Parent: <a href="#k78">78</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 141.913 487.717 43.945 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.340 675.660 44.759 711.359'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.111 263.906 234.262 337.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 87</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (pms pms-0 random48) (ppk skey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0 (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 87)
  (parent 78)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k88">Item <a href="#t54">88</a>, Parent: <a href="#k79">79</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 291.981 300.338 144.162 485.716'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash pms cr sr))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(hash ppk (hash pms cr sr))</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 291.524 712.464 243.207 784.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-2 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 242.880 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk-0 (hash pms-1 cr-1 sr-1))) (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-1 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1))) (enc pms-1 (pubk s)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1))) (enc pms-1 (pubk s)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-1 (pubk s)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1))) (enc pms-1 (pubk s)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (pms pms-1) (ppk ppk-0) (u u-0) (s s) (ca ca-1) (authstor authstor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 88</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (ppk ppk-0 skey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (ppk ppk-0) (u u-0) (s s) (ca ca-1)
    (authstor authstor))
  (deflistener (hash ppk (hash pms cr sr)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 5) (1 5))
    ((3 7) (2 5)) ((4 1) (1 5)))
  (non-orig ppk ppk-0 (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash ppk (hash pms cr sr)))
    (enc cookie (hash ppk (hash pms cr sr))) (1 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-1))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms-1 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-1)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk-0 (hash pms-1 cr-1 sr-1)))
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 &quot;server store&quot; s u-0 cookie)))
    ((recv (hash ppk (hash pms cr sr)))
      (send (hash ppk (hash pms cr sr)))))
  (label 88)
  (parent 79)
  (unrealized (1 5) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k89">Item <a href="#t54">89</a>, Parent: <a href="#k80">80</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.320 675.660 44.759 786.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='239.880' cy='564.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.320 450.660 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.111 263.906 234.262 337.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 89</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms pms-0 random48) (ppk skey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0)
    (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 89)
  (parent 80)
  (unrealized (2 4) (2 5) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k90">Item <a href="#t54">90</a>, Parent: <a href="#k82">82</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 864.960 Q 192.900 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie-0 (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.300 488.160 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.729 638.906 45.578 712.853'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.990 264.232 334.019 338.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie-0) (response response) (request request-0) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 90</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48) (ppk skey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie-0 cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie-0 (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u-0 cookie-0))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 90)
  (parent 82)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k91">Item <a href="#t54">91</a>, Parent: <a href="#k83">83</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 291.981 300.338 144.162 485.716'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash pms cr sr))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(hash ppk (hash pms cr sr))</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 291.524 712.464 243.207 784.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-2 any-0))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 242.880 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk-0 (hash pms-1 cr-1 sr-1))) (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-1 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-1 (pubk s)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-1 (pubk s)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-1 (pubk s)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-1 (pubk s)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.300 263.160 44.759 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 864.960 Q 142.920 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (pms pms-1) (ppk ppk-0) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 91</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (ppk ppk-0 skey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (pms pms-1) (ppk ppk-0) (u u-0) (s s) (ca ca-0)
    (authstor authstor))
  (deflistener (hash ppk (hash pms cr sr)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 5) (2 4)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (0 1))
    ((3 5) (1 5)) ((3 7) (2 5)) ((4 1) (1 5)))
  (non-orig ppk ppk-0 (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash ppk (hash pms cr sr)))
    (enc cookie (hash ppk (hash pms cr sr))) (1 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-1)
      (send (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms-1 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk-0 (hash pms-1 cr-1 sr-1)))
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 &quot;server store&quot; s u-0 cookie)))
    ((recv (hash ppk (hash pms cr sr)))
      (send (hash ppk (hash pms cr sr)))))
  (label 91)
  (parent 83)
  (unrealized (1 5) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k92">Item <a href="#t54">92</a>, Parent: <a href="#k84">84</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='339.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 391.941 300.338 244.122 485.716'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash pms cr sr))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(hash ppk (hash pms cr sr))</title>
   <circle style='fill: red;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 639.960 Q 391.484 712.464 343.167 784.967'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='439.800' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-2 any-0))</title>
   <circle style='fill: gray;' cx='439.800' cy='564.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 342.840 452.460 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk-0 (hash pms-1 cr-2 sr-2))) (hash (hash pms-1 cr-2 sr-2) &quot;server_write&quot;))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms-1 cr-2 sr-2) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-1 &quot;server finished&quot; (hash cr-2 sr-2 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1))) (enc pms-1 (pubk s)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-2 sr-2 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1))) (enc pms-1 (pubk s)))) (hash (hash pms-1 cr-2 sr-2) &quot;client_write&quot;)))) (hash (hash pms-1 cr-2 sr-2) &quot;server_write&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-1 (pubk s)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-2 sr-2 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1))) (enc pms-1 (pubk s)))) (hash (hash pms-1 cr-2 sr-2) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-2 s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>cr-2</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 864.960 Q 192.900 827.460 45.960 864.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))</title>
   <circle style='fill: gray;' cx='339.840' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='714.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 91.158 299.718 42.396 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 186.900 677.460 333.840 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (p p-0) (cr cr-2) (sr sr-2) (pms pms-1) (ppk ppk-0) (u u-0) (s s) (ca ca-1) (authstor authstor))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 92</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 cr-2 sr-2 random32)
    (pms pms-0 pms-1 random48) (ppk ppk-0 skey)
    (u ca u-0 s ca-0 ca-1 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s)
    (ca ca-0) (authstor authstor))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-2)
    (sr sr-2) (pms pms-1) (ppk ppk-0) (u u-0) (s s) (ca ca-1)
    (authstor authstor))
  (deflistener (hash ppk (hash pms cr sr)))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 5) (3 4)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 5) (2 5)) ((4 7) (3 5)) ((5 1) (2 5)))
  (non-orig ppk ppk-0 (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr))))
    (cat &quot;server store&quot; s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)) ((4 7) (3 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash ppk (hash pms cr sr)))
    (enc cookie (hash ppk (hash pms cr sr))) (2 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-2)
      (send (cat sr-2 s (pubk s) (enc (hash s (pubk s)) (privk ca-1))))
      (recv
        (cat (enc pms-1 (pubk s))
          (enc
            (hash pms-1 &quot;client finished&quot;
              (hash cr-2 sr-2
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
                (enc pms-1 (pubk s))))
            (hash (hash pms-1 cr-2 sr-2) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms-1 &quot;server finished&quot;
            (hash cr-2 sr-2
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-1)))
              (enc pms-1 (pubk s))
              (enc
                (hash pms-1 &quot;client finished&quot;
                  (hash cr-2 sr-2
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-1)))
                    (enc pms-1 (pubk s))))
                (hash (hash pms-1 cr-2 sr-2) &quot;client_write&quot;))))
          (hash (hash pms-1 cr-2 sr-2) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash (hash pms-1 cr-2 sr-2) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk-0 (hash pms-1 cr-2 sr-2)))
          (hash (hash pms-1 cr-2 sr-2) &quot;server_write&quot;)))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 &quot;server store&quot; s u-0 cookie)))
    ((recv (hash ppk (hash pms cr sr)))
      (send (hash ppk (hash pms cr sr)))))
  (label 92)
  (parent 84)
  (unrealized (2 5) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k93">Item <a href="#t54">93</a>, Parent: <a href="#k85">85</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 192.583 676.118 45.326 787.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))</title>
   <circle style='fill: orange;' cx='339.840' cy='564.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.583 451.118 45.326 562.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.990 264.232 334.019 338.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie-0) (response response) (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0) (authstor authstor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 93</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48) (ppk skey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0)
    (s s) (ca ca-0) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cr sr pms)
  (gen-st (cat &quot;client store&quot; u s cookie)
    (cat &quot;server store&quot; s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt &quot;client store&quot; u s cookie)))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie-0 (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt-1 &quot;server store&quot; s u-0 cookie-0))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 93)
  (parent 85)
  (unrealized (3 4) (3 5) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t94">Tree <a href="#top">94</a>, POV <a href="#k94">94</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k95&quot;, &quot;_self&quot;)'>95</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k94&quot;, &quot;_self&quot;)'>94</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie mesg)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (ppk skey) (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))</pre>

<p id="k94">Item <a href="#t94">94</a>, Child: <a href="#k95">95</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-0 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any) (cookie cookie) (request request) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 94</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (pms random48) (ppk skey) (s ca u name)
    (pt pt-0 pval) (authstor locn))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca)
    (authstor authstor))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie sr)
  (traces
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (label 94)
  (realized)
  (origs (pt-0 (0 7)) (cookie (0 5)) (sr (0 1)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k95">Item <a href="#t94">95</a>, Parent: <a href="#k94">94</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-0 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any) (cookie cookie) (request request) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 95</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (pms random48) (ppk skey) (s ca u name)
    (pt pt-0 pval) (authstor locn))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca)
    (authstor authstor))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie sr)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-6 trRl_servera-at-7)
  (traces
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (label 95)
  (parent 94)
  (realized)
  (shape)
  (maps
    ((0)
      ((s s) (ca ca) (cr cr) (sr sr) (pms pms) (u u) (p p)
        (cookie cookie) (ppk ppk) (any any) (authstor authstor)
        (request request))))
  (origs (pt-0 (0 7)) (cookie (0 5)) (sr (0 1))))</pre>

<p id="t96">Tree <a href="#top">96</a>, POV <a href="#k96">96</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k97&quot;, &quot;_self&quot;)'>97</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k96&quot;, &quot;_self&quot;)'>96</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie mesg)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (ppk skey) (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))</pre>

<p id="k96">Item <a href="#t96">96</a>, Child: <a href="#k97">97</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-0 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any) (cookie cookie) (request request) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 96</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (pms random48) (ppk skey) (s ca u name)
    (pt pt-0 pval) (authstor locn))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca)
    (authstor authstor))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (traces
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (label 96)
  (realized)
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k97">Item <a href="#t96">97</a>, Parent: <a href="#k96">96</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-0 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any) (cookie cookie) (request request) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 97</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (pms random48) (ppk skey) (s ca u name)
    (pt pt-0 pval) (authstor locn))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca)
    (authstor authstor))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-6 trRl_servera-at-7)
  (traces
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (label 97)
  (parent 96)
  (realized)
  (shape)
  (maps
    ((0)
      ((s s) (ca ca) (cr cr) (sr sr) (pms pms) (cookie cookie) (u u)
        (p p) (ppk ppk) (any any) (authstor authstor)
        (request request))))
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5))))</pre>

<p id="t98">Tree <a href="#top">98</a>, POV <a href="#k98">98</a>.</p>

<div>
 <svg
  class='diagram' width='179.760pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.760 79.920' font-size='12.000'>
  <text
   x='139.800' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k100&quot;, &quot;_self&quot;)'>100</text>
  <line
   x1='89.880' y1='39.960' x2='139.800' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k99&quot;, &quot;_self&quot;)'>99</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k98&quot;, &quot;_self&quot;)'>98</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie mesg)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (ppk skey) (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))</pre>

<p id="k98">Item <a href="#t98">98</a>, Child: <a href="#k99">99</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(ch-msg authstor (cat pt &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 98</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (pms random48)
    (ppk skey) (s ca u name) (pt pval) (authstor locn))
  (defstrand serverr 6 (cookie cookie) (request request) (cr cr) (sr sr)
    (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig sr)
  (traces
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt &quot;server store&quot; s u cookie))))
  (label 98)
  (unrealized (0 4))
  (origs (sr (0 1)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k99">Item <a href="#t98">99</a>, Parent: <a href="#k98">98</a>, Child: <a href="#k100">100</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(ch-msg authstor (cat pt &quot;server store&quot; s u cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 99</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (pms random48)
    (ppk skey) (s ca u name) (pt pval) (authstor locn))
  (defstrand serverr 6 (cookie cookie) (request request) (cr cr) (sr sr)
    (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig sr)
  (gen-st (cat &quot;server store&quot; s u cookie))
  (facts (neq u s))
  (rule fact-serverr-neq0 gen-st-serverr-0)
  (traces
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt &quot;server store&quot; s u cookie))))
  (label 99)
  (parent 98)
  (unrealized (0 4) (0 5))
  (origs (sr (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k100">Item <a href="#t98">100</a>, Parent: <a href="#k99">99</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 91.158 299.718 42.396 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash pms cr sr))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(hash ppk (hash pms cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt &quot;server store&quot; s u cookie))</title>
   <circle style='fill: orange;' cx='39.960' cy='489.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (request request) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 100</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (pms random48)
    (ppk skey) (s ca u name) (pt pval) (authstor locn))
  (defstrand serverr 6 (cookie cookie) (request request) (cr cr) (sr sr)
    (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))
  (deflistener (hash ppk (hash pms cr sr)))
  (precedes ((1 1) (0 4)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig sr)
  (gen-st (cat &quot;server store&quot; s u cookie))
  (facts (neq u s))
  (rule fact-serverr-neq0)
  (operation encryption-test
    (added-listener (hash ppk (hash pms cr sr)))
    (enc cookie (hash ppk (hash pms cr sr))) (0 4))
  (traces
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat pt &quot;server store&quot; s u cookie)))
    ((recv (hash ppk (hash pms cr sr)))
      (send (hash ppk (hash pms cr sr)))))
  (label 100)
  (parent 99)
  (unrealized (0 5) (1 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t101">Tree <a href="#top">101</a>, POV <a href="#k101">101</a>.</p>

<div>
 <svg
  class='diagram' width='379.440pt' height='229.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.440 229.920' font-size='12.000'>
  <text
   x='289.560' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k112&quot;, &quot;_self&quot;)'>112</text>
  <line
   x1='239.640' y1='189.960' x2='289.560' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k109&quot;, &quot;_self&quot;)'>109</text>
  <line
   x1='189.720' y1='189.960' x2='239.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k106&quot;, &quot;_self&quot;)'>106</text>
  <line
   x1='139.800' y1='114.960' x2='189.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k114&quot;, &quot;_self&quot;)'>114</text>
  <line
   x1='289.560' y1='114.960' x2='339.480' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k111&quot;, &quot;_self&quot;)'>111</text>
  <line
   x1='239.640' y1='114.960' x2='289.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k108&quot;, &quot;_self&quot;)'>108</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k105&quot;, &quot;_self&quot;)'>105</text>
  <line
   x1='139.800' y1='114.960' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k113&quot;, &quot;_self&quot;)'>113</text>
  <line
   x1='289.560' y1='39.960' x2='339.480' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k110&quot;, &quot;_self&quot;)'>110</text>
  <line
   x1='239.640' y1='39.960' x2='289.560' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k107&quot;, &quot;_self&quot;)'>107</text>
  <line
   x1='189.720' y1='39.960' x2='239.640' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k104&quot;, &quot;_self&quot;)'>104</text>
  <line
   x1='139.800' y1='114.960' x2='189.720' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k103&quot;, &quot;_self&quot;)'>103</text>
  <line
   x1='89.880' y1='114.960' x2='139.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k102&quot;, &quot;_self&quot;)'>102</text>
  <line
   x1='39.960' y1='114.960' x2='89.880' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k101&quot;, &quot;_self&quot;)'>101</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie mesg)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (ppk skey) (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))</pre>

<p id="k101">Item <a href="#t101">101</a>, Child: <a href="#k102">102</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 101</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (goals
    (forall
      ((any mesg) (cookie data) (response httpdata) (request httpreq)
        (p password) (cr sr random32) (pms random48) (u s ca name)
        (cookiestor locn) (z z-0 strd))
      (implies
        (and (p &quot;clienta&quot; z 10) (p &quot;&quot; z-0 2) (p &quot;clienta&quot; &quot;any&quot; z any)
          (p &quot;clienta&quot; &quot;cookie&quot; z cookie)
          (p &quot;clienta&quot; &quot;response&quot; z response)
          (p &quot;clienta&quot; &quot;request&quot; z request) (p &quot;clienta&quot; &quot;p&quot; z p)
          (p &quot;clienta&quot; &quot;cr&quot; z cr) (p &quot;clienta&quot; &quot;sr&quot; z sr)
          (p &quot;clienta&quot; &quot;pms&quot; z pms) (p &quot;clienta&quot; &quot;u&quot; z u)
          (p &quot;clienta&quot; &quot;s&quot; z s) (p &quot;clienta&quot; &quot;ca&quot; z ca)
          (p &quot;clienta&quot; &quot;cookiestor&quot; z cookiestor) (p &quot;&quot; &quot;x&quot; z-0 cookie)
          (non (privk s)) (non (privk ca)) (pnon p) (uniq sr)
          (uniq-at cr z 0) (uniq-at pms z 2)) (false))))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 101)
  (unrealized (1 1) (1 3) (1 5) (1 9))
  (origs (pt-0 (1 7)) (cr (1 0)) (pms (1 2)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k102">Item <a href="#t101">102</a>, Parent: <a href="#k101">101</a>, Child: <a href="#k103">103</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 102</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 102)
  (parent 101)
  (unrealized (1 1) (1 3) (1 5) (1 9))
  (origs (pt-0 (1 7)) (cr (1 0)) (pms (1 2)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k103">Item <a href="#t101">103</a>, Parent: <a href="#k102">102</a>, Children: <a href="#k104">104</a> <a href="#k105">105</a> <a href="#k106">106</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 103</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (precedes ((2 1) (1 1)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s (pubk s)) (privk ca)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))))
  (label 103)
  (parent 102)
  (unrealized (1 3) (1 5) (1 9))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k104">Item <a href="#t101">104</a>, Parent: <a href="#k103">103</a>, Child: <a href="#k107">107</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 104</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((2 1) (1 1)) ((2 3) (1 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 104)
  (parent 103)
  (unrealized (1 5) (1 9))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k105">Item <a href="#t101">105</a>, Parent: <a href="#k103">103</a>, Child: <a href="#k108">108</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 105</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 105)
  (parent 103)
  (unrealized (1 5) (1 9))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k106">Item <a href="#t101">106</a>, Parent: <a href="#k103">103</a>, Child: <a href="#k109">109</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 242.280 225.660 144.719 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 106</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((2 1) (1 1)) ((3 1) (1 3)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 106)
  (parent 103)
  (unrealized (1 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k107">Item <a href="#t101">107</a>, Parent: <a href="#k104">104</a>, Child: <a href="#k110">110</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 241.544 299.964 143.247 484.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 107</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((2 1) (1 1)) ((2 3) (1 3))
    ((3 1) (1 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot; cookie
      (hash (hash pms cr sr) &quot;server_write&quot;)) (1 5))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 107)
  (parent 104)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k108">Item <a href="#t101">108</a>, Parent: <a href="#k105">105</a>, Child: <a href="#k111">111</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 291.981 300.338 144.162 485.716'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 108</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((4 1) (1 5)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot; cookie
      (hash (hash pms cr sr) &quot;server_write&quot;)) (1 5))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 108)
  (parent 105)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k109">Item <a href="#t101">109</a>, Parent: <a href="#k106">106</a>, Child: <a href="#k112">112</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 242.689 263.906 145.538 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 109</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((2 1) (1 1)) ((3 1) (1 3)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 109)
  (parent 106)
  (unrealized (1 3) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k110">Item <a href="#t101">110</a>, Parent: <a href="#k107">107</a>, Child: <a href="#k113">113</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 241.873 337.717 143.905 485.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 110</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((2 1) (1 1)) ((2 3) (1 3))
    ((3 1) (1 5)) ((4 1) (3 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 110)
  (parent 107)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k111">Item <a href="#t101">111</a>, Parent: <a href="#k108">108</a>, Child: <a href="#k114">114</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 292.260 338.160 144.719 486.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 111</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 111)
  (parent 108)
  (unrealized (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k112">Item <a href="#t101">112</a>, Parent: <a href="#k109">109</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 242.880 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 336.840 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 112</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((1 2) (5 0)) ((2 1) (1 1)) ((3 1) (1 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 112)
  (parent 109)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k113">Item <a href="#t101">113</a>, Parent: <a href="#k110">110</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 242.880 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 336.840 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 113</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 113)
  (parent 110)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k114">Item <a href="#t101">114</a>, Parent: <a href="#k111">111</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 292.860 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 386.820 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 114</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (u s ca name)
    (pt pt-0 pval) (cookiestor locn))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s)
    (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (privk s) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 114)
  (parent 111)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t115">Tree <a href="#top">115</a>, POV <a href="#k115">115</a>.</p>

<div>
 <svg
  class='diagram' width='529.200pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 529.200 829.920' font-size='12.000'>
  <text
   x='289.560' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k132&quot;, &quot;_self&quot;)'>132</text>
  <line
   x1='239.640' y1='789.960' x2='289.560' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k125&quot;, &quot;_self&quot;)'>125</text>
  <line
   x1='189.720' y1='789.960' x2='239.640' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k120&quot;, &quot;_self&quot;)'>120</text>
  <line
   x1='139.800' y1='414.960' x2='189.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k140&quot;, &quot;_self&quot;)'>140</text>
  <line
   x1='289.560' y1='714.960' x2='339.480' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k131&quot;, &quot;_self&quot;)'>131</text>
  <line
   x1='239.640' y1='714.960' x2='289.560' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k124&quot;, &quot;_self&quot;)'>124</text>
  <line
   x1='189.720' y1='564.960' x2='239.640' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k148&quot;, &quot;_self&quot;)'>148</text>
  <line
   x1='339.480' y1='639.960' x2='389.400' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k139&quot;, &quot;_self&quot;)'>139</text>
  <line
   x1='289.560' y1='639.960' x2='339.480' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k130&quot;, &quot;_self&quot;)'>130</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k152&quot;, &quot;_self&quot;)'>152</text>
  <line
   x1='389.400' y1='564.960' x2='439.320' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k147&quot;, &quot;_self&quot;)'>147</text>
  <line
   x1='339.480' y1='564.960' x2='389.400' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k138&quot;, &quot;_self&quot;)'>138</text>
  <line
   x1='289.560' y1='489.960' x2='339.480' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k154&quot;, &quot;_self&quot;)'>154</text>
  <line
   x1='439.320' y1='489.960' x2='489.240' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k151&quot;, &quot;_self&quot;)'>151</text>
  <line
   x1='389.400' y1='489.960' x2='439.320' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k146&quot;, &quot;_self&quot;)'>146</text>
  <line
   x1='339.480' y1='452.460' x2='389.400' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='401.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k141&quot;, &quot;_self&quot;)'>141</text>
  <line
   x1='389.400' y1='414.960' x2='439.320' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k145&quot;, &quot;_self&quot;)'>145</text>
  <line
   x1='339.480' y1='452.460' x2='389.400' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='438.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k137&quot;, &quot;_self&quot;)'>137</text>
  <line
   x1='289.560' y1='489.960' x2='339.480' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='476.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k129&quot;, &quot;_self&quot;)'>129</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='513.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k123&quot;, &quot;_self&quot;)'>123</text>
  <line
   x1='189.720' y1='564.960' x2='239.640' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='551.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k119&quot;, &quot;_self&quot;)'>119</text>
  <line
   x1='139.800' y1='414.960' x2='189.720' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k136&quot;, &quot;_self&quot;)'>136</text>
  <line
   x1='289.560' y1='339.960' x2='339.480' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k128&quot;, &quot;_self&quot;)'>128</text>
  <line
   x1='239.640' y1='339.960' x2='289.560' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k122&quot;, &quot;_self&quot;)'>122</text>
  <line
   x1='189.720' y1='189.960' x2='239.640' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k144&quot;, &quot;_self&quot;)'>144</text>
  <line
   x1='339.480' y1='264.960' x2='389.400' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k135&quot;, &quot;_self&quot;)'>135</text>
  <line
   x1='289.560' y1='264.960' x2='339.480' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k127&quot;, &quot;_self&quot;)'>127</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k150&quot;, &quot;_self&quot;)'>150</text>
  <line
   x1='389.400' y1='189.960' x2='439.320' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k143&quot;, &quot;_self&quot;)'>143</text>
  <line
   x1='339.480' y1='189.960' x2='389.400' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k134&quot;, &quot;_self&quot;)'>134</text>
  <line
   x1='289.560' y1='114.960' x2='339.480' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k153&quot;, &quot;_self&quot;)'>153</text>
  <line
   x1='439.320' y1='114.960' x2='489.240' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k149&quot;, &quot;_self&quot;)'>149</text>
  <line
   x1='389.400' y1='114.960' x2='439.320' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k142&quot;, &quot;_self&quot;)'>142</text>
  <line
   x1='339.480' y1='77.460' x2='389.400' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k141&quot;, &quot;_self&quot;)'>141</text>
  <line
   x1='339.480' y1='77.460' x2='389.400' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k133&quot;, &quot;_self&quot;)'>133</text>
  <line
   x1='289.560' y1='114.960' x2='339.480' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k126&quot;, &quot;_self&quot;)'>126</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='138.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k121&quot;, &quot;_self&quot;)'>121</text>
  <line
   x1='189.720' y1='189.960' x2='239.640' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k118&quot;, &quot;_self&quot;)'>118</text>
  <line
   x1='139.800' y1='414.960' x2='189.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k117&quot;, &quot;_self&quot;)'>117</text>
  <line
   x1='89.880' y1='414.960' x2='139.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k116&quot;, &quot;_self&quot;)'>116</text>
  <line
   x1='39.960' y1='414.960' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k115&quot;, &quot;_self&quot;)'>115</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie mesg)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (ppk skey) (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))</pre>

<p id="k115">Item <a href="#t115">115</a>, Child: <a href="#k116">116</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 115</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (goals
    (forall
      ((z strd) (cookie data) (u s ca name) (cr sr random32)
        (pms random48) (ppk skey))
      (implies
        (and (p &quot;clienta&quot; z 10)
          (p &quot;clienta&quot; &quot;cookie&quot; z
            (enc cookie (hash ppk (hash pms cr sr))))
          (p &quot;clienta&quot; &quot;u&quot; z u) (p &quot;clienta&quot; &quot;s&quot; z s)
          (p &quot;clienta&quot; &quot;ca&quot; z ca) (p &quot;clienta&quot; &quot;cr&quot; z cr)
          (p &quot;clienta&quot; &quot;sr&quot; z sr) (p &quot;clienta&quot; &quot;pms&quot; z pms)
          (non (privk ca)) (non (privk s)) (non ppk) (uniq sr)
          (uniq-at cr z 0) (uniq-at pms z 2))
        (exists ((z0 strd))
          (and (p &quot;servera&quot; z0 10) (p &quot;servera&quot; &quot;cookie&quot; z0 cookie)
            (p &quot;servera&quot; &quot;u&quot; z0 u) (p &quot;servera&quot; &quot;s&quot; z0 s)
            (uniq-at cookie z0 5) (fact neq u s))))))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 115)
  (unrealized (0 1) (0 3) (0 5) (0 9))
  (origs (pt-0 (0 7)) (cr (0 0)) (pms (0 2)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k116">Item <a href="#t115">116</a>, Parent: <a href="#k115">115</a>, Child: <a href="#k117">117</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 116</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 116)
  (parent 115)
  (unrealized (0 1) (0 3) (0 5) (0 9))
  (origs (pt-0 (0 7)) (cr (0 0)) (pms (0 2)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k117">Item <a href="#t115">117</a>, Parent: <a href="#k116">116</a>, Children: <a href="#k118">118</a> <a href="#k119">119</a> <a href="#k120">120</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 117</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (precedes ((1 1) (0 1)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s (pubk s)) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))))
  (label 117)
  (parent 116)
  (unrealized (0 3) (0 5) (0 9))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k118">Item <a href="#t115">118</a>, Parent: <a href="#k117">117</a>, Children: <a href="#k121">121</a> <a href="#k122">122</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 118</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 118)
  (parent 117)
  (unrealized (0 5) (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k119">Item <a href="#t115">119</a>, Parent: <a href="#k117">117</a>, Children: <a href="#k123">123</a> <a href="#k124">124</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 119</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 119)
  (parent 117)
  (unrealized (0 5) (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k120">Item <a href="#t115">120</a>, Parent: <a href="#k117">117</a>, Child: <a href="#k125">125</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 120</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 120)
  (parent 117)
  (unrealized (0 3) (0 5) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k121">Item <a href="#t115">121</a>, Parent: <a href="#k118">118</a>, Children: <a href="#k126">126</a> <a href="#k127">127</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 121</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (ppk skey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 servera 6)
    (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 121)
  (parent 118)
  (unrealized (0 9) (1 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k122">Item <a href="#t115">122</a>, Parent: <a href="#k118">118</a>, Child: <a href="#k128">128</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 141.584 299.964 43.287 484.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 122</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 5)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 122)
  (parent 118)
  (unrealized (0 5) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k123">Item <a href="#t115">123</a>, Parent: <a href="#k119">119</a>, Children: <a href="#k129">129</a> <a href="#k130">130</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 123</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (ppk skey) (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 servera 6)
    (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 123)
  (parent 119)
  (unrealized (0 9) (2 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k124">Item <a href="#t115">124</a>, Parent: <a href="#k119">119</a>, Child: <a href="#k131">131</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 192.021 300.338 44.202 485.716'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 124</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 124)
  (parent 119)
  (unrealized (0 5) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k125">Item <a href="#t115">125</a>, Parent: <a href="#k120">120</a>, Child: <a href="#k132">132</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 125</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 125)
  (parent 120)
  (unrealized (0 3) (0 5) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k126">Item <a href="#t115">126</a>, Parent: <a href="#k121">121</a>, Children: <a href="#k133">133</a> <a href="#k134">134</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 126</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 0 clienta 5)
    (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (1 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 126)
  (parent 121)
  (unrealized (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k127">Item <a href="#t115">127</a>, Parent: <a href="#k121">121</a>, Child: <a href="#k135">135</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 191.118 299.718 142.356 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 127</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (ppk skey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)) ((2 1) (1 4)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (1 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 127)
  (parent 121)
  (unrealized (0 9) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k128">Item <a href="#t115">128</a>, Parent: <a href="#k122">122</a>, Child: <a href="#k136">136</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 141.913 337.717 43.945 485.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 128</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 5)) ((3 1) (2 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 128)
  (parent 122)
  (unrealized (0 5) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k129">Item <a href="#t115">129</a>, Parent: <a href="#k123">123</a>, Children: <a href="#k137">137</a> <a href="#k138">138</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 129</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clienta 5)
    (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 129)
  (parent 123)
  (unrealized (0 9))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k130">Item <a href="#t115">130</a>, Parent: <a href="#k123">123</a>, Child: <a href="#k139">139</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 291.078 299.718 242.316 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 130</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (ppk skey) (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 130)
  (parent 123)
  (unrealized (0 9) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k131">Item <a href="#t115">131</a>, Parent: <a href="#k124">124</a>, Child: <a href="#k140">140</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.300 338.160 44.759 486.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 131</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 131)
  (parent 124)
  (unrealized (0 5) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k132">Item <a href="#t115">132</a>, Parent: <a href="#k125">125</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='979.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 979.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='939.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 132</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 132)
  (parent 125)
  (unrealized (0 5) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k133">Item <a href="#t115">133</a>, Parent: <a href="#k126">126</a>, Children: <a href="#k141">141</a> <a href="#k142">142</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 133</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 2 servera 10)
    (enc response (hash (hash pms cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 133)
  (parent 126)
  (unrealized (1 8))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k134">Item <a href="#t115">134</a>, Parent: <a href="#k126">126</a>, Child: <a href="#k143">143</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 140.868 449.614 41.857 784.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 134</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc response (hash (hash pms cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 134)
  (parent 126)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k135">Item <a href="#t115">135</a>, Parent: <a href="#k127">127</a>, Child: <a href="#k144">144</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 191.564 337.464 143.247 409.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 135</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (ppk skey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 135)
  (parent 127)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k136">Item <a href="#t115">136</a>, Parent: <a href="#k128">128</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 136</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 136)
  (parent 128)
  (unrealized (0 5) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k137">Item <a href="#t115">137</a>, Parent: <a href="#k129">129</a>, Children: <a href="#k145">145</a> <a href="#k146">146</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 137</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 3 servera 10)
    (enc response (hash (hash pms cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 137)
  (parent 129)
  (unrealized (2 8))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k138">Item <a href="#t115">138</a>, Parent: <a href="#k129">129</a>, Child: <a href="#k147">147</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 191.241 449.776 42.642 784.593'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 138</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (0 9)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc response (hash (hash pms cr sr) &quot;server_write&quot;)) (0 9))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 138)
  (parent 129)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k139">Item <a href="#t115">139</a>, Parent: <a href="#k130">130</a>, Child: <a href="#k148">148</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 291.524 337.464 243.207 409.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 139</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (ppk skey) (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)) ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 139)
  (parent 130)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k140">Item <a href="#t115">140</a>, Parent: <a href="#k131">131</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 140</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 140)
  (parent 131)
  (unrealized (0 5) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k141">Item <a href="#t115">141</a>, Parent: <a href="#k133">133</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 141</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (pms random48)
    (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((0 8) (1 8))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 0 clienta 9)
    (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
      (hash (hash pms cr sr) &quot;client_write&quot;)) (1 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 141)
  (parent 133)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cookie cookie) (u u) (s s) (ca ca) (cr cr) (sr sr) (pms pms)
        (ppk ppk) (p p) (any any) (cookiestor cookiestor)
        (request request) (response response))))
  (origs (pt-0 (0 7)) (cookie (1 5)) (pt-2 (1 7)) (sr (1 1)) (cr (0 0))
    (pms (0 2))))</pre>

<p id="k142">Item <a href="#t115">142</a>, Parent: <a href="#k133">133</a>, Child: <a href="#k149">149</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 190.461 449.513 141.042 709.066'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 142</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)) ((2 1) (1 8)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
      (hash (hash pms cr sr) &quot;client_write&quot;)) (1 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 142)
  (parent 133)
  (unrealized (1 8) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k143">Item <a href="#t115">143</a>, Parent: <a href="#k134">134</a>, Child: <a href="#k150">150</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 140.988 487.156 42.095 784.353'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 143</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9)) ((3 1) (2 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 143)
  (parent 134)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k144">Item <a href="#t115">144</a>, Parent: <a href="#k135">135</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 87.540 300.660 135.121 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 144</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (pms random48) (ppk skey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 144)
  (parent 135)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k145">Item <a href="#t115">145</a>, Parent: <a href="#k137">137</a>, Seen Child: <a href="#k141">141</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 145</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (2 8))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 0 clienta 9)
    (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
      (hash (hash pms cr sr) &quot;client_write&quot;)) (2 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 145)
  (parent 137)
  (seen 141)
  (realized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k146">Item <a href="#t115">146</a>, Parent: <a href="#k137">137</a>, Child: <a href="#k151">151</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 290.421 449.513 241.002 709.066'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 146</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9))
    ((3 1) (2 8)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
      (hash (hash pms cr sr) &quot;client_write&quot;)) (2 8))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 146)
  (parent 137)
  (unrealized (2 8) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k147">Item <a href="#t115">147</a>, Parent: <a href="#k138">138</a>, Child: <a href="#k152">152</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 191.388 487.355 42.936 784.750'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 147</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (0 9))
    ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 147)
  (parent 138)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k148">Item <a href="#t115">148</a>, Parent: <a href="#k139">139</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.111 263.906 234.262 337.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 148</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (ppk skey) (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 148)
  (parent 139)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k149">Item <a href="#t115">149</a>, Parent: <a href="#k142">142</a>, Child: <a href="#k153">153</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 190.551 487.031 141.221 709.103'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 149</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)) ((2 1) (1 8))
    ((3 1) (2 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 149)
  (parent 142)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k150">Item <a href="#t115">150</a>, Parent: <a href="#k143">143</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 141.584 599.964 43.287 784.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 150</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 150)
  (parent 143)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k151">Item <a href="#t115">151</a>, Parent: <a href="#k146">146</a>, Child: <a href="#k154">154</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 290.511 487.031 241.181 709.103'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 151</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9))
    ((3 1) (2 8)) ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 151)
  (parent 146)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k152">Item <a href="#t115">152</a>, Parent: <a href="#k147">147</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.021 600.338 44.202 785.717'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 152</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 152)
  (parent 147)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k153">Item <a href="#t115">153</a>, Parent: <a href="#k149">149</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 191.118 599.718 142.356 709.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 153</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 153)
  (parent 149)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k154">Item <a href="#t115">154</a>, Parent: <a href="#k151">151</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 291.078 599.718 242.316 709.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u) (s s) (ca ca) (authstor authstor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 154</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (pms random48) (ppk skey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any)
    (response response) (request request) (p p) (cr cr) (sr sr)
    (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u)
    (s s) (ca ca) (authstor authstor))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cookie cr sr pms)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request-0
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 154)
  (parent 151)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t155">Tree <a href="#top">155</a>, POV <a href="#k155">155</a>.</p>

<div>
 <svg
  class='diagram' width='479.280pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.280 379.920' font-size='12.000'>
  <text
   x='289.560' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k168&quot;, &quot;_self&quot;)'>168</text>
  <line
   x1='239.640' y1='339.960' x2='289.560' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k163&quot;, &quot;_self&quot;)'>163</text>
  <line
   x1='189.720' y1='339.960' x2='239.640' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k160&quot;, &quot;_self&quot;)'>160</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k167&quot;, &quot;_self&quot;)'>167</text>
  <line
   x1='239.640' y1='227.460' x2='289.560' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k174&quot;, &quot;_self&quot;)'>174</text>
  <line
   x1='389.400' y1='189.960' x2='439.320' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k172&quot;, &quot;_self&quot;)'>172</text>
  <line
   x1='339.480' y1='189.960' x2='389.400' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k170&quot;, &quot;_self&quot;)'>170</text>
  <line
   x1='289.560' y1='189.960' x2='339.480' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k166&quot;, &quot;_self&quot;)'>166</text>
  <line
   x1='239.640' y1='227.460' x2='289.560' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k162&quot;, &quot;_self&quot;)'>162</text>
  <line
   x1='189.720' y1='227.460' x2='239.640' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k159&quot;, &quot;_self&quot;)'>159</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k165&quot;, &quot;_self&quot;)'>165</text>
  <line
   x1='239.640' y1='77.460' x2='289.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k173&quot;, &quot;_self&quot;)'>173</text>
  <line
   x1='389.400' y1='39.960' x2='439.320' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k171&quot;, &quot;_self&quot;)'>171</text>
  <line
   x1='339.480' y1='39.960' x2='389.400' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k169&quot;, &quot;_self&quot;)'>169</text>
  <line
   x1='289.560' y1='39.960' x2='339.480' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k164&quot;, &quot;_self&quot;)'>164</text>
  <line
   x1='239.640' y1='77.460' x2='289.560' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k161&quot;, &quot;_self&quot;)'>161</text>
  <line
   x1='189.720' y1='77.460' x2='239.640' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k158&quot;, &quot;_self&quot;)'>158</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k157&quot;, &quot;_self&quot;)'>157</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k156&quot;, &quot;_self&quot;)'>156</text>
  <line
   x1='39.960' y1='189.960' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k155&quot;, &quot;_self&quot;)'>155</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie mesg)
      (cookiestor locn) (request httpreq) (response httpdata))
    (trace (send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send (enc cookie request (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (pms random48) (p password)
      (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc &quot;login&quot; u p (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))) (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (uniq-orig cookie)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (pms random48) (cookie data)
      (ppk skey) (authstor locn) (request httpreq) (response httpdata))
    (trace (recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    (non-orig ppk)
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 5)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 5)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 6)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))</pre>

<p id="k155">Item <a href="#t155">155</a>, Child: <a href="#k156">156</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 155</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (pms random48) (ppk skey) (u s ca name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca) (cookiestor cookiestor))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (goals
    (forall
      ((z strd) (cookie data) (u s ca name) (cr sr random32)
        (pms random48) (ppk skey))
      (implies
        (and (p &quot;clientr&quot; z 7)
          (p &quot;clientr&quot; &quot;cookie&quot; z
            (enc cookie (hash ppk (hash pms cr sr))))
          (p &quot;clientr&quot; &quot;u&quot; z u) (p &quot;clientr&quot; &quot;s&quot; z s)
          (p &quot;clientr&quot; &quot;ca&quot; z ca) (p &quot;clientr&quot; &quot;cr&quot; z cr)
          (p &quot;clientr&quot; &quot;sr&quot; z sr) (p &quot;clientr&quot; &quot;pms&quot; z pms)
          (non (privk ca)) (non (privk s)) (non ppk) (uniq sr)
          (uniq-at cr z 0) (uniq-at pms z 2))
        (exists ((z0 strd))
          (and (p &quot;servera&quot; z0 8) (p &quot;servera&quot; &quot;cookie&quot; z0 cookie)
            (p &quot;servera&quot; &quot;u&quot; z0 u) (p &quot;servera&quot; &quot;s&quot; z0 s)
            (uniq-at cookie z0 5) (fact neq u s))))))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 155)
  (unrealized (0 1) (0 3) (0 4) (0 6))
  (origs (cr (0 0)) (pms (0 2)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k156">Item <a href="#t155">156</a>, Parent: <a href="#k155">155</a>, Child: <a href="#k157">157</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 156</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (pms random48) (ppk skey) (u s ca name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca) (cookiestor cookiestor))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (rule gen-st-clientr-0)
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 156)
  (parent 155)
  (unrealized (0 1) (0 3) (0 4) (0 6))
  (origs (cr (0 0)) (pms (0 2)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k157">Item <a href="#t155">157</a>, Parent: <a href="#k156">156</a>, Children: <a href="#k158">158</a> <a href="#k159">159</a> <a href="#k160">160</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 157</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey) (u s ca name)
    (pt pval) (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (precedes ((1 1) (0 1)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s (pubk s)) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))))
  (label 157)
  (parent 156)
  (unrealized (0 3) (0 4) (0 6))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k158">Item <a href="#t155">158</a>, Parent: <a href="#k157">157</a>, Child: <a href="#k161">161</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 158</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (pms random48) (ppk skey) (u s ca name) (pt pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 158)
  (parent 157)
  (unrealized (0 4) (0 6))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k159">Item <a href="#t155">159</a>, Parent: <a href="#k157">157</a>, Child: <a href="#k162">162</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 159</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey) (u s ca name)
    (pt pval) (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (operation encryption-test (added-strand serverr 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 159)
  (parent 157)
  (unrealized (0 4) (0 6))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k160">Item <a href="#t155">160</a>, Parent: <a href="#k157">157</a>, Child: <a href="#k163">163</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 160</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey) (u s ca name)
    (pt pval) (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
          (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 160)
  (parent 157)
  (unrealized (0 3) (0 4) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k161">Item <a href="#t155">161</a>, Parent: <a href="#k158">158</a>, Children: <a href="#k164">164</a> <a href="#k165">165</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 161</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (ppk skey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 7) (0 4)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor
      (cat pt &quot;client store&quot; u s
        (enc cookie (hash ppk (hash pms cr sr))))) (0 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))))
  (label 161)
  (parent 158)
  (unrealized (0 6) (2 5))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k162">Item <a href="#t155">162</a>, Parent: <a href="#k159">159</a>, Children: <a href="#k166">166</a> <a href="#k167">167</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 162</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (ppk skey) (u s ca ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 7) (0 4)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor
      (cat pt &quot;client store&quot; u s
        (enc cookie (hash ppk (hash pms cr sr))))) (0 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))))
  (label 162)
  (parent 159)
  (unrealized (0 6) (3 5))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k163">Item <a href="#t155">163</a>, Parent: <a href="#k160">160</a>, Child: <a href="#k168">168</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='414.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 163</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey) (u s ca name)
    (pt pval) (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 163)
  (parent 160)
  (unrealized (0 3) (0 4) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k164">Item <a href="#t155">164</a>, Parent: <a href="#k161">161</a>, Child: <a href="#k169">169</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>ca 164</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (ppk skey) (u ca u-0 s ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (1 5)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 3 servera 6)
    (enc cookie (hash ppk (hash pms cr sr))) (2 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 164)
  (parent 161)
  (unrealized (0 6) (1 5) (2 4))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k165">Item <a href="#t155">165</a>, Parent: <a href="#k161">161</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 290.808 337.114 241.777 484.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash pms cr sr))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash ppk (hash pms cr sr))</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 339.960 Q 91.158 449.718 42.396 559.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 165</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (ppk skey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash ppk (hash pms cr sr)))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 7) (0 4)) ((3 1) (2 5)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash ppk (hash pms cr sr)))
    (enc cookie (hash ppk (hash pms cr sr))) (2 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv (hash ppk (hash pms cr sr)))
      (send (hash ppk (hash pms cr sr)))))
  (label 165)
  (parent 161)
  (unrealized (0 6) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k166">Item <a href="#t155">166</a>, Parent: <a href="#k162">162</a>, Child: <a href="#k170">170</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 166</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (ppk skey) (u ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 4 servera 6)
    (enc cookie (hash ppk (hash pms cr sr))) (3 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 166)
  (parent 162)
  (unrealized (0 6) (2 5) (3 4))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k167">Item <a href="#t155">167</a>, Parent: <a href="#k162">162</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 390.768 337.114 341.737 484.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash ppk (hash pms cr sr))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(hash ppk (hash pms cr sr))</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 639.960 Q 192.900 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='339.840' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='339.840' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr) (sr sr) (pms pms) (s s) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 167</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (ppk skey) (u s ca ca-0 name) (pt pt-0 pval)
    (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (defstrand serverr 4 (cr cr) (sr sr) (pms pms) (s s) (ca ca))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor))
  (deflistener (hash ppk (hash pms cr sr)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (3 5)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash ppk (hash pms cr sr)))
    (enc cookie (hash ppk (hash pms cr sr))) (3 5))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv (hash ppk (hash pms cr sr)))
      (send (hash ppk (hash pms cr sr)))))
  (label 167)
  (parent 162)
  (unrealized (0 6) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k168">Item <a href="#t155">168</a>, Parent: <a href="#k163">163</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='564.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 168</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (pms random48) (ppk skey) (u s ca name)
    (pt pval) (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca))
  (uniq-orig cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 168)
  (parent 163)
  (unrealized (0 4) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k169">Item <a href="#t155">169</a>, Parent: <a href="#k164">164</a>, Child: <a href="#k171">171</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 291.078 299.718 242.316 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>ca 169</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (ppk skey) (u ca u-0 s ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca-0))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (1 5)) ((3 1) (2 4)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (2 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 169)
  (parent 164)
  (unrealized (0 6) (1 5) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k170">Item <a href="#t155">170</a>, Parent: <a href="#k166">166</a>, Child: <a href="#k172">172</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 391.038 299.718 342.276 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 170</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (ppk skey) (u ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca-0))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5)) ((4 1) (3 4)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (3 4))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 170)
  (parent 166)
  (unrealized (0 6) (2 5) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k171">Item <a href="#t155">171</a>, Parent: <a href="#k169">169</a>, Child: <a href="#k173">173</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 291.524 337.464 243.207 409.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.913 412.717 43.945 560.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>ca 171</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (ppk skey) (u ca u-0 s ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca-0))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (1 5)) ((3 1) (2 4)) ((4 1) (3 0)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 171)
  (parent 169)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k172">Item <a href="#t155">172</a>, Parent: <a href="#k170">170</a>, Child: <a href="#k174">174</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 492.780 189.960 445.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 391.484 337.464 343.167 409.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.300 413.160 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 172</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (ppk skey) (u ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca-0))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5)) ((4 1) (3 4))
    ((5 1) (4 0)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 172)
  (parent 170)
  (unrealized (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k173">Item <a href="#t155">173</a>, Parent: <a href="#k171">171</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 141.913 487.717 43.945 635.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='189.960' r='6.000'/>
   </g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.111 263.906 234.262 337.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 173</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (pms pms-0 random48)
    (ppk skey) (u ca u-0 s ca-0 name) (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca-0))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (1 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 173)
  (parent 171)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k174">Item <a href="#t155">174</a>, Parent: <a href="#k172">172</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.300 488.160 44.759 636.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk s)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-1 sr-1 (cat s (pubk s) (enc (hash s (pubk s)) (privk ca))) (enc pms-0 (pubk s)))) (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash pms cr sr))) request (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.990 264.232 334.019 338.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk s)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0))) (enc pms (pubk s)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms) (ppk ppk) (u u-0) (s s) (ca ca-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca) (cookiestor cookiestor))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (s s) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash pms cr sr)))) (response response) (request request) (cr cr) (sr sr) (pms pms) (u u) (s s) (ca ca-0) (cookiestor cookiestor))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 174</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32)
    (pms pms-0 random48) (ppk skey) (u ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn))
  (defstrand clientr 7 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (response response) (request request) (cr cr) (sr sr) (pms pms)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (s s) (ca ca-0))
  (defstrand clienta 8 (cookie (enc cookie (hash ppk (hash pms cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (pms pms-0) (u u) (s s) (ca ca)
    (cookiestor cookiestor))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (pms pms)
    (ppk ppk) (u u-0) (s s) (ca ca-0))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (privk s) (privk ca-0))
  (uniq-orig cookie cr sr pms)
  (gen-st
    (cat &quot;client store&quot; u s (enc cookie (hash ppk (hash pms cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (5 0))
  (traces
    ((send cr)
      (recv (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (send
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash pms cr sr))) request
          (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv (enc response (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send (cat sr-0 s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))))
    ((send cr-1)
      (recv (cat sr-1 s (pubk s) (enc (hash s (pubk s)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk s))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                (enc pms-0 (pubk s))))
            (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
              (enc pms-0 (pubk s))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat s (pubk s) (enc (hash s (pubk s)) (privk ca)))
                    (enc pms-0 (pubk s))))
                (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc &quot;login&quot; u p (hash (hash pms-0 cr-1 sr-1) &quot;client_write&quot;)))
      (recv
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms-0 cr-1 sr-1) &quot;server_write&quot;)))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie (hash ppk (hash pms cr sr))))))
    ((recv cr)
      (send (cat sr s (pubk s) (enc (hash s (pubk s)) (privk ca-0))))
      (recv
        (cat (enc pms (pubk s))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
                (enc pms (pubk s))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat s (pubk s) (enc (hash s (pubk s)) (privk ca-0)))
              (enc pms (pubk s))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat s (pubk s)
                      (enc (hash s (pubk s)) (privk ca-0)))
                    (enc pms (pubk s))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc &quot;login&quot; u-0 p-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;login-successful&quot; (enc cookie (hash ppk (hash pms cr sr)))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 174)
  (parent 172)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

</body>
</html>
