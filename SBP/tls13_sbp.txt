(herald
  "Session Binding Protocol with TLS 1.3 (uses the modified server as implemented and tested in the paper and the cookie authentication model (ca.scm) which showed the cookie stealing attack)."
  (bound 12))

(comment "CPSA 4.4.2")
(comment "All input read from tls13_sbp.scm")
(comment "Strand count bounded at 12")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x)
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 4)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 4)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 0)
  (unrealized (0 1))
  (origs (pt-0 (0 6)) (cr (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x)
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 1)
  (parent 0)
  (unrealized (0 1))
  (origs (pt-0 (0 6)) (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt) (y-0 rndx)
    (x-0 expt))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 2)
  (parent 1)
  (unrealized (0 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 3)
  (parent 2)
  (unrealized (0 4) (0 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))))
  (label 4)
  (parent 2)
  (unrealized (0 4) (0 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 4) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 1 2 servera 5)
    (enc "login-successful"
      (enc cookie (hash ppk (hash (exp (gen) (mul x y-0)) "derived")))
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y-0)) "derived"))) (0 4))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 5)
  (parent 3)
  (unrealized (0 8) (1 2) (1 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 4)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc "login-successful" cookie
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (0 4))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 6)
  (parent 3)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 4) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 3 servera 5)
    (enc "login-successful"
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-1)) "derived")))
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-1)) "derived"))) (0 4))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 7)
  (parent 4)
  (unrealized (0 8) (2 2) (2 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((3 1) (0 4)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc "login-successful" cookie
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (0 4))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 8)
  (parent 4)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 4) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 0 clientr 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
              (enc (hash s spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 9)
  (parent 5)
  (unrealized (0 8) (1 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 4) (0 4))
    ((2 1) (1 2)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
              (enc (hash s spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 10)
  (parent 5)
  (unrealized (0 8) (1 2) (1 3) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 4))
    ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 11)
  (parent 6)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 4) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 3 0 clientr 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
              spk (enc (hash s spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 12)
  (parent 7)
  (unrealized (0 8) (2 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 4) (0 4)) ((3 1) (2 2)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
              spk (enc (hash s spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 13)
  (parent 7)
  (unrealized (0 8) (2 2) (2 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 1) (0 4)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 14)
  (parent 8)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 4) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 0 clienta 4)
    (enc "login" u-0 p-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x-0)) "derived"))) (1 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 15)
  (parent 9)
  (unrealized (0 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (2 0))
    ((1 4) (0 4)) ((2 1) (1 3)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived")))
    (enc "login" u-0 p-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived"))) (1 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 16)
  (parent 9)
  (unrealized (0 8) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 4) (0 4))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 17)
  (parent 10)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 4))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 18)
  (parent 11)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 4) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 3 0 clienta 4)
    (enc "login" u-0 p-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-1)) "derived"))) (2 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 19)
  (parent 12)
  (unrealized (0 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 1) (3 0)) ((2 4) (0 4)) ((3 1) (2 3)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (enc "login" u-0 p-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived"))) (2 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 20)
  (parent 12)
  (unrealized (0 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 4) (0 4)) ((3 1) (2 2)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 21)
  (parent 13)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 1) (0 4)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 22)
  (parent 14)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 4) (0 4)) ((1 8) (0 8)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 1 2 servera 9)
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x)) "derived"))) (0 8))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 23)
  (parent 15)
  (unrealized (1 7))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (2 0)) ((1 4) (0 4)) ((2 1) (0 8)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived")))
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived"))) (0 8))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 24)
  (parent 15)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (3 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived"))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 25)
  (parent 16)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 4) (0 4))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 26)
  (parent 17)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 4) (0 4))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 27)
  (parent 17)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 4))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 28)
  (parent 18)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 4))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 29)
  (parent 18)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 8) (0 8)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 2 3 servera 9)
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-0)) "derived"))) (0 8))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 30)
  (parent 19)
  (unrealized (2 7))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (3 0)) ((2 4) (0 4)) ((3 1) (0 8)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived"))) (0 8))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 31)
  (parent 19)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 1) (4 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 32)
  (parent 20)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 4) (0 4)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 33)
  (parent 21)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 4) (0 4)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 34)
  (parent 21)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 4)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 35)
  (parent 22)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 4)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 36)
  (parent 22)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 7) (1 7))
    ((1 1) (0 1)) ((1 4) (0 4)) ((1 8) (0 8)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 2 0 clienta 8)
    (enc
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) "derived")))
      request-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y)) "derived"))) (1 7))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 37)
  (parent 23)
  (realized)
  (shape)
  (maps
    ((0)
      ((u u) (s s) (ca ca) (spk spk) (p p) (cr cr) (sr sr) (x x) (y y)
        (cookie
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
        (any any) (cookiestor cookiestor) (request request)
        (response response))))
  (origs (pt-0 (0 6)) (cookie (1 4)) (pt-2 (1 6)) (cr (0 0))
    (sr (1 1))))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (2 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
      request-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (1 7))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 38)
  (parent 23)
  (unrealized (1 7) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (3 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived"))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 39)
  (parent 24)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (4 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) "derived"))
    (hash (exp (gen) (mul y x)) "derived") (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived"))))
  (label 40)
  (parent 25)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 7) (2 7))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 8) (0 8)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 3 0 clienta 8)
    (enc
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) "derived")))
      request-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-1 y-0)) "derived"))) (2 7))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 41)
  (parent 30)
  (seen 37)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (3 0)) ((2 4) (0 4)) ((2 8) (0 8))
    ((3 1) (2 7)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
      request-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (2 7))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 42)
  (parent 30)
  (unrealized (2 7) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (4 0)) ((2 4) (0 4)) ((3 1) (0 8))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 43)
  (parent 31)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 1) (5 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) "derived"))
    (hash (exp (gen) (mul y-0 x-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived"))))
  (label 44)
  (parent 32)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (3 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 45)
  (parent 38)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (4 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) "derived"))
    (hash (exp (gen) (mul y x)) "derived") (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived"))))
  (label 46)
  (parent 39)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (5 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 47)
  (parent 40)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (5 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 48)
  (parent 40)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (4 0)) ((2 4) (0 4)) ((2 8) (0 8))
    ((3 1) (2 7)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 49)
  (parent 42)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (5 0)) ((2 4) (0 4)) ((3 1) (0 8))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) "derived"))
    (hash (exp (gen) (mul y-0 x-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived"))))
  (label 50)
  (parent 43)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 1) (6 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 51)
  (parent 44)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 1) (6 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 52)
  (parent 44)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (4 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 53)
  (parent 45)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 54)
  (parent 46)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 55)
  (parent 46)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (5 0)) ((2 4) (0 4)) ((2 8) (0 8))
    ((3 1) (2 7)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 56)
  (parent 49)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (6 0)) ((2 4) (0 4)) ((3 1) (0 8))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 57)
  (parent 50)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (6 0)) ((2 4) (0 4)) ((3 1) (0 8))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 58)
  (parent 50)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 59)
  (parent 53)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 60)
  (parent 53)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (6 0)) ((2 4) (0 4)) ((2 8) (0 8))
    ((3 1) (2 7)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 61)
  (parent 56)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (6 0)) ((2 4) (0 4)) ((2 8) (0 8))
    ((3 1) (2 7)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 62)
  (parent 56)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x)
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 4)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 4)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (deflistener cookie)
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv cookie) (send cookie)))
  (label 63)
  (unrealized (0 1))
  (origs (pt-0 (0 6)) (cr (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (deflistener cookie)
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x)
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv cookie) (send cookie)))
  (label 64)
  (parent 63)
  (unrealized (0 1))
  (origs (pt-0 (0 6)) (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt) (y-0 rndx)
    (x-0 expt))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (precedes ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv cookie) (send cookie))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 65)
  (parent 64)
  (unrealized (0 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (precedes ((0 0) (2 0)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 3 2 serverr 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv cookie) (send cookie))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 66)
  (parent 65)
  (unrealized (0 4) (0 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (precedes ((0 0) (3 0)) ((2 1) (0 1)) ((3 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv cookie) (send cookie))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))))
  (label 67)
  (parent 65)
  (unrealized (0 4) (0 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (2 0)) ((2 1) (0 1)) ((2 1) (3 0)) ((3 1) (0 4)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc "login-successful" cookie
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (0 4))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv cookie) (send cookie))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 68)
  (parent 66)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (3 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 1) (4 0))
    ((4 1) (0 4)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc "login-successful" cookie
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (0 4))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv cookie) (send cookie))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 69)
  (parent 67)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (2 0)) ((2 1) (0 1)) ((2 1) (4 0)) ((3 1) (0 4))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv cookie) (send cookie))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 70)
  (parent 68)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (3 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 1) (5 0))
    ((4 1) (0 4)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv cookie) (send cookie))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 71)
  (parent 69)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (2 0)) ((2 1) (0 1)) ((2 1) (5 0)) ((3 1) (0 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv cookie) (send cookie))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 72)
  (parent 70)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 0) (3 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 1) (6 0))
    ((4 1) (0 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv cookie) (send cookie))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 73)
  (parent 71)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((2 1) (0 1)) ((2 1) (6 0)) ((3 1) (0 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv cookie) (send cookie))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 74)
  (parent 72)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((2 1) (0 1)) ((2 1) (6 0)) ((3 1) (0 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv cookie) (send cookie))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 75)
  (parent 72)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (3 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 1) (7 0))
    ((4 1) (0 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (6 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv cookie) (send cookie))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 76)
  (parent 73)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (3 0)) ((2 1) (0 1)) ((3 1) (0 1)) ((3 1) (7 0))
    ((4 1) (0 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (6 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv cookie) (send cookie))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 77)
  (parent 73)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x)
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 4)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 4)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (x rndx) (y expt))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 78)
  (unrealized (0 1))
  (origs (cr (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (x rndx) (y expt))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (gen-st (cat "client store" u s cookie))
  (rule gen-st-clientr-0)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 79)
  (parent 78)
  (unrealized (0 1) (0 3))
  (origs (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 80)
  (parent 79)
  (unrealized (0 1) (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (x y rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 81)
  (parent 80)
  (unrealized (0 3) (0 5))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (added-strand serverr 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))))
  (label 82)
  (parent 80)
  (unrealized (0 3) (0 5))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx)
    (y-0 expt))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((2 6) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation channel-test (added-strand clienta 7)
    (ch-msg cookiestor (cat pt "client store" u s cookie)) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie))))
  (label 83)
  (parent 81)
  (unrealized (0 5))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y rndx)
    (x expt) (x-0 y-0 x-1 rndx) (y-1 expt))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((3 6) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation channel-test (added-strand clienta 7)
    (ch-msg cookiestor (cat pt "client store" u s cookie)) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie))))
  (label 84)
  (parent 82)
  (unrealized (0 5))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 8) (0 5)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 1 3 servera 9)
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-1)) "derived"))) (0 5))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 85)
  (parent 83)
  (unrealized (2 2) (2 3) (2 7))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 5) (0 5)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-5
    trRl_clienta-at-6)
  (operation encryption-test (displaced 1 3 serverr 6)
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-1)) "derived"))) (0 5))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 86)
  (parent 83)
  (unrealized (2 2) (2 3) (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx)
    (y-0 expt))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 6) (0 3))
    ((3 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (0 5))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 87)
  (parent 83)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (x-1 y-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 8) (0 5)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 2 4 servera 9)
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-1 y-2)) "derived"))) (0 5))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))))
  (label 88)
  (parent 84)
  (unrealized (3 2) (3 3) (3 7))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (x-1 y-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 5) (0 5)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-5
    trRl_clienta-at-6)
  (operation encryption-test (displaced 2 4 serverr 6)
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-1 y-2)) "derived"))) (0 5))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))))
  (label 89)
  (parent 84)
  (unrealized (3 2) (3 3) (3 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y rndx)
    (x expt) (x-0 y-0 x-1 rndx) (y-1 expt))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (x x-1) (y y-1))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 6) (0 3)) ((4 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (0 5))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 90)
  (parent 84)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 8) (0 5)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 3 0 clientr 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
              spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
      (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 91)
  (parent 85)
  (unrealized (2 3) (2 7))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 8) (0 5)) ((3 1) (2 2)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
              spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 92)
  (parent 85)
  (unrealized (2 2) (2 3) (2 7) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (x rndx) (y expt)
    (y-0 x-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 5) (0 5)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 3 0 clientr 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
              spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
      (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 93)
  (parent 86)
  (unrealized (2 3) (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 5) (0 5)) ((3 1) (2 2)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
              spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 94)
  (parent 86)
  (unrealized (2 2) (2 3) (2 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx)
    (y-0 expt))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 6) (0 3))
    ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 95)
  (parent 87)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 8) (0 5)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 4 0 clientr 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
              spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
      (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)) (3 2))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
  (label 96)
  (parent 88)
  (unrealized (3 3) (3 7))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (x-1 y-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (4 0)) ((3 8) (0 5)) ((4 1) (3 2)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
              spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
      (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)) (3 2))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))))
  (label 97)
  (parent 88)
  (unrealized (3 2) (3 3) (3 7) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 5) (0 5)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 4 0 clientr 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
              spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
      (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)) (3 2))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
  (label 98)
  (parent 89)
  (unrealized (3 3) (3 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (x-1 y-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (4 0)) ((3 5) (0 5)) ((4 1) (3 2)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
              spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
      (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)) (3 2))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))))
  (label 99)
  (parent 89)
  (unrealized (3 2) (3 3) (3 4) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y rndx)
    (x expt) (x-0 y-0 x-1 rndx) (y-1 expt))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (x x-1) (y y-1))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 6) (0 3)) ((4 1) (0 5)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 100)
  (parent 90)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (3 0)) ((2 8) (0 5)) ((3 1) (2 3)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (enc "login" u-0 p-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived"))) (2 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 101)
  (parent 91)
  (unrealized (2 7) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 8) (0 5)) ((3 1) (2 2)) ((4 1) (3 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 102)
  (parent 92)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 3)) ((1 6) (0 3))
    ((2 1) (0 1)) ((2 1) (1 4)) ((2 5) (0 5)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 3 0 clientr 5)
    (enc
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) "derived")))
      request-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-1)) "derived"))) (2 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 103)
  (parent 93)
  (unrealized (1 4) (2 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (x rndx) (y expt)
    (y-0 x-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (3 0)) ((2 5) (0 5)) ((3 1) (2 3)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (enc
      (enc cookie-0
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))) request-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived"))) (2 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 104)
  (parent 93)
  (unrealized (2 3) (2 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 5) (0 5)) ((3 1) (2 2)) ((4 1) (3 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 105)
  (parent 94)
  (unrealized (2 3) (2 4) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx)
    (y-0 expt))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 6) (0 3))
    ((3 1) (0 5)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 106)
  (parent 95)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (4 0)) ((3 8) (0 5)) ((4 1) (3 3)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-1)) "derived")))
    (enc "login" u-0 p-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-1)) "derived"))) (3 3))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (label 107)
  (parent 96)
  (unrealized (3 7) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (x-1 y-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (5 0)) ((3 8) (0 5)) ((4 1) (3 2)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))))
  (label 108)
  (parent 97)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 3)) ((1 1) (0 1))
    ((2 6) (0 3)) ((3 1) (0 1)) ((3 1) (2 4)) ((3 5) (0 5)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 4 0 clientr 5)
    (enc
      (enc cookie (hash ppk (hash (exp (gen) (mul y-1 x-2)) "derived")))
      request-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-2)) "derived"))) (3 3))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
  (label 109)
  (parent 98)
  (unrealized (2 4) (3 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (4 0)) ((3 5) (0 5)) ((4 1) (3 3)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-1)) "derived")))
    (enc
      (enc cookie-0
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))) request-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-1)) "derived"))) (3 3))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (label 110)
  (parent 98)
  (unrealized (3 3) (3 4) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (x-1 y-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (5 0)) ((3 5) (0 5)) ((4 1) (3 2)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))))
  (label 111)
  (parent 99)
  (unrealized (3 3) (3 4) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y rndx)
    (x expt) (x-0 y-0 x-1 rndx) (y-1 expt))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (x x-1) (y y-1))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 6) (0 3)) ((4 1) (0 5)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 112)
  (parent 100)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (4 0)) ((2 8) (0 5)) ((3 1) (2 3)) ((4 1) (3 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 113)
  (parent 101)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 8) (0 5)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 114)
  (parent 102)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 8) (0 5)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 115)
  (parent 102)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk ppk-0 skey)
    (spk spk-0 spk-1 akey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (x rndx)
    (y expt) (y-0 x-0 y-1 rndx) (x-1 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (defstrand servera 7 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1)
    (authstor authstor) (y y-1) (x x-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 3)) ((1 6) (0 3))
    ((2 1) (0 1)) ((2 1) (1 4)) ((2 5) (0 5)) ((3 4) (1 4))
    ((3 6) (2 4)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y-0 x-0 y-1)
  (absent (y-0 x-0) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)) ((3 6) (2 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation channel-test (added-strand servera 7)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (2 4))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-1
                (enc (hash s spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-1
                  (enc (hash s spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1 sr-1))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-1
                (enc (hash s spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-1
                  (enc (hash s spk-1) (privk ca-1))) (invk spk-1))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 116)
  (parent 103)
  (unrealized (1 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (x rndx) (y expt)
    (y-0 x-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (4 0)) ((2 5) (0 5)) ((3 1) (2 3)) ((4 1) (3 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 117)
  (parent 104)
  (unrealized (2 3) (2 4) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 5) (0 5)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 118)
  (parent 105)
  (unrealized (2 3) (2 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 5) (0 5)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 119)
  (parent 105)
  (unrealized (2 3) (2 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx)
    (y-0 expt))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (6 0)) ((2 6) (0 3))
    ((3 1) (0 5)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 120)
  (parent 106)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx)
    (y-0 expt))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (6 0)) ((2 6) (0 3))
    ((3 1) (0 5)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 121)
  (parent 106)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (5 0)) ((3 8) (0 5)) ((4 1) (3 3))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-1)) "derived")))
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (label 122)
  (parent 107)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (x-1 y-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-1) y-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (6 0)) ((3 8) (0 5)) ((4 1) (3 2)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-1))
    (exp (gen) (mul x-1 y-1)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-1) y-1)) (send (cat (exp (gen) x-1) y-1))))
  (label 123)
  (parent 108)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (x-1 y-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-1) x-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (6 0)) ((3 8) (0 5)) ((4 1) (3 2)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-1) x-1))
    (exp (gen) (mul x-1 y-1)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-1) x-1)) (send (cat (exp (gen) y-1) x-1))))
  (label 124)
  (parent 108)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk ppk-0 skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x rndx) (y expt) (y-0 x-0 rndx)
    (x-1 expt) (y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (defstrand servera 7 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (ppk ppk-0) (spk spk-0) (u u-0) (s s) (ca ca-0)
    (authstor authstor) (y y-1) (x x-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 3)) ((1 6) (0 3))
    ((2 1) (0 1)) ((2 1) (1 4)) ((2 5) (0 5)) ((3 1) (0 1))
    ((3 4) (1 4)) ((3 6) (2 4)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y-0 x-0 y-1)
  (absent (y-0 x-0) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)) ((3 6) (2 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation channel-test (displaced 1 4 servera 7)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (3 4))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 125)
  (parent 109)
  (unrealized (1 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 cr-2 sr-2 random32) (ppk ppk-0 skey)
    (spk spk-0 spk-1 akey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (x-0 rndx) (y-0 expt) (y-1 x-1 y-2 rndx) (x-2 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (defstrand servera 7 (any any-0) (cookie cookie) (p p-0) (cr cr-2)
    (sr sr-2) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1)
    (authstor authstor) (y y-2) (x x-2))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 3)) ((1 1) (0 1))
    ((2 6) (0 3)) ((3 1) (0 1)) ((3 1) (2 4)) ((3 5) (0 5))
    ((4 4) (2 4)) ((4 6) (3 4)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-1 x-1 y-2)
  (absent (y x) (y-1 x-1) (y-2 x-2))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)) ((4 6) (3 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation channel-test (added-strand servera 7)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (3 4))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-2 (exp (gen) x-2)))
      (send
        (cat (cat sr-2 (exp (gen) y-2))
          (enc (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-2 (exp (gen) x-2))
                (cat sr-2 (exp (gen) y-2)) s spk-1
                (enc (hash s spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-2 x-2)) "s hs traffic" cr-2
                  sr-2)) (cat cr-2 (exp (gen) x-2))
              (cat sr-2 (exp (gen) y-2))
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-2 (exp (gen) x-2))
                  (cat sr-2 (exp (gen) y-2)) s spk-1
                  (enc (hash s spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul y-2 x-2)) "s hs traffic" cr-2 sr-2))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-2 x-2)) "c hs traffic" cr-2 sr-2))
            (cat cr-2 (exp (gen) x-2)) (cat sr-2 (exp (gen) y-2))
            (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-2 (exp (gen) x-2))
                (cat sr-2 (exp (gen) y-2)) s spk-1
                (enc (hash s spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-2 x-2)) "s hs traffic" cr-2
                  sr-2)) (cat cr-2 (exp (gen) x-2))
              (cat sr-2 (exp (gen) y-2))
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-2 (exp (gen) x-2))
                  (cat sr-2 (exp (gen) y-2)) s spk-1
                  (enc (hash s spk-1) (privk ca-1))) (invk spk-1))))
          (hash (exp (gen) (mul y-2 x-2)) "c hs traffic" cr-2 sr-2)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-2 sr-2
            (hash (exp (gen) (mul y-2 x-2)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul y-2 x-2)) "derived")))
          (hash "s ap traffic" cr-2 sr-2
            (hash (exp (gen) (mul y-2 x-2)) "derived"))))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 126)
  (parent 109)
  (unrealized (2 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (5 0)) ((3 5) (0 5)) ((4 1) (3 3))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-1)) "derived")))
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (label 127)
  (parent 110)
  (unrealized (3 3) (3 4) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (x-1 y-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-1) y-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (6 0)) ((3 5) (0 5)) ((4 1) (3 2)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-1))
    (exp (gen) (mul x-1 y-1)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-1) y-1)) (send (cat (exp (gen) x-1) y-1))))
  (label 128)
  (parent 111)
  (unrealized (3 3) (3 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (x-1 y-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-1) x-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (6 0)) ((3 5) (0 5)) ((4 1) (3 2)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-1) x-1))
    (exp (gen) (mul x-1 y-1)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-1) x-1)) (send (cat (exp (gen) y-1) x-1))))
  (label 129)
  (parent 111)
  (unrealized (3 3) (3 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y rndx)
    (x expt) (x-0 y-0 x-1 rndx) (y-1 expt))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (x x-1) (y y-1))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (7 0))
    ((3 6) (0 3)) ((4 1) (0 5)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (6 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 130)
  (parent 112)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y rndx)
    (x expt) (x-0 y-0 x-1 rndx) (y-1 expt))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (x x-1) (y y-1))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (7 0))
    ((3 6) (0 3)) ((4 1) (0 5)) ((5 1) (4 0)) ((6 1) (5 0))
    ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (6 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 131)
  (parent 112)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (5 0)) ((2 8) (0 5)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) "derived"))
    (hash (exp (gen) (mul y-0 x-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived"))))
  (label 132)
  (parent 113)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk ppk-0 skey)
    (spk spk-0 spk-1 akey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (x rndx)
    (y expt) (y-0 x-0 y-1 rndx) (x-1 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (defstrand servera 7 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1)
    (authstor authstor) (y y-1) (x x-1))
  (deflistener (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 3)) ((1 6) (0 3))
    ((2 1) (0 1)) ((2 1) (4 0)) ((2 5) (0 5)) ((3 4) (1 4))
    ((3 6) (2 4)) ((4 1) (1 4)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y-0 x-0 y-1)
  (absent (y-0 x-0) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)) ((3 6) (2 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (1 4))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-1
                (enc (hash s spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-1
                  (enc (hash s spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1 sr-1))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-1
                (enc (hash s spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-1
                  (enc (hash s spk-1) (privk ca-1))) (invk spk-1))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie)))
    ((recv (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 133)
  (parent 116)
  (unrealized (1 4) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (x rndx) (y expt)
    (y-0 x-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (5 0)) ((2 5) (0 5)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) "derived"))
    (hash (exp (gen) (mul y-0 x-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived"))))
  (label 134)
  (parent 117)
  (unrealized (2 3) (2 4) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "derived"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (6 0)) ((3 8) (0 5)) ((4 1) (3 3))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-1 x-1)) "derived"))
    (hash (exp (gen) (mul y-1 x-1)) "derived") (5 0))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "derived"))
      (send (cat (exp (gen) (mul y-1 x-1)) "derived"))))
  (label 135)
  (parent 122)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk ppk-0 skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x rndx) (y expt) (y-0 x-0 rndx)
    (x-1 expt) (y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (defstrand servera 7 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (ppk ppk-0) (spk spk-0) (u u-0) (s s) (ca ca-0)
    (authstor authstor) (y y-1) (x x-1))
  (deflistener (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 3)) ((1 6) (0 3))
    ((2 1) (0 1)) ((2 1) (4 0)) ((2 5) (0 5)) ((3 1) (0 1))
    ((3 4) (1 4)) ((3 6) (2 4)) ((4 1) (1 4)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y-0 x-0 y-1)
  (absent (y-0 x-0) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)) ((3 6) (2 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (1 4))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie)))
    ((recv (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 136)
  (parent 125)
  (unrealized (1 4) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 cr-2 sr-2 random32) (ppk ppk-0 skey)
    (spk spk-0 spk-1 akey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (x-0 rndx) (y-0 expt) (y-1 x-1 y-2 rndx) (x-2 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (defstrand servera 7 (any any-0) (cookie cookie) (p p-0) (cr cr-2)
    (sr sr-2) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1)
    (authstor authstor) (y y-2) (x x-2))
  (deflistener (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 4) (3 3)) ((1 1) (0 1))
    ((2 6) (0 3)) ((3 1) (0 1)) ((3 1) (5 0)) ((3 5) (0 5))
    ((4 4) (2 4)) ((4 6) (3 4)) ((5 1) (2 4)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-1 x-1 y-2)
  (absent (y x) (y-1 x-1) (y-2 x-2))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)) ((4 6) (3 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
    (enc cookie (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
    (2 4))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-2 (exp (gen) x-2)))
      (send
        (cat (cat sr-2 (exp (gen) y-2))
          (enc (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-2 (exp (gen) x-2))
                (cat sr-2 (exp (gen) y-2)) s spk-1
                (enc (hash s spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-2 x-2)) "s hs traffic" cr-2
                  sr-2)) (cat cr-2 (exp (gen) x-2))
              (cat sr-2 (exp (gen) y-2))
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-2 (exp (gen) x-2))
                  (cat sr-2 (exp (gen) y-2)) s spk-1
                  (enc (hash s spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul y-2 x-2)) "s hs traffic" cr-2 sr-2))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-2 x-2)) "c hs traffic" cr-2 sr-2))
            (cat cr-2 (exp (gen) x-2)) (cat sr-2 (exp (gen) y-2))
            (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-2 (exp (gen) x-2))
                (cat sr-2 (exp (gen) y-2)) s spk-1
                (enc (hash s spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-2 x-2)) "s hs traffic" cr-2
                  sr-2)) (cat cr-2 (exp (gen) x-2))
              (cat sr-2 (exp (gen) y-2))
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-2 (exp (gen) x-2))
                  (cat sr-2 (exp (gen) y-2)) s spk-1
                  (enc (hash s spk-1) (privk ca-1))) (invk spk-1))))
          (hash (exp (gen) (mul y-2 x-2)) "c hs traffic" cr-2 sr-2)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-2 sr-2
            (hash (exp (gen) (mul y-2 x-2)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul y-2 x-2)) "derived")))
          (hash "s ap traffic" cr-2 sr-2
            (hash (exp (gen) (mul y-2 x-2)) "derived"))))
      (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie)))
    ((recv (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (label 137)
  (parent 126)
  (unrealized (2 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "derived"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (6 0)) ((3 5) (0 5)) ((4 1) (3 3))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-1 x-1)) "derived"))
    (hash (exp (gen) (mul y-1 x-1)) "derived") (5 0))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "derived"))
      (send (cat (exp (gen) (mul y-1 x-1)) "derived"))))
  (label 138)
  (parent 127)
  (unrealized (3 3) (3 4) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (6 0)) ((2 8) (0 5)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 139)
  (parent 132)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (6 0)) ((2 8) (0 5)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 140)
  (parent 132)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (x rndx) (y expt)
    (y-0 x-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (6 0)) ((2 5) (0 5)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 141)
  (parent 134)
  (unrealized (2 3) (2 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (x rndx) (y expt)
    (y-0 x-0 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x) (y y))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (6 0)) ((2 5) (0 5)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 142)
  (parent 134)
  (unrealized (2 3) (2 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "derived"))
  (deflistener (cat (exp (gen) y-1) x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (7 0)) ((3 8) (0 5)) ((4 1) (3 3))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-1) x-1))
    (exp (gen) (mul y-1 x-1)) (6 0))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "derived"))
      (send (cat (exp (gen) (mul y-1 x-1)) "derived")))
    ((recv (cat (exp (gen) y-1) x-1)) (send (cat (exp (gen) y-1) x-1))))
  (label 143)
  (parent 135)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand servera 9 (any any-0) (cookie cookie-0) (response response)
    (request request-0) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0)
    (u u-0) (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "derived"))
  (deflistener (cat (exp (gen) x-1) y-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (7 0)) ((3 8) (0 5)) ((4 1) (3 3))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-1))
    (exp (gen) (mul y-1 x-1)) (6 0))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "derived"))
      (send (cat (exp (gen) (mul y-1 x-1)) "derived")))
    ((recv (cat (exp (gen) x-1) y-1)) (send (cat (exp (gen) x-1) y-1))))
  (label 144)
  (parent 135)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "derived"))
  (deflistener (cat (exp (gen) y-1) x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (7 0)) ((3 5) (0 5)) ((4 1) (3 3))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-1) x-1))
    (exp (gen) (mul y-1 x-1)) (6 0))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "derived"))
      (send (cat (exp (gen) (mul y-1 x-1)) "derived")))
    ((recv (cat (exp (gen) y-1) x-1)) (send (cat (exp (gen) y-1) x-1))))
  (label 145)
  (parent 138)
  (unrealized (3 3) (3 4) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (y y) (x x))
  (defstrand clienta 7 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 6 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (y y-1) (x x-1))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "derived"))
  (deflistener (cat (exp (gen) x-1) y-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (7 0)) ((3 5) (0 5)) ((4 1) (3 3))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-serverr-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-1))
    (exp (gen) (mul y-1 x-1)) (6 0))
  (traces
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((send (cat cr-1 (exp (gen) x-0)))
      (recv
        (cat (cat sr-1 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (cat cr (exp (gen) x-1)))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) y-1))
                  s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "derived"))
      (send (cat (exp (gen) (mul y-1 x-1)) "derived")))
    ((recv (cat (exp (gen) x-1) y-1)) (send (cat (exp (gen) x-1) y-1))))
  (label 146)
  (parent 138)
  (unrealized (3 3) (3 4) (7 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x)
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 4)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 4)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pt-0 pval)
    (authstor locn) (y rndx) (x expt))
  (defstrand servera 8 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca)
    (authstor authstor) (y y) (x x))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y)
  (absent (y x))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 147)
  (realized)
  (origs (pt-0 (0 6)) (sr (0 1)) (cookie (0 4)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pt-0 pval)
    (authstor locn) (y rndx) (x expt))
  (defstrand servera 8 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca)
    (authstor authstor) (y y) (x x))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-5 trRl_servera-at-6)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 148)
  (parent 147)
  (realized)
  (shape)
  (maps
    ((0)
      ((s s) (ca ca) (cr cr) (sr sr) (spk spk) (ppk ppk) (cookie cookie)
        (u u) (y y) (x x) (p p) (any any) (authstor authstor)
        (request request))))
  (origs (pt-0 (0 6)) (sr (0 1)) (cookie (0 4))))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x)
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 4)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 4)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (ppk skey)
    (spk akey) (s ca u name) (pt pval) (authstor locn) (y rndx)
    (x expt))
  (defstrand serverr 5 (cookie cookie) (request request) (cr cr) (sr sr)
    (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (y y)
    (x x))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig sr)
  (uniq-gen y)
  (absent (y x))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt "server store" s u cookie))))
  (label 149)
  (unrealized (0 3))
  (origs (sr (0 1)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (ppk skey)
    (spk akey) (s ca u name) (pt pval) (authstor locn) (y rndx)
    (x expt))
  (defstrand serverr 5 (cookie cookie) (request request) (cr cr) (sr sr)
    (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (y y)
    (x x))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig sr)
  (uniq-gen y)
  (absent (y x))
  (gen-st (cat "server store" s u cookie))
  (facts (neq u s))
  (rule fact-serverr-neq0 gen-st-serverr-0)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt "server store" s u cookie))))
  (label 150)
  (parent 149)
  (unrealized (0 3) (0 4))
  (origs (sr (0 1)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (ppk skey)
    (spk akey) (s ca u name) (pt pval) (authstor locn) (y rndx)
    (x expt))
  (defstrand serverr 5 (cookie cookie) (request request) (cr cr) (sr sr)
    (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (y y)
    (x x))
  (deflistener (hash ppk (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 1) (1 0)) ((1 1) (0 3)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig sr)
  (uniq-gen y)
  (absent (y x))
  (gen-st (cat "server store" s u cookie))
  (facts (neq u s))
  (rule fact-serverr-neq0)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul y x)) "derived")))
    (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
    (0 3))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt "server store" s u cookie)))
    ((recv (hash ppk (hash (exp (gen) (mul y x)) "derived")))
      (send (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
  (label 151)
  (parent 150)
  (unrealized (0 4) (1 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x)
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 4)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 4)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x)
  (goals
    (forall
      ((any mesg) (cookie data) (response httpdata) (request httpreq)
        (p password) (cr sr random32) (spk akey) (x rndx) (u s ca name)
        (cookiestor locn) (z z-0 strd))
      (implies
        (and (p "clienta" z 9) (p "" z-0 2) (p "clienta" "any" z any)
          (p "clienta" "cookie" z cookie)
          (p "clienta" "response" z response) (p "clienta" "spk" z spk)
          (p "clienta" "request" z request) (p "clienta" "p" z p)
          (p "clienta" "cr" z cr) (p "clienta" "sr" z sr)
          (p "clienta" "x" z x) (p "clienta" "u" z u)
          (p "clienta" "s" z s) (p "clienta" "ca" z ca)
          (p "clienta" "cookiestor" z cookiestor) (p "" "x" z-0 cookie)
          (non (invk spk)) (non (privk ca)) (pnon p) (uniq sr)
          (uniq-at cr z 0) (ugen-at x z 0)) (false))))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 152)
  (unrealized (1 1))
  (origs (pt-0 (1 6)) (cr (1 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x)
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 153)
  (parent 152)
  (unrealized (1 1))
  (origs (pt-0 (1 6)) (cr (1 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt) (y-0 rndx)
    (x-0 expt))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (precedes ((2 1) (1 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 154)
  (parent 153)
  (unrealized (1 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 3 2 serverr 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 155)
  (parent 154)
  (unrealized (1 4) (1 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (precedes ((1 0) (3 0)) ((2 1) (1 1)) ((3 1) (1 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))))
  (label 156)
  (parent 154)
  (unrealized (1 4) (1 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)) ((2 1) (3 0)) ((3 1) (1 4)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc "login-successful" cookie
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (1 4))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 157)
  (parent 155)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((1 0) (3 0)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 1) (4 0))
    ((4 1) (1 4)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc "login-successful" cookie
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (1 4))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 158)
  (parent 156)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)) ((2 1) (4 0)) ((3 1) (1 4))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (3 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 159)
  (parent 157)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((1 0) (3 0)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 1) (5 0))
    ((4 1) (1 4)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 160)
  (parent 158)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)) ((2 1) (5 0)) ((3 1) (1 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 161)
  (parent 159)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((1 0) (3 0)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 1) (6 0))
    ((4 1) (1 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (5 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 162)
  (parent 160)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)) ((2 1) (6 0)) ((3 1) (1 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 163)
  (parent 161)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)) ((2 1) (6 0)) ((3 1) (1 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 164)
  (parent 161)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((1 0) (3 0)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 1) (7 0))
    ((4 1) (1 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 165)
  (parent 162)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((1 0) (3 0)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 1) (7 0))
    ((4 1) (1 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 166)
  (parent 162)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x)
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 4)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 4)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (goals
    (forall
      ((z strd) (cookie data) (u s ca name) (spk akey) (cr sr random32)
        (ppk skey) (x rndx) (y expt))
      (implies
        (and (p "clienta" z 9)
          (p "clienta" "cookie" z
            (enc cookie
              (hash ppk (hash (exp (exp (gen) y) x) "derived"))))
          (p "clienta" "u" z u) (p "clienta" "s" z s)
          (p "clienta" "spk" z spk) (p "clienta" "ca" z ca)
          (p "clienta" "cr" z cr) (p "clienta" "sr" z sr)
          (p "clienta" "x" z x) (p "clienta" "y" z y) (non (privk ca))
          (non (invk spk)) (non ppk) (uniq sr) (uniq-at cr z 0)
          (ugen-at x z 0))
        (exists ((z0 strd))
          (and (p "servera" z0 9) (p "servera" "cookie" z0 cookie)
            (p "servera" "u" z0 u) (p "servera" "s" z0 s)
            (uniq-at cookie z0 4) (fact neq u s))))))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 167)
  (unrealized (0 1) (0 4))
  (origs (pt-0 (0 6)) (cr (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 168)
  (parent 167)
  (unrealized (0 1) (0 4))
  (origs (pt-0 (0 6)) (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt)
    (y-0 rndx) (x-0 expt))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 169)
  (parent 168)
  (unrealized (0 1) (0 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 170)
  (parent 169)
  (unrealized (0 4) (0 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))))
  (label 171)
  (parent 169)
  (unrealized (0 4) (0 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 4) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 1 2 servera 5)
    (enc "login-successful"
      (enc cookie (hash ppk (hash (exp (gen) (mul x y-0)) "derived")))
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y-0)) "derived"))) (0 4))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 172)
  (parent 170)
  (unrealized (0 8) (1 2) (1 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc "login-successful"
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (0 4))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 173)
  (parent 170)
  (unrealized (0 4) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 4) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 3 servera 5)
    (enc "login-successful"
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-1)) "derived")))
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-1)) "derived"))) (0 4))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 174)
  (parent 171)
  (unrealized (0 8) (2 2) (2 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((3 1) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc "login-successful"
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (0 4))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 175)
  (parent 171)
  (unrealized (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 4) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 0 clientr 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
              (enc (hash s spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 176)
  (parent 172)
  (unrealized (0 8) (1 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 4) (0 4))
    ((2 1) (1 2)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
              (enc (hash s spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 177)
  (parent 172)
  (unrealized (0 8) (1 2) (1 3) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 4))
    ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 178)
  (parent 173)
  (unrealized (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 4) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 3 0 clientr 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
              spk (enc (hash s spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 179)
  (parent 174)
  (unrealized (0 8) (2 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 4) (0 4)) ((3 1) (2 2)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
              spk (enc (hash s spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 180)
  (parent 174)
  (unrealized (0 8) (2 2) (2 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 1) (0 4)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 181)
  (parent 175)
  (unrealized (0 4) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 4) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 0 clienta 4)
    (enc "login" u-0 p-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x-0)) "derived"))) (1 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 182)
  (parent 176)
  (unrealized (0 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (2 0))
    ((1 4) (0 4)) ((2 1) (1 3)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived")))
    (enc "login" u-0 p-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived"))) (1 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 183)
  (parent 176)
  (unrealized (0 8) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 4) (0 4))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 184)
  (parent 177)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 4))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 185)
  (parent 178)
  (unrealized (0 4) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 4) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 3 0 clienta 4)
    (enc "login" u-0 p-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-1)) "derived"))) (2 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 186)
  (parent 179)
  (unrealized (0 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 1) (3 0)) ((2 4) (0 4)) ((3 1) (2 3)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (enc "login" u-0 p-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived"))) (2 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 187)
  (parent 179)
  (unrealized (0 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 4) (0 4)) ((3 1) (2 2)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 188)
  (parent 180)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 1) (0 4)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 189)
  (parent 181)
  (unrealized (0 4) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 4) (0 4)) ((1 8) (0 8)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 1 2 servera 9)
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x)) "derived"))) (0 8))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 190)
  (parent 182)
  (unrealized (1 7))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (2 0)) ((1 4) (0 4)) ((2 1) (0 8)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived")))
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived"))) (0 8))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 191)
  (parent 182)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (3 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived"))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 192)
  (parent 183)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 4) (0 4))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 193)
  (parent 184)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 4) (0 4))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 194)
  (parent 184)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 4))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 195)
  (parent 185)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 4))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 196)
  (parent 185)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 8) (0 8)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 2 3 servera 9)
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-1 x-0)) "derived"))) (0 8))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 197)
  (parent 186)
  (unrealized (2 7))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (3 0)) ((2 4) (0 4)) ((3 1) (0 8)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (enc response
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived"))) (0 8))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 198)
  (parent 186)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 1) (4 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 199)
  (parent 187)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 4) (0 4)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 200)
  (parent 188)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 4) (0 4)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 201)
  (parent 188)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 4)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 202)
  (parent 189)
  (unrealized (0 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 4)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 203)
  (parent 189)
  (unrealized (0 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 7) (1 7))
    ((1 1) (0 1)) ((1 4) (0 4)) ((1 8) (0 8)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 2 0 clienta 8)
    (enc
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) "derived")))
      request-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y)) "derived"))) (1 7))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 204)
  (parent 190)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cookie cookie) (u u) (s s) (ca ca) (spk spk) (cr cr) (sr sr)
        (ppk ppk) (x x) (y y) (p p) (any any) (cookiestor cookiestor)
        (request request) (response response))))
  (origs (pt-0 (0 6)) (cookie (1 4)) (pt-2 (1 6)) (sr (1 1))
    (cr (0 0))))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (2 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
      request-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (1 7))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 205)
  (parent 190)
  (unrealized (1 7) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (3 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived"))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 206)
  (parent 191)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (4 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) "derived"))
    (hash (exp (gen) (mul y x)) "derived") (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived"))))
  (label 207)
  (parent 192)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 7) (2 7))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 8) (0 8)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 3 0 clienta 8)
    (enc
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) "derived")))
      request-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-1 y-0)) "derived"))) (2 7))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 208)
  (parent 197)
  (seen 204)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (3 0)) ((2 4) (0 4)) ((2 8) (0 8))
    ((3 1) (2 7)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
      request-0
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (2 7))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 209)
  (parent 197)
  (unrealized (2 7) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (4 0)) ((2 4) (0 4)) ((3 1) (0 8))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 210)
  (parent 198)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 1) (5 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) "derived"))
    (hash (exp (gen) (mul y-0 x-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived"))))
  (label 211)
  (parent 199)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (3 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 212)
  (parent 205)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (4 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) "derived"))
    (hash (exp (gen) (mul y x)) "derived") (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived"))))
  (label 213)
  (parent 206)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (5 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 214)
  (parent 207)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (5 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 215)
  (parent 207)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (4 0)) ((2 4) (0 4)) ((2 8) (0 8))
    ((3 1) (2 7)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 216)
  (parent 209)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (5 0)) ((2 4) (0 4)) ((3 1) (0 8))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) "derived"))
    (hash (exp (gen) (mul y-0 x-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived"))))
  (label 217)
  (parent 210)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 1) (6 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 218)
  (parent 211)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 1) (6 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 219)
  (parent 211)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (4 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 220)
  (parent 212)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 221)
  (parent 213)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 222)
  (parent 213)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (5 0)) ((2 4) (0 4)) ((2 8) (0 8))
    ((3 1) (2 7)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 223)
  (parent 216)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (6 0)) ((2 4) (0 4)) ((3 1) (0 8))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 224)
  (parent 217)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (6 0)) ((2 4) (0 4)) ((3 1) (0 8))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 225)
  (parent 217)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 226)
  (parent 220)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 227)
  (parent 220)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (6 0)) ((2 4) (0 4)) ((2 8) (0 8))
    ((3 1) (2 7)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 228)
  (parent 223)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (6 0)) ((2 4) (0 4)) ((2 8) (0 8))
    ((3 1) (2 7)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request-0
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 229)
  (parent 223)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful" cookie
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x)
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    (non-orig ppk)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 4)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p "clienta" z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p "servera" z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 4)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 5)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (random48 atom) (password atom) (httpreq atom)
    (httpdata atom)))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (u s ca name) (pt pval)
    (cookiestor locn) (x rndx) (y expt))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (goals
    (forall
      ((z strd) (cookie data) (u s ca name) (cr sr random32) (x rndx)
        (y expt) (spk akey) (ppk skey))
      (implies
        (and (p "clientr" z 6)
          (p "clientr" "cookie" z
            (enc cookie
              (hash ppk (hash (exp (exp (gen) y) x) "derived"))))
          (p "clientr" "u" z u) (p "clientr" "s" z s)
          (p "clientr" "spk" z spk) (p "clientr" "ca" z ca)
          (p "clientr" "cr" z cr) (p "clientr" "sr" z sr)
          (p "clientr" "x" z x) (p "clientr" "y" z y) (non (privk ca))
          (non (invk spk)) (non ppk) (uniq sr) (uniq-at cr z 0)
          (ugen-at x z 0))
        (exists ((z0 strd))
          (and (p "servera" z0 7) (p "servera" "cookie" z0 cookie)
            (p "servera" "u" z0 u) (p "servera" "s" z0 s)
            (uniq-at cookie z0 4) (fact neq u s))))))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 230)
  (unrealized (0 1) (0 3))
  (origs (cr (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (u s ca name) (pt pval)
    (cookiestor locn) (x rndx) (y expt))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
  (rule gen-st-clientr-0)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 231)
  (parent 230)
  (unrealized (0 1) (0 3))
  (origs (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey) (u s ca name)
    (pt pval) (cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 232)
  (parent 231)
  (unrealized (0 1) (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (u s ca name) (pt pval)
    (cookiestor locn) (x y rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 233)
  (parent 232)
  (unrealized (0 3) (0 5))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey) (u s ca name)
    (pt pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (operation encryption-test (added-strand serverr 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))))
  (label 234)
  (parent 232)
  (unrealized (0 3) (0 5))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx)
    (y-0 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 4)) ((2 6) (0 3)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
  (leads-to ((2 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation channel-test (added-strand clienta 7)
    (ch-msg cookiestor
      (cat pt "client store" u s
        (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
    (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))))
  (label 235)
  (parent 233)
  (unrealized (0 5) (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y rndx) (x expt) (x-0 y-0 x-1 rndx) (y-1 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 4))
    ((3 6) (0 3)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (leads-to ((3 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation channel-test (added-strand clienta 7)
    (ch-msg cookiestor
      (cat pt "client store" u s
        (enc cookie
          (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))))
  (label 236)
  (parent 234)
  (unrealized (0 5) (3 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 4) (1 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 1 3 servera 5)
    (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-1)) "derived")))
    (2 4))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 237)
  (parent 235)
  (unrealized (0 5) (1 4) (2 2) (2 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx)
    (y-0 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))
  (deflistener (hash ppk (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 6) (0 3))
    ((3 1) (2 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
  (leads-to ((2 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul x y)) "derived")))
    (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
    (2 4))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) "derived"))))))
    ((recv (hash ppk (hash (exp (gen) (mul x y)) "derived")))
      (send (hash ppk (hash (exp (gen) (mul x y)) "derived")))))
  (label 238)
  (parent 235)
  (unrealized (0 5) (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 4) (2 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 4 servera 5)
    (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-2)) "derived")))
    (3 4))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          request
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived"))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))))
  (label 239)
  (parent 236)
  (unrealized (0 5) (2 4) (3 2) (3 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u s ca ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y rndx) (x expt) (x-0 y-0 x-1 rndx) (y-1 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))
  (deflistener (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 6) (0 3)) ((4 1) (3 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (leads-to ((3 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (3 4))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
    ((recv (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 240)
  (parent 236)
  (unrealized (0 5) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 4) (1 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 3 0 clientr 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0))
        (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0 sr-0))
          (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
      (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0)) (2 2))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0 sr-0))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 241)
  (parent 237)
  (unrealized (0 5) (1 4) (2 3))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 4) (1 4)) ((3 1) (2 2)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
        (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))
          (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)) (2 2))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))))
  (label 242)
  (parent 237)
  (unrealized (0 5) (1 4) (2 2) (2 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 4) (2 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 4 0 clientr 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1))
        (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1 sr-1))
          (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
      (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1)) (3 2))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1 sr-1))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
  (label 243)
  (parent 239)
  (unrealized (0 5) (2 4) (3 3))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))
  (deflistener
    (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (4 0)) ((3 4) (2 4)) ((4 1) (3 2)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
        (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))
          (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
      (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)) (3 2))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          request
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived"))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
      (send (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))))
  (label 244)
  (parent 239)
  (unrealized (0 5) (2 4) (3 2) (3 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr-0 sr-0
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (3 0)) ((2 4) (1 4)) ((3 1) (2 3)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr-0 sr-0
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (enc "login" u-0 p-0
      (hash "c ap traffic" cr-0 sr-0
        (hash (exp (gen) (mul y-0 x-0)) "derived"))) (2 3))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0 sr-0))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr-0 sr-0
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr-0 sr-0
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 245)
  (parent 241)
  (unrealized (0 5) (1 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 4) (1 4)) ((3 1) (2 2)) ((4 1) (3 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0) (3 0))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))))
  (label 246)
  (parent 242)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))
  (deflistener
    (hash "c ap traffic" cr-1 sr-1
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (4 0)) ((3 4) (2 4)) ((4 1) (3 3)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr-1 sr-1
        (hash (exp (gen) (mul y-1 x-1)) "derived")))
    (enc "login" u-0 p-0
      (hash "c ap traffic" cr-1 sr-1
        (hash (exp (gen) (mul y-1 x-1)) "derived"))) (3 3))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1 sr-1))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr-1 sr-1
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr-1 sr-1
          (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (label 247)
  (parent 243)
  (unrealized (0 5) (2 4) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))
  (deflistener
    (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (5 0)) ((3 4) (2 4)) ((4 1) (3 2)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
    (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1) (4 0))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          request
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived"))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
      (send (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
    ((recv (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
      (send (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))))
  (label 248)
  (parent 244)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr-0 sr-0
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr-0 sr-0
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (4 0)) ((2 4) (1 4)) ((3 1) (2 3)) ((4 1) (3 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr-0 sr-0
        (hash (exp (gen) (mul y-0 x-0)) "derived")))
    (hash "c ap traffic" cr-0 sr-0
      (hash (exp (gen) (mul y-0 x-0)) "derived")) (3 0))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0 sr-0))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr-0 sr-0
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr-0 sr-0
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr-0 sr-0
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr-0 sr-0
          (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (label 249)
  (parent 245)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 4) (1 4)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 250)
  (parent 246)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 4) (1 4)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          request
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 251)
  (parent 246)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))
  (deflistener
    (hash "c ap traffic" cr-1 sr-1
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr-1 sr-1
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (5 0)) ((3 4) (2 4)) ((4 1) (3 3))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr-1 sr-1
        (hash (exp (gen) (mul y-1 x-1)) "derived")))
    (hash "c ap traffic" cr-1 sr-1
      (hash (exp (gen) (mul y-1 x-1)) "derived")) (4 0))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1 sr-1))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr-1 sr-1
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr-1 sr-1
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr-1 sr-1
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr-1 sr-1
          (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (label 252)
  (parent 247)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))
  (deflistener
    (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
  (deflistener (cat (exp (gen) x-1) y-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (6 0)) ((3 4) (2 4)) ((4 1) (3 2)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-1))
    (exp (gen) (mul x-1 y-1)) (5 0))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          request
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived"))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
      (send (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
    ((recv (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
      (send (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
    ((recv (cat (exp (gen) x-1) y-1)) (send (cat (exp (gen) x-1) y-1))))
  (label 253)
  (parent 248)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))
  (deflistener
    (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
  (deflistener (cat (exp (gen) y-1) x-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (6 0)) ((3 4) (2 4)) ((4 1) (3 2)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-1) x-1))
    (exp (gen) (mul x-1 y-1)) (5 0))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          request
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived"))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1 sr-1))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 y-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
      (send (hash (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
    ((recv (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1))
      (send (cat (exp (gen) (mul x-1 y-1)) "c hs traffic" cr-1 sr-1)))
    ((recv (cat (exp (gen) y-1) x-1)) (send (cat (exp (gen) y-1) x-1))))
  (label 254)
  (parent 248)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr-0 sr-0
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr-0 sr-0
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (5 0)) ((2 4) (1 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) "derived"))
    (hash (exp (gen) (mul y-0 x-0)) "derived") (4 0))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0 sr-0))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr-0 sr-0
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr-0 sr-0
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr-0 sr-0
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr-0 sr-0
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived"))))
  (label 255)
  (parent 249)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))
  (deflistener
    (hash "c ap traffic" cr-1 sr-1
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr-1 sr-1
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "derived"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (6 0)) ((3 4) (2 4)) ((4 1) (3 3))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-1 x-1)) "derived"))
    (hash (exp (gen) (mul y-1 x-1)) "derived") (5 0))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1 sr-1))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr-1 sr-1
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr-1 sr-1
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr-1 sr-1
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr-1 sr-1
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "derived"))
      (send (cat (exp (gen) (mul y-1 x-1)) "derived"))))
  (label 256)
  (parent 252)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr-0 sr-0
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr-0 sr-0
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (6 0)) ((2 4) (1 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0 sr-0))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr-0 sr-0
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr-0 sr-0
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr-0 sr-0
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr-0 sr-0
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 257)
  (parent 255)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0)
    (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))
  (deflistener
    (hash "c ap traffic" cr-0 sr-0
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr-0 sr-0
      (hash (exp (gen) (mul y-0 x-0)) "derived")))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (6 0)) ((2 4) (1 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x y-0 x-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          request
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0 sr-0))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr-0 sr-0
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (hash "c ap traffic" cr-0 sr-0
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr-0 sr-0
         (hash (exp (gen) (mul y-0 x-0)) "derived")))
      (send
        (cat "c ap traffic" cr-0 sr-0
          (hash (exp (gen) (mul y-0 x-0)) "derived"))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) "derived"))
      (send (cat (exp (gen) (mul y-0 x-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 258)
  (parent 255)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))
  (deflistener
    (hash "c ap traffic" cr-1 sr-1
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr-1 sr-1
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "derived"))
  (deflistener (cat (exp (gen) y-1) x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (7 0)) ((3 4) (2 4)) ((4 1) (3 3))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-1) x-1))
    (exp (gen) (mul y-1 x-1)) (6 0))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1 sr-1))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr-1 sr-1
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr-1 sr-1
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr-1 sr-1
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr-1 sr-1
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "derived"))
      (send (cat (exp (gen) (mul y-1 x-1)) "derived")))
    ((recv (cat (exp (gen) y-1) x-1)) (send (cat (exp (gen) y-1) x-1))))
  (label 259)
  (parent 256)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 rndx) (y-0 expt)
    (y-1 x-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1)
    (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))
  (deflistener
    (hash "c ap traffic" cr-1 sr-1
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener
    (cat "c ap traffic" cr-1 sr-1
      (hash (exp (gen) (mul y-1 x-1)) "derived")))
  (deflistener (cat (exp (gen) (mul y-1 x-1)) "derived"))
  (deflistener (cat (exp (gen) x-1) y-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (7 0)) ((3 4) (2 4)) ((4 1) (3 3))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 y-1 x-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-1))
    (exp (gen) (mul y-1 x-1)) (6 0))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1)))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          request
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (recv
        (enc response
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (send
        (enc "login" u p
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived"))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1 sr-1))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-1 x-1)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))))
          (hash (exp (gen) (mul y-1 x-1)) "c hs traffic" cr-1 sr-1)))
      (recv
        (enc "login" u-0 p-0
          (hash "c ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived"))))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-1 x-1)) "derived")))
          (hash "s ap traffic" cr-1 sr-1
            (hash (exp (gen) (mul y-1 x-1)) "derived")))))
    ((recv
       (hash "c ap traffic" cr-1 sr-1
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (hash "c ap traffic" cr-1 sr-1
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv
       (cat "c ap traffic" cr-1 sr-1
         (hash (exp (gen) (mul y-1 x-1)) "derived")))
      (send
        (cat "c ap traffic" cr-1 sr-1
          (hash (exp (gen) (mul y-1 x-1)) "derived"))))
    ((recv (cat (exp (gen) (mul y-1 x-1)) "derived"))
      (send (cat (exp (gen) (mul y-1 x-1)) "derived")))
    ((recv (cat (exp (gen) x-1) y-1)) (send (cat (exp (gen) x-1) y-1))))
  (label 260)
  (parent 256)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")
